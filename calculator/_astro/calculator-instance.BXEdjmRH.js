import{C as ut,a as Pe}from"./calculator.const.CKLd4ihy.js";import{V as K,I as $n,C as b,a as Rt,T as Du,b as pu,c as Km,P as Fm,d as Pm,e as Fe,M as Wr,U as mn}from"./commands.xPwo0_L0.js";import{C as st,a as yn,l as gu,_ as Da,b as xa,c as wa,d as Yn,A as km,g as Um}from"./auth.service.CYhfz_Ml.js";import{X as Vr,E as qr}from"./mathlive.min.BsOkRz8Q.js";import{m as Bm}from"./authStore.CN9YIAzg.js";import{C as Xr}from"./CalculatorSessionUtils.yz2CW3RD.js";import{C as zt,a as Jt,D as Hm,A as Wm,S as Vm,P as qm,b as xu}from"./calc.model.B894CNSn.js";import{C as vn}from"./calculator-mode.enum.CE88Er3y.js";import{C as Xn,a as Ke,b as Ct}from"./calculator-toast.service.r6FV5G6C.js";import{I as wu}from"./instance-manager.BK3A94JX.js";import{w as pe,g as ce}from"./index.BcueH52X.js";import{t as $m,b as Gm,c as Ym,d as Xm,e as zm}from"./feedback.service.DjI9bzGE.js";import{a as Zm}from"./utils.Cz7UNdBz.js";import{e as Lu}from"./environment.BLRScvqL.js";var qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Qm(){return"window"in globalThis&&"document"in globalThis}function gv(){return"function"==typeof navigator.vibrate}function jm(){if(!Qm())return"other";const e=navigator.userAgentData?.platform??navigator.platform;return/^mac/i.test(e)?5===navigator.maxTouchPoints?"ios":"macos":/^win/i.test(e)?"windows":/android/i.test(navigator.userAgent)?"android":/iphone|ipod|ipad/i.test(navigator.userAgent)?"ios":/\bcros\b/i.test(navigator.userAgent)?"chromeos":"other"}const ey="apple"===La()?{id:"apple.en-intl",displayName:"English (international)",virtualLayout:"qwerty",platform:"apple",locale:"en",score:0,mapping:{KeyA:["a","A","å","Å"],KeyB:["b","B","∫","ı"],KeyC:["c","C","ç","Ç"],KeyD:["d","D","∂","Î"],KeyE:["e","E","´","´"],KeyF:["f","F","ƒ","Ï"],KeyG:["g","G","©","˝"],KeyH:["h","H","˙","Ó"],KeyI:["i","I","ˆ","ˆ"],KeyJ:["j","J","∆","Ô"],KeyK:["k","K","˚",""],KeyL:["l","L","¬","Ò"],KeyM:["m","M","µ","Â"],KeyN:["n","N","˜","˜"],KeyO:["o","O","ø","Ø"],KeyP:["p","P","π","∏"],KeyQ:["q","Q","œ","Œ"],KeyR:["r","R","®","‰"],KeyS:["s","S","ß","Í"],KeyT:["t","T","†","ˇ"],KeyU:["u","U","¨","¨"],KeyV:["v","V","√","◊"],KeyW:["w","W","∑","„"],KeyX:["x","X","≈","˛"],KeyY:["y","Y","¥","Á"],KeyZ:["z","Z","Ω","¸"],Digit1:["1","!","¡","⁄"],Digit2:["2","@","™","€"],Digit3:["3","#","£","‹"],Digit4:["4","$","¢","›"],Digit5:["5","%","∞","ﬁ"],Digit6:["6","^","§","ﬂ"],Digit7:["7","&","¶","‡"],Digit8:["8","*","•","°"],Digit9:["9","(","ª","·"],Digit0:["0",")","º","‚"],Space:[" "," "," "," "],Minus:["-","_","–","—"],Equal:["=","+","≠","±"],BracketLeft:["[","{","“","”"],BracketRight:["]","}","‘","’"],Backslash:["\\","|","«","»"],Semicolon:[";",":","…","Ú"],Quote:["'",'"',"æ","Æ"],Backquote:["`","˜","`","`"],Comma:[",","<","≤","¯"],Period:[".",">","≥","˘"],Slash:["/","?","÷","¿"],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["1","1","1","1"],Numpad2:["2","2","2","2"],Numpad3:["3","3","3","3"],Numpad4:["4","4","4","4"],Numpad5:["5","5","5","5"],Numpad6:["6","6","6","6"],Numpad7:["7","7","7","7"],Numpad8:["8","8","8","8"],Numpad9:["9","9","9","9"],Numpad0:["0","0","0","0"],NumpadDecimal:[".",".",".","."],IntlBackslash:["§","±","§","±"],NumpadEqual:["=","=","=","="],AudioVolumeUp:["","=","","="]}}:"windows"===La()?{id:"windows.en-intl",displayName:"English (international)",platform:"windows",virtualLayout:"qwerty",locale:"en",score:0,mapping:{KeyA:["a","A","á","Á"],KeyB:["b","B","",""],KeyC:["c","C","©","¢"],KeyD:["d","D","ð","Ð"],KeyE:["e","E","é","É"],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","í","Í"],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","ø","Ø"],KeyM:["m","M","µ",""],KeyN:["n","N","ñ","Ñ"],KeyO:["o","O","ó","Ó"],KeyP:["p","P","ö","Ö"],KeyQ:["q","Q","ä","Ä"],KeyR:["r","R","®",""],KeyS:["s","S","ß","§"],KeyT:["t","T","þ","Þ"],KeyU:["u","U","ú","Ú"],KeyV:["v","V","",""],KeyW:["w","W","å","Å"],KeyX:["x","X","",""],KeyY:["y","Y","ü","Ü"],KeyZ:["z","Z","æ","Æ"],Digit1:["1","!","¡","¹"],Digit2:["2","@","²",""],Digit3:["3","#","³",""],Digit4:["4","$","¤","£"],Digit5:["5","%","€",""],Digit6:["6","^","¼",""],Digit7:["7","&","½",""],Digit8:["8","*","¾",""],Digit9:["9","(","‘",""],Digit0:["0",")","’",""],Space:[" "," ","",""],Minus:["-","_","¥",""],Equal:["=","+","×","÷"],BracketLeft:["[","{","«",""],BracketRight:["]","}","»",""],Backslash:["\\","|","¬","¦"],Semicolon:[";",":","¶","°"],Quote:["'",'"',"´","¨"],Backquote:["`","~","",""],Comma:[",","<","ç","Ç"],Period:[".",">","",""],Slash:["/","?","¿",""],NumpadDivide:["/","/","",""],NumpadMultiply:["*","*","",""],NumpadSubtract:["-","-","",""],NumpadAdd:["+","+","",""],IntlBackslash:["\\","|","",""]}}:{id:"linux.en",displayName:"English",platform:"linux",virtualLayout:"qwerty",locale:"en",score:0,mapping:{KeyA:["a","A","a","A"],KeyB:["b","B","b","B"],KeyC:["c","C","c","C"],KeyD:["d","D","d","D"],KeyE:["e","E","e","E"],KeyF:["f","F","f","F"],KeyG:["g","G","g","G"],KeyH:["h","H","h","H"],KeyI:["i","I","i","I"],KeyJ:["j","J","j","J"],KeyK:["k","K","k","K"],KeyL:["l","L","l","L"],KeyM:["m","M","m","M"],KeyN:["n","N","n","N"],KeyO:["o","O","o","O"],KeyP:["p","P","p","P"],KeyQ:["q","Q","q","Q"],KeyR:["r","R","r","R"],KeyS:["s","S","s","S"],KeyT:["t","T","t","T"],KeyU:["u","U","u","U"],KeyV:["v","V","v","V"],KeyW:["w","W","w","W"],KeyX:["x","X","x","X"],KeyY:["y","Y","y","Y"],KeyZ:["z","Z","z","Z"],Digit1:["1","!","1","!"],Digit2:["2","@","2","@"],Digit3:["3","#","3","#"],Digit4:["4","$","4","$"],Digit5:["5","%","5","%"],Digit6:["6","^","6","^"],Digit7:["7","&","7","&"],Digit8:["8","*","8","*"],Digit9:["9","(","9","("],Digit0:["0",")","0",")"],Space:[" "," "," "," "],Minus:["-","_","-","_"],Equal:["=","+","=","+"],BracketLeft:["[","{","[","{"],BracketRight:["]","}","]","}"],Backslash:["\\","|","\\","|"],Semicolon:[";",":",";",":"],Quote:["'",'"',"'",'"'],Backquote:["`","~","`","~"],Comma:[",","<",",","<"],Period:[".",">",".",">"],Slash:["/","?","/","?"],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["1","1","1","1"],Numpad2:["2","2","2","2"],Numpad3:["3","3","3","3"],Numpad4:["4","4","4","4"],Numpad5:["5","5","5","5"],Numpad6:["6","6","6","6"],Numpad7:["7","7","7","7"],Numpad8:["8","8","8","8"],Numpad9:["9","9","9","9"],Numpad0:["0","0","0","0"],NumpadDecimal:["",".","","."],IntlBackslash:["<",">","|","¦"],NumpadEqual:["=","=","=","="],NumpadComma:[".",".",".","."],NumpadParenLeft:["(","(","(","("],NumpadParenRight:[")",")",")",")"]}},zr=[];function La(){switch(jm()){case"macos":case"ios":return"apple";case"windows":return"windows"}return"linux"}function lt(e){(!e.platform||e.platform===La())&&zr.push(e)}function ty(e){if(e.code)return e;const t=Object.entries(Nu().mapping);let n=!1,r=!1,i="";for(let a=0;a<4;a++){for(const[o,s]of t)if(s[a]===e.key){i=o,3===a?(n=!0,r=!0):2===a?n=!0:1===a&&(r=!0);break}if(i)break}return new KeyboardEvent(e.type,{...e,altKey:n,shiftKey:r,code:i})}function ny(e){if(!e||"Unidentified"===e.key||"Dead"===e.key)return;const t=e.shiftKey&&e.altKey?3:e.altKey?2:e.shiftKey?1:0;for(const n of zr)n.mapping[e.code]?.[t]===e.key?n.score+=1:n.mapping[e.code]?.[t]&&(n.score=0);zr.sort(((e,t)=>t.score-e.score))}function Nu(){return zr[0]}function ry(e){const t=[];return(e=ty(e)).ctrlKey&&t.push("Control"),e.metaKey&&t.push("Meta"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift"),0===t.length?`[${e.code}]`:(t.push(`[${e.code}]`),t.join("+"))}function iy(e){return e.keyCodes?.map((e=>e.startsWith("Shift")?"Shift":e.startsWith("Control")?"Control":e.startsWith("Meta")?"Meta":e.startsWith("Alt")?"Alt":`[${e}]`)).join("+")||""}function ay(e,t){let n;const r=(new AbortController).signal;return e.addEventListener("keydown",(e=>{console.log("keydown",e),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),"CapsLock"!==e.code&&!/(Control|Meta|Alt|Shift)(Left|Right)/.test(e.code)&&(n&&e.timeStamp-n.timeStamp<10||(n=e,t.onKeystroke(ry(e),e)))}),{capture:!0,signal:r}),{}}lt(ey),lt({id:"apple.french",locale:"fr",displayName:"French",platform:"apple",virtualLayout:"azerty",score:0,mapping:{KeyA:["q","Q","‡","Ω"],KeyB:["b","B","ß","∫"],KeyC:["c","C","©","¢"],KeyD:["d","D","∂","∆"],KeyE:["e","E","ê","Ê"],KeyF:["f","F","ƒ","·"],KeyG:["g","G","ﬁ","ﬂ"],KeyH:["h","H","Ì","Î"],KeyI:["i","I","î","ï"],KeyJ:["j","J","Ï","Í"],KeyK:["k","K","È","Ë"],KeyL:["l","L","¬","|"],KeyM:[",","?","∞","¿"],KeyN:["n","N","~","ı"],KeyO:["o","O","œ","Œ"],KeyP:["p","P","π","∏"],KeyQ:["a","A","æ","Æ"],KeyR:["r","R","®","‚"],KeyS:["s","S","Ò","∑"],KeyT:["t","T","†","™"],KeyU:["u","U","º","ª"],KeyV:["v","V","◊","√"],KeyW:["z","Z","Â","Å"],KeyX:["x","X","≈","⁄"],KeyY:["y","Y","Ú","Ÿ"],KeyZ:["w","W","‹","›"],Digit1:["&","1","","´"],Digit2:["é","2","ë","„"],Digit3:['"',"3","“","”"],Digit4:["'","4","‘","’"],Digit5:["(","5","{","["],Digit6:["§","6","¶","å"],Digit7:["è","7","«","»"],Digit8:["!","8","¡","Û"],Digit9:["ç","9","Ç","Á"],Digit0:["à","0","ø","Ø"],Space:[" "," "," "," "],Minus:[")","°","}","]"],Equal:["-","_","—","–"],BracketLeft:["^","¨","ô","Ô"],BracketRight:["$","*","€","¥"],Backslash:["`","£","@","#"],Semicolon:["m","M","µ","Ó"],Quote:["ù","%","Ù","‰"],Backquote:["<",">","≤","≥"],Comma:[";",".","…","•"],Period:[":","/","÷","\\"],Slash:["=","+","≠","±"],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],NumpadDecimal:[",",".",",","."],IntlBackslash:["@","#","•","Ÿ"],NumpadEqual:["=","=","=","="]}}),lt({id:"apple.spanish",locale:"es",displayName:"Spanish ISO",platform:"apple",virtualLayout:"qwerty",score:0,mapping:{KeyA:["a","A","å","Å"],KeyB:["b","B","ß",""],KeyC:["c","C","©"," "],KeyD:["d","D","∂","∆"],KeyE:["e","E","€","€"],KeyF:["f","F","ƒ","ﬁ"],KeyG:["g","G","","ﬂ"],KeyH:["h","H","™"," "],KeyI:["i","I"," "," "],KeyJ:["j","J","¶","¯"],KeyK:["k","K","§","ˇ"],KeyL:["l","L"," ","˘"],KeyM:["m","M","µ","˚"],KeyN:["n","N"," ","˙"],KeyO:["o","O","ø","Ø"],KeyP:["p","P","π","∏"],KeyQ:["q","Q","œ","Œ"],KeyR:["r","R","®"," "],KeyS:["s","S","∫"," "],KeyT:["t","T","†","‡"],KeyU:["u","U"," "," "],KeyV:["v","V","√","◊"],KeyW:["w","W","æ","Æ"],KeyX:["x","X","∑","›"],KeyY:["y","Y","¥"," "],KeyZ:["z","Z","Ω","‹"],Digit1:["1","!","|","ı"],Digit2:["2",'"',"@","˝"],Digit3:["3","·","#","•"],Digit4:["4","$","¢","£"],Digit5:["5","%","∞","‰"],Digit6:["6","&","¬"," "],Digit7:["7","/","÷","⁄"],Digit8:["8","(","“","‘"],Digit9:["9",")","”","’"],Digit0:["0","=","≠","≈"],Space:[" "," "," "," "],Minus:["'","?","´","¸"],Equal:["¡","¿","‚","˛"],BracketLeft:["`","^","[","ˆ"],BracketRight:["+","*","]","±"],Backslash:["ç","Ç","}","»"],Semicolon:["ñ","Ñ","~","˜"],Quote:["´","¨","{","«"],Backquote:["<",">","≤","≥"],Comma:[",",";","„",""],Period:[".",":","…","…"],Slash:["-","_","–","—"],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["1","1","1","1"],Numpad2:["2","2","2","2"],Numpad3:["3","3","3","3"],Numpad4:["4","4","4","4"],Numpad5:["5","5","5","5"],Numpad6:["6","6","6","6"],Numpad7:["7","7","7","7"],Numpad8:["8","8","8","8"],Numpad9:["9","9","9","9"],Numpad0:["0","0","0","0"],NumpadDecimal:[",",",",",",","],IntlBackslash:["º","ª","\\","°"]}}),lt({id:"windows.spanish",locale:"es",displayName:"Spanish",platform:"windows",virtualLayout:"qwerty",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","€",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","",""],KeyM:["m","M","",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["y","Y","",""],KeyZ:["z","Z","",""],Digit1:["1","!","|",""],Digit2:["2",'"',"@",""],Digit3:["3","·","#",""],Digit4:["4","$","~",""],Digit5:["5","%","€",""],Digit6:["6","&","¬",""],Digit7:["7","/","",""],Digit8:["8","(","",""],Digit9:["9",")","",""],Digit0:["0","=","",""],Space:[" "," ","",""],Minus:["'","?","",""],Equal:["¡","¿","",""],BracketLeft:["`","^","[",""],BracketRight:["+","*","]",""],Backslash:["ç","Ç","}",""],Semicolon:["ñ","Ñ","",""],Quote:["´","¨","{",""],Backquote:["º","ª","\\",""],Comma:[",",";","",""],Period:[".",":","",""],Slash:["-","_","",""],NumpadDivide:["/","/","",""],NumpadMultiply:["*","*","",""],NumpadSubtract:["-","-","",""],NumpadAdd:["+","+","",""],IntlBackslash:["<",">","",""]}}),lt({id:"linux.spanish",locale:"es",displayName:"Spanish",platform:"linux",virtualLayout:"qwerty",score:0,mapping:{KeyA:["a","A","æ","Æ"],KeyB:["b","B","”","’"],KeyC:["c","C","¢","©"],KeyD:["d","D","ð","Ð"],KeyE:["e","E","€","¢"],KeyF:["f","F","đ","ª"],KeyG:["g","G","ŋ","Ŋ"],KeyH:["h","H","ħ","Ħ"],KeyI:["i","I","→","ı"],KeyJ:["j","J","̉","̛"],KeyK:["k","K","ĸ","&"],KeyL:["l","L","ł","Ł"],KeyM:["m","M","µ","º"],KeyN:["n","N","n","N"],KeyO:["o","O","ø","Ø"],KeyP:["p","P","þ","Þ"],KeyQ:["q","Q","@","Ω"],KeyR:["r","R","¶","®"],KeyS:["s","S","ß","§"],KeyT:["t","T","ŧ","Ŧ"],KeyU:["u","U","↓","↑"],KeyV:["v","V","“","‘"],KeyW:["w","W","ł","Ł"],KeyX:["x","X","»",">"],KeyY:["y","Y","←","¥"],KeyZ:["z","Z","«","<"],Digit1:["1","!","|","¡"],Digit2:["2",'"',"@","⅛"],Digit3:["3","·","#","£"],Digit4:["4","$","~","$"],Digit5:["5","%","½","⅜"],Digit6:["6","&","¬","⅝"],Digit7:["7","/","{","⅞"],Digit8:["8","(","[","™"],Digit9:["9",")","]","±"],Digit0:["0","=","}","°"],Enter:["\r","\r","\r","\r"],Escape:["","","",""],Backspace:["\b","\b","\b","\b"],Tab:["\t","","\t",""],Space:[" "," "," "," "],Minus:["'","?","\\","¿"],Equal:["¡","¿","̃","~"],BracketLeft:["̀","̂","[","̊"],BracketRight:["+","*","]","̄"],Backslash:["ç","Ç","}","̆"],Semicolon:["ñ","Ñ","~","̋"],Quote:["́","̈","{","{"],Backquote:["º","ª","\\","\\"],Comma:[",",";","─","×"],Period:[".",":","·","÷"],Slash:["-","_","̣","̇"],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],NumpadEnter:["\r","\r","\r","\r"],Numpad1:["","1","","1"],Numpad2:["","2","","2"],Numpad3:["","3","","3"],Numpad4:["","4","","4"],Numpad5:["","5","","5"],Numpad6:["","6","","6"],Numpad7:["","7","","7"],Numpad8:["","8","","8"],Numpad9:["","9","","9"],Numpad0:["","0","","0"],NumpadDecimal:["",".","","."],IntlBackslash:["<",">","|","¦"],NumpadEqual:["=","=","=","="],NumpadComma:[".",".",".","."],NumpadParenLeft:["(","(","(","("],NumpadParenRight:[")",")",")",")"]}}),lt({id:"linux.french",locale:"fr",displayName:"French",virtualLayout:"azerty",platform:"linux",score:0,mapping:{KeyA:["q","Q","@","Ω"],KeyB:["b","B","”","’"],KeyC:["c","C","¢","©"],KeyD:["d","D","ð","Ð"],KeyE:["e","E","€","¢"],KeyF:["f","F","đ","ª"],KeyG:["g","G","ŋ","Ŋ"],KeyH:["h","H","ħ","Ħ"],KeyI:["i","I","→","ı"],KeyJ:["j","J","̉","̛"],KeyK:["k","K","ĸ","&"],KeyL:["l","L","ł","Ł"],KeyM:[",","?","́","̋"],KeyN:["n","N","n","N"],KeyO:["o","O","ø","Ø"],KeyP:["p","P","þ","Þ"],KeyQ:["a","A","æ","Æ"],KeyR:["r","R","¶","®"],KeyS:["s","S","ß","§"],KeyT:["t","T","ŧ","Ŧ"],KeyU:["u","U","↓","↑"],KeyV:["v","V","“","‘"],KeyW:["z","Z","«","<"],KeyX:["x","X","»",">"],KeyY:["y","Y","←","¥"],KeyZ:["w","W","ł","Ł"],Digit1:["&","1","¹","¡"],Digit2:["é","2","~","⅛"],Digit3:['"',"3","#","£"],Digit4:["'","4","{","$"],Digit5:["(","5","[","⅜"],Digit6:["-","6","|","⅝"],Digit7:["è","7","`","⅞"],Digit8:["_","8","\\","™"],Digit9:["ç","9","^","±"],Digit0:["à","0","@","°"],Enter:["\r","\r","\r","\r"],Escape:["","","",""],Backspace:["\b","\b","\b","\b"],Tab:["\t","","\t",""],Space:[" "," "," "," "],Minus:[")","°","]","¿"],Equal:["=","+","}","̨"],BracketLeft:["̂","̈","̈","̊"],BracketRight:["$","£","¤","̄"],Backslash:["*","µ","̀","̆"],Semicolon:["m","M","µ","º"],Quote:["ù","%","̂","̌"],Backquote:["²","~","¬","¬"],Comma:[";",".","─","×"],Period:[":","/","·","÷"],Slash:["!","§","̣","̇"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],NumpadDecimal:["",".","","."],IntlBackslash:["<",">","|","¦"]}}),lt({id:"windows.french",locale:"fr",displayName:"French",virtualLayout:"azerty",platform:"windows",score:0,mapping:{KeyA:["q","Q","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","€",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","",""],KeyM:[",","?","",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["a","A","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["z","Z","",""],KeyX:["x","X","",""],KeyY:["y","Y","",""],KeyZ:["w","W","",""],Digit1:["&","1","",""],Digit2:["é","2","~",""],Digit3:['"',"3","#",""],Digit4:["'","4","{",""],Digit5:["(","5","[",""],Digit6:["-","6","|",""],Digit7:["è","7","`",""],Digit8:["_","8","\\",""],Digit9:["ç","9","^",""],Digit0:["à","0","@",""],Space:[" "," ","",""],Minus:[")","°","]",""],Equal:["=","+","}",""],BracketLeft:["^","¨","",""],BracketRight:["$","£","¤",""],Backslash:["*","µ","",""],Semicolon:["m","M","",""],Quote:["ù","%","",""],Backquote:["²","","",""],Comma:[";",".","",""],Period:[":","/","",""],Slash:["!","§","",""],NumpadDivide:["/","/","",""],NumpadMultiply:["*","*","",""],NumpadSubtract:["-","-","",""],NumpadAdd:["+","+","",""],IntlBackslash:["<",">","",""]}}),lt({id:"windows.german",locale:"de",displayName:"German",platform:"windows",virtualLayout:"qwertz",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","€",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","",""],KeyM:["m","M","µ",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","@",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["z","Z","",""],KeyZ:["y","Y","",""],Digit1:["1","!","",""],Digit2:["2",'"',"²",""],Digit3:["3","§","³",""],Digit4:["4","$","",""],Digit5:["5","%","",""],Digit6:["6","&","",""],Digit7:["7","/","{",""],Digit8:["8","(","[",""],Digit9:["9",")","]",""],Digit0:["0","=","}",""],Space:[" "," ","",""],Minus:["ß","?","\\","ẞ"],Equal:["´","`","",""],BracketLeft:["ü","Ü","",""],BracketRight:["+","*","~",""],Backslash:["#","'","",""],Semicolon:["ö","Ö","",""],Quote:["ä","Ä","",""],Backquote:["^","°","",""],Comma:[",",";","",""],Period:[".",":","",""],Slash:["-","_","",""],NumpadDivide:["/","/","",""],NumpadMultiply:["*","*","",""],NumpadSubtract:["-","-","",""],NumpadAdd:["+","+","",""],IntlBackslash:["<",">","|",""]}}),lt({id:"apple.german",locale:"de",displayName:"German",virtualLayout:"qwertz",platform:"apple",score:0,mapping:{KeyA:["a","A","å","Å"],KeyB:["b","B","∫","‹"],KeyC:["c","C","ç","Ç"],KeyD:["d","D","∂","™"],KeyE:["e","E","€","‰"],KeyF:["f","F","ƒ","Ï"],KeyG:["g","G","©","Ì"],KeyH:["h","H","ª","Ó"],KeyI:["i","I","⁄","Û"],KeyJ:["j","J","º","ı"],KeyK:["k","K","∆","ˆ"],KeyL:["l","L","@","ﬂ"],KeyM:["m","M","µ","˘"],KeyN:["n","N","~","›"],KeyO:["o","O","ø","Ø"],KeyP:["p","P","π","∏"],KeyQ:["q","Q","«","»"],KeyR:["r","R","®","¸"],KeyS:["s","S","‚","Í"],KeyT:["t","T","†","˝"],KeyU:["u","U","¨","Á"],KeyV:["v","V","√","◊"],KeyW:["w","W","∑","„"],KeyX:["x","X","≈","Ù"],KeyY:["z","Z","Ω","ˇ"],KeyZ:["y","Y","¥","‡"],Digit1:["1","!","¡","¬"],Digit2:["2",'"',"“","”"],Digit3:["3","§","¶","#"],Digit4:["4","$","¢","£"],Digit5:["5","%","[","ﬁ"],Digit6:["6","&","]","^"],Digit7:["7","/","|","\\"],Digit8:["8","(","{","˜"],Digit9:["9",")","}","·"],Digit0:["0","=","≠","¯"],Space:[" "," "," "," "],Minus:["ß","?","¿","˙"],Equal:["´","`","'","˚"],BracketLeft:["ü","Ü","•","°"],BracketRight:["+","*","±",""],Backslash:["#","'","‘","’"],Semicolon:["ö","Ö","œ","Œ"],Quote:["ä","Ä","æ","Æ"],Backquote:["<",">","≤","≥"],Comma:[",",";","∞","˛"],Period:[".",":","…","÷"],Slash:["-","_","–","—"],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],NumpadDecimal:[",",",",".","."],IntlBackslash:["^","°","„","“"],NumpadEqual:["=","=","=","="]}}),lt({id:"dvorak",locale:"en",displayName:"Dvorak",virtualLayout:"dvorak",platform:"",score:0,mapping:{KeyA:["a","A","å","Å"],KeyB:["x","X","≈","˛"],KeyC:["j","J","∆","Ô"],KeyD:["e","E","´","´"],KeyE:[".",">","≥","˘"],KeyF:["u","U","¨","¨"],KeyG:["i","I","ˆ","ˆ"],KeyH:["d","D","∂","Î"],KeyI:["c","C","ç","Ç"],KeyJ:["h","H","˙","Ó"],KeyK:["t","T","†","ˇ"],KeyL:["n","N","˜","˜"],KeyM:["m","M","µ","Â"],KeyN:["b","B","∫","ı"],KeyO:["r","R","®","‰"],KeyP:["l","L","¬","Ò"],KeyQ:["'",'"',"æ","Æ"],KeyR:["p","P","π","∏"],KeyS:["o","O","ø","Ø"],KeyT:["y","Y","¥","Á"],KeyU:["g","G","©","˝"],KeyV:["k","K","˚",""],KeyW:[",","<","≤","¯"],KeyX:["q","Q","œ","Œ"],KeyY:["f","F","ƒ","Ï"],KeyZ:[";",":","…","Ú"],Digit1:["1","!","¡","⁄"],Digit2:["2","@","™","€"],Digit3:["3","#","£","‹"],Digit4:["4","$","¢","›"],Digit5:["5","%","∞","ﬁ"],Digit6:["6","^","§","ﬂ"],Digit7:["7","&","¶","‡"],Digit8:["8","*","•","°"],Digit9:["9","(","ª","·"],Digit0:["0",")","º","‚"],Space:[" "," "," "," "],Minus:["[","{","“","”"],Equal:["]","}","‘","’"],BracketLeft:["/","?","÷","¿"],BracketRight:["=","+","≠","±"],Backslash:["\\","|","«","»"],Semicolon:["s","S","ß","Í"],Quote:["-","_","–","—"],Backquote:["`","~","`","`"],Comma:["w","W","∑","„"],Period:["v","V","√","◊"],Slash:["z","Z","Ω","¸"],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["1","1","1","1"],Numpad2:["2","2","2","2"],Numpad3:["3","3","3","3"],Numpad4:["4","4","4","4"],Numpad5:["5","5","5","5"],Numpad6:["6","6","6","6"],Numpad7:["7","7","7","7"],Numpad8:["8","8","8","8"],Numpad9:["9","9","9","9"],Numpad0:["0","0","0","0"],NumpadDecimal:[".",".",".","."],IntlBackslash:["§","±","§","±"],NumpadEqual:["=","=","=","="],AudioVolumeUp:["","=","","="]}});const oy=[{functionId:"variable-a",keyCombos:[{keyCodes:["KeyA"]}]},{functionId:"variable-b",keyCombos:[{keyCodes:["KeyB"]}]},{functionId:"variable-c",keyCombos:[{keyCodes:["KeyC"]}]},{functionId:"variable-d",keyCombos:[{keyCodes:["KeyD"]}]},{functionId:"variable-e",keyCombos:[{keyCodes:["KeyE"]}]},{functionId:"variable-z",keyCombos:[{keyCodes:["KeyZ"]}]},{functionId:"variable-f",keyCombos:[{keyCodes:["KeyF"]}]},{functionId:"variable-x",keyCombos:[{keyCodes:["KeyX"]}]},{functionId:"variable-y",keyCombos:[{keyCodes:["KeyY"]}]},{functionId:"variable-m",keyCombos:[{keyCodes:["KeyM"]}]},{functionId:"variable-t",keyCombos:[{keyCodes:["KeyT"]}]},{functionId:"variable-Ans",keyCombos:[{keyCodes:["Shift","Enter"]},{keyCodes:["Shift","NumpadEnter"]}]},{functionId:"variable-PreAns",keyCombos:[]},{functionId:"number-0",keyCombos:[{keyCodes:["Digit0"]},{keyCodes:["Numpad0"]}]},{functionId:"number-0",keyCombos:[{keyCodes:["Digit0"]},{keyCodes:["Numpad0"]}]},{functionId:"number-1",keyCombos:[{keyCodes:["Digit1"]},{keyCodes:["Numpad1"]}]},{functionId:"number-2",keyCombos:[{keyCodes:["Digit2"]},{keyCodes:["Numpad2"]}]},{functionId:"number-3",keyCombos:[{keyCodes:["Digit3"]},{keyCodes:["Numpad3"]}]},{functionId:"number-4",keyCombos:[{keyCodes:["Digit4"]},{keyCodes:["Numpad4"]}]},{functionId:"number-5",keyCombos:[{keyCodes:["Digit5"]},{keyCodes:["Numpad5"]}]},{functionId:"number-6",keyCombos:[{keyCodes:["Digit6"]},{keyCodes:["Numpad6"]}]},{functionId:"number-7",keyCombos:[{keyCodes:["Digit7"]},{keyCodes:["Numpad7"]}]},{functionId:"number-8",keyCombos:[{keyCodes:["Digit8"]},{keyCodes:["Numpad8"]}]},{functionId:"number-9",keyCombos:[{keyCodes:["Digit9"]},{keyCodes:["Numpad9"]}]},{functionId:"decimal place",keyCombos:[{keyCodes:["Period"]},{keyCodes:["NumpadDecimal"]}]},{functionId:"navigation-left",keyCombos:[{keyCodes:["ArrowLeft"]}]},{functionId:"navigation-right",keyCombos:[{keyCodes:["ArrowRight"]}]},{functionId:"navigation-up",keyCombos:[{keyCodes:["ArrowUp"]}]},{functionId:"navigation-down",keyCombos:[{keyCodes:["ArrowDown"]}]},{functionId:"clear",keyCombos:[{keyCodes:["Control","Backspace"]},{keyCodes:["Shift","Backspace"]},{keyCodes:["Control","Delete"]},{keyCodes:["Shift","Delete"]}]},{functionId:"delete",keyCombos:[{keyCodes:["Backspace"]}]},{functionId:"copy",keyCombos:[{keyCodes:["Control","KeyC"]}]},{functionId:"paste",keyCombos:[{keyCodes:["Control","KeyV"]}]},{functionId:"select all",keyCombos:[{keyCodes:["Control","KeyA"]}]},{functionId:"undo",keyCombos:[{keyCodes:["Control","KeyZ"]}]},{functionId:"redo",keyCombos:[{keyCodes:["Control","KeyY"]}]},{functionId:"exist-fullscreen-mode",keyCombos:[{keyCodes:["Escape"]}]},{functionId:"enter-fullscreen-mode",keyCombos:[{keyCodes:["Shift","KeyF"]}]},{functionId:"plus",keyCombos:[{keyCodes:["Shift","Equal"]},{keyCodes:["NumpadAdd"]}]},{functionId:"subtract",keyCombos:[{keyCodes:["Minus"]},{keyCodes:["NumpadSubtract"]}]},{functionId:"multiply",keyCombos:[{keyCodes:["Shift","Digit8"]},{keyCodes:["NumpadMultiply"]}]},{functionId:"divide",keyCombos:[{keyCodes:["Slash"]},{keyCodes:["NumpadDivide"]}]},{functionId:"equal",keyCombos:[{keyCodes:["Equal"]},{keyCodes:["NumpadEqual"]}]},{functionId:"power",keyCombos:[{keyCodes:["Shift","Digit6"]}]},{functionId:"fraction",keyCombos:[{keyCodes:["Shift","Slash"]},{keyCodes:["Control","Slash"]}]},{functionId:"mixed fraction",keyCombos:[{keyCodes:["Alt","Slash"]}]},{functionId:"calculate",keyCombos:[{keyCodes:["Enter"]},{keyCodes:["NumpadEnter"]}]},{functionId:"solve",keyCombos:[{keyCodes:["Shift","KeyS"]}]},{functionId:"npr",keyCombos:[{keyCodes:["Shift","KeyP"]}]},{functionId:"ncr",keyCombos:[{keyCodes:["Shift","KeyC"]}]},{functionId:"mod",keyCombos:[{keyCodes:["Shift","KeyM"]}]},{functionId:"divideR",keyCombos:[{keyCodes:["Shift","KeyR"]}]},{functionId:"degree",keyCombos:[{keyCodes:["Shift","KeyD"]}]},{functionId:"percent",keyCombos:[{keyCodes:["Shift","Digit5"]}]},{functionId:"factorial",keyCombos:[{keyCodes:["Shift","Digit1"]}]},{functionId:"pi",keyCombos:[{keyCodes:["KeyP"]}]},{functionId:"euler",keyCombos:[{keyCodes:["KeyE"]}]},{functionId:"imaginary",keyCombos:[{keyCodes:["KeyI"]}]},{functionId:"polar",keyCombos:[{keyCodes:["Control","Shift","KeyP"]}]},{functionId:"sin",keyCombos:[{keyCodes:["Alt","KeyS"]}]},{functionId:"sin",keyCombos:[{keyCodes:["Alt","KeyS"]}]},{functionId:"cos",keyCombos:[{keyCodes:["Alt","KeyC"]}]},{functionId:"tan",keyCombos:[{keyCodes:["Alt","KeyT"]}]},{functionId:"arcsin",keyCombos:[{keyCodes:["Control","Alt","KeyS"]}]},{functionId:"arccos",keyCombos:[{keyCodes:["Control","Alt","KeyC"]}]},{functionId:"arctan",keyCombos:[{keyCodes:["Control","Alt","KeyT"]}]},{functionId:"GCD",keyCombos:[{keyCodes:["Alt","KeyG"]}]},{functionId:"LCM",keyCombos:[{keyCodes:["Alt","KeyL"]}]},{functionId:"Pol",keyCombos:[{keyCodes:["Alt","KeyO"]}]},{functionId:"Rect",keyCombos:[{keyCodes:["Alt","KeyR"]}]},{functionId:"abs",keyCombos:[{keyCodes:["Alt","KeyA"]}]},{functionId:"integral",keyCombos:[{keyCodes:["Alt","KeyI"]}]},{functionId:"derivative",keyCombos:[{keyCodes:["Alt","KeyD"]}]},{functionId:"sum",keyCombos:[{keyCodes:["Control","KeyS"]}]},{functionId:"production",keyCombos:[{keyCodes:["Control","KeyP"]}]},{functionId:"square",keyCombos:[{keyCodes:["Shift","Digit2"]}]},{functionId:"sqrt",keyCombos:[{keyCodes:["Alt","Digit2"]}]},{functionId:"cube",keyCombos:[{keyCodes:["Shift","Digit3"]}]},{functionId:"cube root",keyCombos:[{keyCodes:["Alt","Digit3"]}]},{functionId:"ln",keyCombos:[{keyCodes:["KeyL"]}]},{functionId:"log",keyCombos:[{keyCodes:["Shift","KeyL"]}]},{functionId:"loga(b)",keyCombos:[{keyCodes:["Control","KeyL"]}]},{functionId:"comma",keyCombos:[{keyCodes:["Comma"]}]},{functionId:"colon",keyCombos:[{keyCodes:["Shift","Semicolon"]}]},{functionId:">",keyCombos:[{keyCodes:["Shift","Period"]}]},{functionId:"<",keyCombos:[{keyCodes:["Shift","Comma"]}]},{functionId:"(",keyCombos:[{keyCodes:["Shift","Digit9"]}]},{functionId:")",keyCombos:[{keyCodes:["Shift","Digit0"]}]}];var Zr={exports:{}};Zr.exports,function(e,t){(function(){var n,r="Expected a function",i="__lodash_hash_undefined__",a="__lodash_placeholder__",o=16,s=32,u=64,c=128,l=256,p=1/0,d=9007199254740991,h=NaN,f=4294967295,g=f-1,y=f>>>1,m=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",o],["flip",512],["partial",s],["partialRight",u],["rearg",l]],v="[object Arguments]",S="[object Array]",_="[object Boolean]",C="[object Date]",b="[object Error]",M="[object Function]",E="[object GeneratorFunction]",A="[object Map]",D="[object Number]",N="[object Object]",I="[object Promise]",T="[object RegExp]",w="[object Set]",L="[object String]",K="[object Symbol]",k="[object WeakMap]",O="[object ArrayBuffer]",x="[object DataView]",R="[object Float32Array]",F="[object Float64Array]",P="[object Int8Array]",U="[object Int16Array]",B="[object Int32Array]",H="[object Uint8Array]",V="[object Uint8ClampedArray]",j="[object Uint16Array]",$="[object Uint32Array]",q=/\b__p \+= '';/g,z=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,G=/&(?:amp|lt|gt|quot|#39);/g,Y=/[&<>"']/g,X=RegExp(G.source),J=RegExp(Y.source),Q=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,ee=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ie=/[\\^$.*+?()[\]{}|]/g,ae=RegExp(ie.source),oe=/^\s+/,se=/\s/,ue=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ce=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,pe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,de=/[()=,{}\[\]\/\s]/,he=/\\(\\)?/g,fe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ge=/\w*$/,ye=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ve=/^\[object .+?Constructor\]$/,Se=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,Ce=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,be=/($^)/,Me=/['\n\r\u2028\u2029\\]/g,Ee="\\ud800-\\udfff",Ae="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",De="\\u2700-\\u27bf",Ne="a-z\\xdf-\\xf6\\xf8-\\xff",Ie="A-Z\\xc0-\\xd6\\xd8-\\xde",Te="\\ufe0e\\ufe0f",we="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Le="['’]",Ke="["+Ee+"]",ke="["+we+"]",Oe="["+Ae+"]",xe="\\d+",Re="["+De+"]",Fe="["+Ne+"]",Pe="[^"+Ee+we+xe+De+Ne+Ie+"]",Ue="\\ud83c[\\udffb-\\udfff]",Be="[^"+Ee+"]",He="(?:\\ud83c[\\udde6-\\uddff]){2}",Ve="[\\ud800-\\udbff][\\udc00-\\udfff]",je="["+Ie+"]",$e="\\u200d",qe="(?:"+Fe+"|"+Pe+")",ze="(?:"+je+"|"+Pe+")",We="(?:['’](?:d|ll|m|re|s|t|ve))?",Ge="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ye="(?:"+Oe+"|"+Ue+")"+"?",Xe="["+Te+"]?",Je=Xe+Ye+("(?:"+$e+"(?:"+[Be,He,Ve].join("|")+")"+Xe+Ye+")*"),Qe="(?:"+[Re,He,Ve].join("|")+")"+Je,Ze="(?:"+[Be+Oe+"?",Oe,He,Ve,Ke].join("|")+")",et=RegExp(Le,"g"),tt=RegExp(Oe,"g"),nt=RegExp(Ue+"(?="+Ue+")|"+Ze+Je,"g"),rt=RegExp([je+"?"+Fe+"+"+We+"(?="+[ke,je,"$"].join("|")+")",ze+"+"+Ge+"(?="+[ke,je+qe,"$"].join("|")+")",je+"?"+qe+"+"+We,je+"+"+Ge,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",xe,Qe].join("|"),"g"),it=RegExp("["+$e+Ee+Ae+Te+"]"),at=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ot=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],st=-1,ut={};ut[R]=ut[F]=ut[P]=ut[U]=ut[B]=ut[H]=ut[V]=ut[j]=ut[$]=!0,ut[v]=ut[S]=ut[O]=ut[_]=ut[x]=ut[C]=ut[b]=ut[M]=ut[A]=ut[D]=ut[N]=ut[T]=ut[w]=ut[L]=ut[k]=!1;var ct={};ct[v]=ct[S]=ct[O]=ct[x]=ct[_]=ct[C]=ct[R]=ct[F]=ct[P]=ct[U]=ct[B]=ct[A]=ct[D]=ct[N]=ct[T]=ct[w]=ct[L]=ct[K]=ct[H]=ct[V]=ct[j]=ct[$]=!0,ct[b]=ct[M]=ct[k]=!1;var lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},pt=parseFloat,dt=parseInt,ht="object"==typeof qn&&qn&&qn.Object===Object&&qn,ft="object"==typeof self&&self&&self.Object===Object&&self,gt=ht||ft||Function("return this")(),yt=t&&!t.nodeType&&t,mt=yt&&e&&!e.nodeType&&e,vt=mt&&mt.exports===yt,St=vt&&ht.process,_t=function(){try{return mt&&mt.require&&mt.require("util").types||St&&St.binding&&St.binding("util")}catch{}}(),Ct=_t&&_t.isArrayBuffer,bt=_t&&_t.isDate,Mt=_t&&_t.isMap,Et=_t&&_t.isRegExp,At=_t&&_t.isSet,Dt=_t&&_t.isTypedArray;function Nt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function It(e,t,n,r){for(var i=-1,a=null==e?0:e.length;++i<a;){var o=e[i];t(r,o,n(o),e)}return r}function Tt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function wt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Lt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Kt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}function kt(e,t){return!!(null==e?0:e.length)&&jt(e,t,0)>-1}function Ot(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function xt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Rt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Ft(e,t,n,r){var i=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n}function Pt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Ut(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Bt=Wt("length");function Ht(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Vt(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}function jt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Vt(e,qt,n)}function $t(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return-1}function qt(e){return e!=e}function zt(e,t){var n=null==e?0:e.length;return n?Xt(e,t)/n:h}function Wt(e){return function(t){return null==t?n:t[e]}}function Gt(e){return function(t){return null==e?n:e[t]}}function Yt(e,t,n,r,i){return i(e,(function(e,i,a){n=r?(r=!1,e):t(n,e,i,a)})),n}function Xt(e,t){for(var r,i=-1,a=e.length;++i<a;){var o=t(e[i]);o!==n&&(r=r===n?o:r+o)}return r}function Jt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Qt(e){return e&&e.slice(0,gn(e)+1).replace(oe,"")}function Zt(e){return function(t){return e(t)}}function en(e,t){return xt(t,(function(t){return e[t]}))}function tn(e,t){return e.has(t)}function nn(e,t){for(var n=-1,r=e.length;++n<r&&jt(t,e[n],0)>-1;);return n}function rn(e,t){for(var n=e.length;n--&&jt(t,e[n],0)>-1;);return n}var an=Gt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),on=Gt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function sn(e){return"\\"+lt[e]}function un(e){return it.test(e)}function cn(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function pn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];(s===t||s===a)&&(e[n]=a,o[i++]=n)}return o}function dn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function hn(e){return un(e)?function(e){for(var t=nt.lastIndex=0;nt.test(e);)++t;return t}(e):Bt(e)}function fn(e){return un(e)?function(e){return e.match(nt)||[]}(e):function(e){return e.split("")}(e)}function gn(e){for(var t=e.length;t--&&se.test(e.charAt(t)););return t}var yn=Gt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var mn=function e(t){var se,Ee=(t=null==t?gt:mn.defaults(gt.Object(),t,mn.pick(gt,ot))).Array,Ae=t.Date,De=t.Error,Ne=t.Function,Ie=t.Math,Te=t.Object,we=t.RegExp,Le=t.String,Ke=t.TypeError,ke=Ee.prototype,Oe=Ne.prototype,xe=Te.prototype,Re=t["__core-js_shared__"],Fe=Oe.toString,Pe=xe.hasOwnProperty,Ue=0,Be=(se=/[^.]+$/.exec(Re&&Re.keys&&Re.keys.IE_PROTO||""))?"Symbol(src)_1."+se:"",He=xe.toString,Ve=Fe.call(Te),je=gt._,$e=we("^"+Fe.call(Pe).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=vt?t.Buffer:n,ze=t.Symbol,We=t.Uint8Array,Ge=qe?qe.allocUnsafe:n,Ye=ln(Te.getPrototypeOf,Te),Xe=Te.create,Je=xe.propertyIsEnumerable,Qe=ke.splice,Ze=ze?ze.isConcatSpreadable:n,nt=ze?ze.iterator:n,it=ze?ze.toStringTag:n,lt=function(){try{var e=ha(Te,"defineProperty");return e({},"",{}),e}catch{}}(),ht=t.clearTimeout!==gt.clearTimeout&&t.clearTimeout,ft=Ae&&Ae.now!==gt.Date.now&&Ae.now,yt=t.setTimeout!==gt.setTimeout&&t.setTimeout,mt=Ie.ceil,St=Ie.floor,_t=Te.getOwnPropertySymbols,Bt=qe?qe.isBuffer:n,Gt=t.isFinite,vn=ke.join,Sn=ln(Te.keys,Te),_n=Ie.max,Cn=Ie.min,bn=Ae.now,Mn=t.parseInt,En=Ie.random,An=ke.reverse,Dn=ha(t,"DataView"),Nn=ha(t,"Map"),In=ha(t,"Promise"),Tn=ha(t,"Set"),wn=ha(t,"WeakMap"),Ln=ha(Te,"create"),Kn=wn&&new wn,kn={},On=Ua(Dn),xn=Ua(Nn),Rn=Ua(In),Fn=Ua(Tn),Pn=Ua(wn),Un=ze?ze.prototype:n,Bn=Un?Un.valueOf:n,Hn=Un?Un.toString:n;function Vn(e){if(rs(e)&&!zo(e)&&!(e instanceof zn)){if(e instanceof qn)return e;if(Pe.call(e,"__wrapped__"))return Ba(e)}return new qn(e)}var jn=function(){function e(){}return function(t){if(!ns(t))return{};if(Xe)return Xe(t);e.prototype=t;var r=new e;return e.prototype=n,r}}();function $n(){}function qn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=n}function zn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Xn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Yn;++t<n;)this.add(e[t])}function Jn(e){var t=this.__data__=new Gn(e);this.size=t.size}function Qn(e,t){var n=zo(e),r=!n&&qo(e),i=!n&&!r&&Xo(e),a=!n&&!r&&!i&&ps(e),o=n||r||i||a,s=o?Jt(e.length,Le):[],u=s.length;for(var c in e)(t||Pe.call(e,c))&&(!o||!("length"==c||i&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_a(c,u)))&&s.push(c);return s}function Zn(e){var t=e.length;return t?e[Xr(0,t-1)]:n}function er(e,t){return Ra(Li(e),cr(t,0,e.length))}function tr(e){return Ra(Li(e))}function nr(e,t,r){(r!==n&&!Vo(e[t],r)||r===n&&!(t in e))&&sr(e,t,r)}function rr(e,t,r){var i=e[t];(!Pe.call(e,t)||!Vo(i,r)||r===n&&!(t in e))&&sr(e,t,r)}function ir(e,t){for(var n=e.length;n--;)if(Vo(e[n][0],t))return n;return-1}function ar(e,t,n,r){return fr(e,(function(e,i,a){t(r,e,n(e),a)})),r}function or(e,t){return e&&Ki(t,ks(t),e)}function sr(e,t,n){"__proto__"==t&&lt?lt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ur(e,t){for(var r=-1,i=t.length,a=Ee(i),o=null==e;++r<i;)a[r]=o?n:Is(e,t[r]);return a}function cr(e,t,r){return e==e&&(r!==n&&(e=e<=r?e:r),t!==n&&(e=e>=t?e:t)),e}function lr(e,t,r,i,a,o){var s,u=1&t,c=2&t,l=4&t;if(r&&(s=a?r(e,i,a,o):r(e)),s!==n)return s;if(!ns(e))return e;var p=zo(e);if(p){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Pe.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!u)return Li(e,s)}else{var d=ya(e),h=d==M||d==E;if(Xo(e))return Ai(e,u);if(d==N||d==v||h&&!a){if(s=c||h?{}:va(e),!u)return c?function(e,t){return Ki(e,ga(e),t)}(e,function(e,t){return e&&Ki(t,Os(t),e)}(s,e)):function(e,t){return Ki(e,fa(e),t)}(e,or(s,e))}else{if(!ct[d])return a?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case O:return Di(e);case _:case C:return new r(+e);case x:return function(e,t){var n=t?Di(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case R:case F:case P:case U:case B:case H:case V:case j:case $:return Ni(e,n);case A:return new r;case D:case L:return new r(e);case T:return function(e){var t=new e.constructor(e.source,ge.exec(e));return t.lastIndex=e.lastIndex,t}(e);case w:return new r;case K:return function(e){return Bn?Te(Bn.call(e)):{}}(e)}}(e,d,u)}}o||(o=new Jn);var f=o.get(e);if(f)return f;o.set(e,s),us(e)?e.forEach((function(n){s.add(lr(n,t,r,n,e,o))})):is(e)&&e.forEach((function(n,i){s.set(i,lr(n,t,r,i,e,o))}));var g=p?n:(l?c?oa:aa:c?Os:ks)(e);return Tt(g||e,(function(n,i){g&&(n=e[i=n]),rr(s,i,lr(n,t,r,i,e,o))})),s}function pr(e,t,r){var i=r.length;if(null==e)return!i;for(e=Te(e);i--;){var a=r[i],o=t[a],s=e[a];if(s===n&&!(a in e)||!o(s))return!1}return!0}function dr(e,t,i){if("function"!=typeof e)throw new Ke(r);return Ka((function(){e.apply(n,i)}),t)}function hr(e,t,n,r){var i=-1,a=kt,o=!0,s=e.length,u=[],c=t.length;if(!s)return u;n&&(t=xt(t,Zt(n))),r?(a=Ot,o=!1):t.length>=200&&(a=tn,o=!1,t=new Xn(t));e:for(;++i<s;){var l=e[i],p=null==n?l:n(l);if(l=r||0!==l?l:0,o&&p==p){for(var d=c;d--;)if(t[d]===p)continue e;u.push(l)}else a(t,p,r)||u.push(l)}return u}Vn.templateSettings={escape:Q,evaluate:Z,interpolate:ee,variable:"",imports:{_:Vn}},Vn.prototype=$n.prototype,Vn.prototype.constructor=Vn,qn.prototype=jn($n.prototype),qn.prototype.constructor=qn,zn.prototype=jn($n.prototype),zn.prototype.constructor=zn,Wn.prototype.clear=function(){this.__data__=Ln?Ln(null):{},this.size=0},Wn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Wn.prototype.get=function(e){var t=this.__data__;if(Ln){var r=t[e];return r===i?n:r}return Pe.call(t,e)?t[e]:n},Wn.prototype.has=function(e){var t=this.__data__;return Ln?t[e]!==n:Pe.call(t,e)},Wn.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ln&&t===n?i:t,this},Gn.prototype.clear=function(){this.__data__=[],this.size=0},Gn.prototype.delete=function(e){var t=this.__data__,n=ir(t,e);return!(n<0)&&(n==t.length-1?t.pop():Qe.call(t,n,1),--this.size,!0)},Gn.prototype.get=function(e){var t=this.__data__,r=ir(t,e);return r<0?n:t[r][1]},Gn.prototype.has=function(e){return ir(this.__data__,e)>-1},Gn.prototype.set=function(e,t){var n=this.__data__,r=ir(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Yn.prototype.clear=function(){this.size=0,this.__data__={hash:new Wn,map:new(Nn||Gn),string:new Wn}},Yn.prototype.delete=function(e){var t=pa(this,e).delete(e);return this.size-=t?1:0,t},Yn.prototype.get=function(e){return pa(this,e).get(e)},Yn.prototype.has=function(e){return pa(this,e).has(e)},Yn.prototype.set=function(e,t){var n=pa(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Xn.prototype.add=Xn.prototype.push=function(e){return this.__data__.set(e,i),this},Xn.prototype.has=function(e){return this.__data__.has(e)},Jn.prototype.clear=function(){this.__data__=new Gn,this.size=0},Jn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Jn.prototype.get=function(e){return this.__data__.get(e)},Jn.prototype.has=function(e){return this.__data__.has(e)},Jn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Gn){var r=n.__data__;if(!Nn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Yn(r)}return n.set(e,t),this.size=n.size,this};var fr=xi(br),gr=xi(Mr,!0);function yr(e,t){var n=!0;return fr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function mr(e,t,r){for(var i=-1,a=e.length;++i<a;){var o=e[i],s=t(o);if(null!=s&&(u===n?s==s&&!ls(s):r(s,u)))var u=s,c=o}return c}function vr(e,t){var n=[];return fr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function Sr(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=Sa),i||(i=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?Sr(s,t-1,n,r,i):Rt(i,s):r||(i[i.length]=s)}return i}var _r=Ri(),Cr=Ri(!0);function br(e,t){return e&&_r(e,t,ks)}function Mr(e,t){return e&&Cr(e,t,ks)}function Er(e,t){return Kt(t,(function(t){return Zo(e[t])}))}function Ar(e,t){for(var r=0,i=(t=Ci(t,e)).length;null!=e&&r<i;)e=e[Pa(t[r++])];return r&&r==i?e:n}function Dr(e,t,n){var r=t(e);return zo(e)?r:Rt(r,n(e))}function Nr(e){return null==e?e===n?"[object Undefined]":"[object Null]":it&&it in Te(e)?function(e){var t=Pe.call(e,it),r=e[it];try{e[it]=n;var i=!0}catch{}var a=He.call(e);return i&&(t?e[it]=r:delete e[it]),a}(e):function(e){return He.call(e)}(e)}function Ir(e,t){return e>t}function Tr(e,t){return null!=e&&Pe.call(e,t)}function wr(e,t){return null!=e&&t in Te(e)}function Lr(e,t,r){for(var i=r?Ot:kt,a=e[0].length,o=e.length,s=o,u=Ee(o),c=1/0,l=[];s--;){var p=e[s];s&&t&&(p=xt(p,Zt(t))),c=Cn(p.length,c),u[s]=!r&&(t||a>=120&&p.length>=120)?new Xn(s&&p):n}p=e[0];var d=-1,h=u[0];e:for(;++d<a&&l.length<c;){var f=p[d],g=t?t(f):f;if(f=r||0!==f?f:0,!(h?tn(h,g):i(l,g,r))){for(s=o;--s;){var y=u[s];if(!(y?tn(y,g):i(e[s],g,r)))continue e}h&&h.push(g),l.push(f)}}return l}function Kr(e,t,r){var i=null==(e=Ta(e,t=Ci(t,e)))?e:e[Pa(Ja(t))];return null==i?n:Nt(i,e,r)}function kr(e){return rs(e)&&Nr(e)==v}function Or(e,t,r,i,a){return e===t||(null==e||null==t||!rs(e)&&!rs(t)?e!=e&&t!=t:function(e,t,r,i,a,o){var s=zo(e),u=zo(t),c=s?S:ya(e),l=u?S:ya(t),p=(c=c==v?N:c)==N,d=(l=l==v?N:l)==N,h=c==l;if(h&&Xo(e)){if(!Xo(t))return!1;s=!0,p=!1}if(h&&!p)return o||(o=new Jn),s||ps(e)?ra(e,t,r,i,a,o):function(e,t,n,r,i,a,o){switch(n){case x:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!a(new We(e),new We(t)));case _:case C:case D:return Vo(+e,+t);case b:return e.name==t.name&&e.message==t.message;case T:case L:return e==t+"";case A:var s=cn;case w:var u=1&r;if(s||(s=dn),e.size!=t.size&&!u)return!1;var c=o.get(e);if(c)return c==t;r|=2,o.set(e,t);var l=ra(s(e),s(t),r,i,a,o);return o.delete(e),l;case K:if(Bn)return Bn.call(e)==Bn.call(t)}return!1}(e,t,c,r,i,a,o);if(!(1&r)){var f=p&&Pe.call(e,"__wrapped__"),g=d&&Pe.call(t,"__wrapped__");if(f||g){var y=f?e.value():e,m=g?t.value():t;return o||(o=new Jn),a(y,m,r,i,o)}}return!!h&&(o||(o=new Jn),function(e,t,r,i,a,o){var s=1&r,u=aa(e),c=u.length,l=aa(t),p=l.length;if(c!=p&&!s)return!1;for(var d=c;d--;){var h=u[d];if(!(s?h in t:Pe.call(t,h)))return!1}var f=o.get(e),g=o.get(t);if(f&&g)return f==t&&g==e;var y=!0;o.set(e,t),o.set(t,e);for(var m=s;++d<c;){var v=e[h=u[d]],S=t[h];if(i)var _=s?i(S,v,h,t,e,o):i(v,S,h,e,t,o);if(!(_===n?v===S||a(v,S,r,i,o):_)){y=!1;break}m||(m="constructor"==h)}if(y&&!m){var C=e.constructor,b=t.constructor;C!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof C&&C instanceof C&&"function"==typeof b&&b instanceof b)&&(y=!1)}return o.delete(e),o.delete(t),y}(e,t,r,i,a,o))}(e,t,r,i,Or,a))}function xr(e,t,r,i){var a=r.length,o=a,s=!i;if(null==e)return!o;for(e=Te(e);a--;){var u=r[a];if(s&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++a<o;){var c=(u=r[a])[0],l=e[c],p=u[1];if(s&&u[2]){if(l===n&&!(c in e))return!1}else{var d=new Jn;if(i)var h=i(l,p,c,e,t,d);if(!(h===n?Or(p,l,3,i,d):h))return!1}}return!0}function Rr(e){return!(!ns(e)||function(e){return!!Be&&Be in e}(e))&&(Zo(e)?$e:ve).test(Ua(e))}function Fr(e){return"function"==typeof e?e:null==e?au:"object"==typeof e?zo(e)?jr(e[0],e[1]):Vr(e):fu(e)}function Pr(e){if(!Aa(e))return Sn(e);var t=[];for(var n in Te(e))Pe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ur(e){if(!ns(e))return function(e){var t=[];if(null!=e)for(var n in Te(e))t.push(n);return t}(e);var t=Aa(e),n=[];for(var r in e)"constructor"==r&&(t||!Pe.call(e,r))||n.push(r);return n}function Br(e,t){return e<t}function Hr(e,t){var n=-1,r=Go(e)?Ee(e.length):[];return fr(e,(function(e,i,a){r[++n]=t(e,i,a)})),r}function Vr(e){var t=da(e);return 1==t.length&&t[0][2]?Na(t[0][0],t[0][1]):function(n){return n===e||xr(n,e,t)}}function jr(e,t){return ba(e)&&Da(t)?Na(Pa(e),t):function(r){var i=Is(r,e);return i===n&&i===t?Ts(r,e):Or(t,i,3)}}function $r(e,t,r,i,a){e!==t&&_r(t,(function(o,s){if(a||(a=new Jn),ns(o))!function(e,t,r,i,a,o,s){var u=wa(e,r),c=wa(t,r),l=s.get(c);if(l)return void nr(e,r,l);var p=o?o(u,c,r+"",e,t,s):n,d=p===n;if(d){var h=zo(c),f=!h&&Xo(c),g=!h&&!f&&ps(c);p=c,h||f||g?zo(u)?p=u:Yo(u)?p=Li(u):f?(d=!1,p=Ai(c,!0)):g?(d=!1,p=Ni(c,!0)):p=[]:os(c)||qo(c)?(p=u,qo(u)?p=Ss(u):(!ns(u)||Zo(u))&&(p=va(c))):d=!1}d&&(s.set(c,p),a(p,c,i,o,s),s.delete(c)),nr(e,r,p)}(e,t,s,r,$r,i,a);else{var u=i?i(wa(e,s),o,s+"",e,t,a):n;u===n&&(u=o),nr(e,s,u)}}),Os)}function qr(e,t){var r=e.length;if(r)return _a(t+=t<0?r:0,r)?e[t]:n}function zr(e,t,n){t=t.length?xt(t,(function(e){return zo(e)?function(t){return Ar(t,1===e.length?e[0]:e)}:e})):[au];var r=-1;return t=xt(t,Zt(la())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Hr(e,(function(e,n,i){return{criteria:xt(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var u=Ii(i[r],a[r]);if(u)return r>=s?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Wr(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=Ar(e,o);n(s,o)&&ti(a,Ci(o,e),s)}return a}function Gr(e,t,n,r){var i=r?$t:jt,a=-1,o=t.length,s=e;for(e===t&&(t=Li(t)),n&&(s=xt(e,Zt(n)));++a<o;)for(var u=0,c=t[a],l=n?n(c):c;(u=i(s,l,u,r))>-1;)s!==e&&Qe.call(s,u,1),Qe.call(e,u,1);return e}function Yr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==a){var a=i;_a(i)?Qe.call(e,i,1):hi(e,i)}}return e}function Xr(e,t){return e+St(En()*(t-e+1))}function Jr(e,t){var n="";if(!e||t<1||t>d)return n;do{t%2&&(n+=e),(t=St(t/2))&&(e+=e)}while(t);return n}function Qr(e,t){return ka(Ia(e,t,au),e+"")}function Zr(e){return Zn(Vs(e))}function ei(e,t){var n=Vs(e);return Ra(n,cr(t,0,n.length))}function ti(e,t,r,i){if(!ns(e))return e;for(var a=-1,o=(t=Ci(t,e)).length,s=o-1,u=e;null!=u&&++a<o;){var c=Pa(t[a]),l=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(a!=s){var p=u[c];(l=i?i(p,c,u):n)===n&&(l=ns(p)?p:_a(t[a+1])?[]:{})}rr(u,c,l),u=u[c]}return e}var ni=Kn?function(e,t){return Kn.set(e,t),e}:au,ri=lt?function(e,t){return lt(e,"toString",{configurable:!0,enumerable:!1,value:nu(t),writable:!0})}:au;function ii(e){return Ra(Vs(e))}function ai(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=Ee(i);++r<i;)a[r]=e[r+t];return a}function oi(e,t){var n;return fr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function si(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=y){for(;r<i;){var a=r+i>>>1,o=e[a];null!==o&&!ls(o)&&(n?o<=t:o<t)?r=a+1:i=a}return i}return ui(e,t,au,n)}function ui(e,t,r,i){var a=0,o=null==e?0:e.length;if(0===o)return 0;for(var s=(t=r(t))!=t,u=null===t,c=ls(t),l=t===n;a<o;){var p=St((a+o)/2),d=r(e[p]),h=d!==n,f=null===d,y=d==d,m=ls(d);if(s)var v=i||y;else v=l?y&&(i||h):u?y&&h&&(i||!f):c?y&&h&&!f&&(i||!m):!f&&!m&&(i?d<=t:d<t);v?a=p+1:o=p}return Cn(o,g)}function ci(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n],s=t?t(o):o;if(!n||!Vo(s,u)){var u=s;a[i++]=0===o?0:o}}return a}function li(e){return"number"==typeof e?e:ls(e)?h:+e}function pi(e){if("string"==typeof e)return e;if(zo(e))return xt(e,pi)+"";if(ls(e))return Hn?Hn.call(e):"";var t=e+"";return"0"==t&&1/e==-p?"-0":t}function di(e,t,n){var r=-1,i=kt,a=e.length,o=!0,s=[],u=s;if(n)o=!1,i=Ot;else if(a>=200){var c=t?null:Ji(e);if(c)return dn(c);o=!1,i=tn,u=new Xn}else u=t?[]:s;e:for(;++r<a;){var l=e[r],p=t?t(l):l;if(l=n||0!==l?l:0,o&&p==p){for(var d=u.length;d--;)if(u[d]===p)continue e;t&&u.push(p),s.push(l)}else i(u,p,n)||(u!==s&&u.push(p),s.push(l))}return s}function hi(e,t){return null==(e=Ta(e,t=Ci(t,e)))||delete e[Pa(Ja(t))]}function fi(e,t,n,r){return ti(e,t,n(Ar(e,t)),r)}function gi(e,t,n,r){for(var i=e.length,a=r?i:-1;(r?a--:++a<i)&&t(e[a],a,e););return n?ai(e,r?0:a,r?a+1:i):ai(e,r?a+1:0,r?i:a)}function yi(e,t){var n=e;return n instanceof zn&&(n=n.value()),Ft(t,(function(e,t){return t.func.apply(t.thisArg,Rt([e],t.args))}),n)}function mi(e,t,n){var r=e.length;if(r<2)return r?di(e[0]):[];for(var i=-1,a=Ee(r);++i<r;)for(var o=e[i],s=-1;++s<r;)s!=i&&(a[i]=hr(a[i]||o,e[s],t,n));return di(Sr(a,1),t,n)}function vi(e,t,r){for(var i=-1,a=e.length,o=t.length,s={};++i<a;){var u=i<o?t[i]:n;r(s,e[i],u)}return s}function Si(e){return Yo(e)?e:[]}function _i(e){return"function"==typeof e?e:au}function Ci(e,t){return zo(e)?e:ba(e,t)?[e]:Fa(_s(e))}var bi=Qr;function Mi(e,t,r){var i=e.length;return r=r===n?i:r,!t&&r>=i?e:ai(e,t,r)}var Ei=ht||function(e){return gt.clearTimeout(e)};function Ai(e,t){if(t)return e.slice();var n=e.length,r=Ge?Ge(n):new e.constructor(n);return e.copy(r),r}function Di(e){var t=new e.constructor(e.byteLength);return new We(t).set(new We(e)),t}function Ni(e,t){var n=t?Di(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ii(e,t){if(e!==t){var r=e!==n,i=null===e,a=e==e,o=ls(e),s=t!==n,u=null===t,c=t==t,l=ls(t);if(!u&&!l&&!o&&e>t||o&&s&&c&&!u&&!l||i&&s&&c||!r&&c||!a)return 1;if(!i&&!o&&!l&&e<t||l&&r&&a&&!i&&!o||u&&r&&a||!s&&a||!c)return-1}return 0}function Ti(e,t,n,r){for(var i=-1,a=e.length,o=n.length,s=-1,u=t.length,c=_n(a-o,0),l=Ee(u+c),p=!r;++s<u;)l[s]=t[s];for(;++i<o;)(p||i<a)&&(l[n[i]]=e[i]);for(;c--;)l[s++]=e[i++];return l}function wi(e,t,n,r){for(var i=-1,a=e.length,o=-1,s=n.length,u=-1,c=t.length,l=_n(a-s,0),p=Ee(l+c),d=!r;++i<l;)p[i]=e[i];for(var h=i;++u<c;)p[h+u]=t[u];for(;++o<s;)(d||i<a)&&(p[h+n[o]]=e[i++]);return p}function Li(e,t){var n=-1,r=e.length;for(t||(t=Ee(r));++n<r;)t[n]=e[n];return t}function Ki(e,t,r,i){var a=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var u=t[o],c=i?i(r[u],e[u],u,r,e):n;c===n&&(c=e[u]),a?sr(r,u,c):rr(r,u,c)}return r}function ki(e,t){return function(n,r){var i=zo(n)?It:ar,a=t?t():{};return i(n,e,la(r,2),a)}}function Oi(e){return Qr((function(t,r){var i=-1,a=r.length,o=a>1?r[a-1]:n,s=a>2?r[2]:n;for(o=e.length>3&&"function"==typeof o?(a--,o):n,s&&Ca(r[0],r[1],s)&&(o=a<3?n:o,a=1),t=Te(t);++i<a;){var u=r[i];u&&e(t,u,i,o)}return t}))}function xi(e,t){return function(n,r){if(null==n)return n;if(!Go(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=Te(n);(t?a--:++a<i)&&!1!==r(o[a],a,o););return n}}function Ri(e){return function(t,n,r){for(var i=-1,a=Te(t),o=r(t),s=o.length;s--;){var u=o[e?s:++i];if(!1===n(a[u],u,a))break}return t}}function Fi(e){return function(t){var r=un(t=_s(t))?fn(t):n,i=r?r[0]:t.charAt(0),a=r?Mi(r,1).join(""):t.slice(1);return i[e]()+a}}function Pi(e){return function(t){return Ft(Zs(qs(t).replace(et,"")),e,"")}}function Ui(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=jn(e.prototype),r=e.apply(n,t);return ns(r)?r:n}}function Bi(e){return function(t,r,i){var a=Te(t);if(!Go(t)){var o=la(r,3);t=ks(t),r=function(e){return o(a[e],e,a)}}var s=e(t,r,i);return s>-1?a[o?t[s]:s]:n}}function Hi(e){return ia((function(t){var i=t.length,a=i,o=qn.prototype.thru;for(e&&t.reverse();a--;){var s=t[a];if("function"!=typeof s)throw new Ke(r);if(o&&!u&&"wrapper"==ua(s))var u=new qn([],!0)}for(a=u?a:i;++a<i;){var c=ua(s=t[a]),l="wrapper"==c?sa(s):n;u=l&&Ma(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[ua(l[0])].apply(u,l[3]):1==s.length&&Ma(s)?u[c]():u.thru(s)}return function(){var e=arguments,n=e[0];if(u&&1==e.length&&zo(n))return u.plant(n).value();for(var r=0,a=i?t[r].apply(this,e):n;++r<i;)a=t[r].call(this,a);return a}}))}function Vi(e,t,r,i,a,o,s,u,l,p){var d=t&c,h=1&t,f=2&t,g=24&t,y=512&t,m=f?n:Ui(e);return function c(){for(var v=arguments.length,S=Ee(v),_=v;_--;)S[_]=arguments[_];if(g)var C=ca(c),b=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(S,C);if(i&&(S=Ti(S,i,a,g)),o&&(S=wi(S,o,s,g)),v-=b,g&&v<p){var M=pn(S,C);return Yi(e,t,Vi,c.placeholder,r,S,M,u,l,p-v)}var E=h?r:this,A=f?E[e]:e;return v=S.length,u?S=function(e,t){for(var r=e.length,i=Cn(t.length,r),a=Li(e);i--;){var o=t[i];e[i]=_a(o,r)?a[o]:n}return e}(S,u):y&&v>1&&S.reverse(),d&&l<v&&(S.length=l),this&&this!==gt&&this instanceof c&&(A=m||Ui(A)),A.apply(E,S)}}function ji(e,t){return function(n,r){return function(e,t,n,r){return br(e,(function(e,i,a){t(r,n(e),i,a)})),r}(n,e,t(r),{})}}function $i(e,t){return function(r,i){var a;if(r===n&&i===n)return t;if(r!==n&&(a=r),i!==n){if(a===n)return i;"string"==typeof r||"string"==typeof i?(r=pi(r),i=pi(i)):(r=li(r),i=li(i)),a=e(r,i)}return a}}function qi(e){return ia((function(t){return t=xt(t,Zt(la())),Qr((function(n){var r=this;return e(t,(function(e){return Nt(e,r,n)}))}))}))}function zi(e,t){var r=(t=t===n?" ":pi(t)).length;if(r<2)return r?Jr(t,e):t;var i=Jr(t,mt(e/hn(t)));return un(t)?Mi(fn(i),0,e).join(""):i.slice(0,e)}function Wi(e){return function(t,r,i){return i&&"number"!=typeof i&&Ca(t,r,i)&&(r=i=n),t=gs(t),r===n?(r=t,t=0):r=gs(r),function(e,t,n,r){for(var i=-1,a=_n(mt((t-e)/(n||1)),0),o=Ee(a);a--;)o[r?a:++i]=e,e+=n;return o}(t,r,i=i===n?t<r?1:-1:gs(i),e)}}function Gi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=vs(t),n=vs(n)),e(t,n)}}function Yi(e,t,r,i,a,o,c,l,p,d){var h=8&t;t|=h?s:u,4&(t&=~(h?u:s))||(t&=-4);var f=[e,t,a,h?o:n,h?c:n,h?n:o,h?n:c,l,p,d],g=r.apply(n,f);return Ma(e)&&La(g,f),g.placeholder=i,Oa(g,e,t)}function Xi(e){var t=Ie[e];return function(e,n){if(e=vs(e),(n=null==n?0:Cn(ys(n),292))&&Gt(e)){var r=(_s(e)+"e").split("e");return+((r=(_s(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Ji=Tn&&1/dn(new Tn([,-0]))[1]==p?function(e){return new Tn(e)}:lu;function Qi(e){return function(t){var n=ya(t);return n==A?cn(t):n==w?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return xt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Zi(e,t,i,p,d,h,f,g){var y=2&t;if(!y&&"function"!=typeof e)throw new Ke(r);var m=p?p.length:0;if(m||(t&=-97,p=d=n),f=f===n?f:_n(ys(f),0),g=g===n?g:ys(g),m-=d?d.length:0,t&u){var v=p,S=d;p=d=n}var _=y?n:sa(e),C=[e,t,i,p,d,v,S,h,f,g];if(_&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=r==c&&8==n||r==c&&n==l&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var u=t[3];if(u){var p=e[3];e[3]=p?Ti(p,u,t[4]):u,e[4]=p?pn(e[3],a):t[4]}u=t[5],u&&(p=e[5],e[5]=p?wi(p,u,t[6]):u,e[6]=p?pn(e[5],a):t[6]),u=t[7],u&&(e[7]=u),r&c&&(e[8]=null==e[8]?t[8]:Cn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(C,_),e=C[0],t=C[1],i=C[2],p=C[3],d=C[4],!(g=C[9]=C[9]===n?y?0:e.length:_n(C[9]-m,0))&&24&t&&(t&=-25),t&&1!=t)b=8==t||t==o?function(e,t,r){var i=Ui(e);return function a(){for(var o=arguments.length,s=Ee(o),u=o,c=ca(a);u--;)s[u]=arguments[u];var l=o<3&&s[0]!==c&&s[o-1]!==c?[]:pn(s,c);return(o-=l.length)<r?Yi(e,t,Vi,a.placeholder,n,s,l,n,n,r-o):Nt(this&&this!==gt&&this instanceof a?i:e,this,s)}}(e,t,g):t!=s&&33!=t||d.length?Vi.apply(n,C):function(e,t,n,r){var i=1&t,a=Ui(e);return function t(){for(var o=-1,s=arguments.length,u=-1,c=r.length,l=Ee(c+s),p=this&&this!==gt&&this instanceof t?a:e;++u<c;)l[u]=r[u];for(;s--;)l[u++]=arguments[++o];return Nt(p,i?n:this,l)}}(e,t,i,p);else var b=function(e,t,n){var r=1&t,i=Ui(e);return function t(){return(this&&this!==gt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,i);return Oa((_?ni:La)(b,C),e,t)}function ea(e,t,r,i){return e===n||Vo(e,xe[r])&&!Pe.call(i,r)?t:e}function ta(e,t,r,i,a,o){return ns(e)&&ns(t)&&(o.set(t,e),$r(e,t,n,ta,o),o.delete(t)),e}function na(e){return os(e)?n:e}function ra(e,t,r,i,a,o){var s=1&r,u=e.length,c=t.length;if(u!=c&&!(s&&c>u))return!1;var l=o.get(e),p=o.get(t);if(l&&p)return l==t&&p==e;var d=-1,h=!0,f=2&r?new Xn:n;for(o.set(e,t),o.set(t,e);++d<u;){var g=e[d],y=t[d];if(i)var m=s?i(y,g,d,t,e,o):i(g,y,d,e,t,o);if(m!==n){if(m)continue;h=!1;break}if(f){if(!Ut(t,(function(e,t){if(!tn(f,t)&&(g===e||a(g,e,r,i,o)))return f.push(t)}))){h=!1;break}}else if(g!==y&&!a(g,y,r,i,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function ia(e){return ka(Ia(e,n,za),e+"")}function aa(e){return Dr(e,ks,fa)}function oa(e){return Dr(e,Os,ga)}var sa=Kn?function(e){return Kn.get(e)}:lu;function ua(e){for(var t=e.name+"",n=kn[t],r=Pe.call(kn,t)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==e)return i.name}return t}function ca(e){return(Pe.call(Vn,"placeholder")?Vn:e).placeholder}function la(){var e=Vn.iteratee||ou;return e=e===ou?Fr:e,arguments.length?e(arguments[0],arguments[1]):e}function pa(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function da(e){for(var t=ks(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Da(i)]}return t}function ha(e,t){var r=function(e,t){return null==e?n:e[t]}(e,t);return Rr(r)?r:n}var fa=_t?function(e){return null==e?[]:(e=Te(e),Kt(_t(e),(function(t){return Je.call(e,t)})))}:mu,ga=_t?function(e){for(var t=[];e;)Rt(t,fa(e)),e=Ye(e);return t}:mu,ya=Nr;function ma(e,t,n){for(var r=-1,i=(t=Ci(t,e)).length,a=!1;++r<i;){var o=Pa(t[r]);if(!(a=null!=e&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&ts(i)&&_a(o,i)&&(zo(e)||qo(e))}function va(e){return"function"!=typeof e.constructor||Aa(e)?{}:jn(Ye(e))}function Sa(e){return zo(e)||qo(e)||!!(Ze&&e&&e[Ze])}function _a(e,t){var n=typeof e;return!!(t=t??d)&&("number"==n||"symbol"!=n&&_e.test(e))&&e>-1&&e%1==0&&e<t}function Ca(e,t,n){if(!ns(n))return!1;var r=typeof t;return!!("number"==r?Go(n)&&_a(t,n.length):"string"==r&&t in n)&&Vo(n[t],e)}function ba(e,t){if(zo(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ls(e))||(ne.test(e)||!te.test(e)||null!=t&&e in Te(t))}function Ma(e){var t=ua(e),n=Vn[t];if("function"!=typeof n||!(t in zn.prototype))return!1;if(e===n)return!0;var r=sa(n);return!!r&&e===r[0]}(Dn&&ya(new Dn(new ArrayBuffer(1)))!=x||Nn&&ya(new Nn)!=A||In&&ya(In.resolve())!=I||Tn&&ya(new Tn)!=w||wn&&ya(new wn)!=k)&&(ya=function(e){var t=Nr(e),r=t==N?e.constructor:n,i=r?Ua(r):"";if(i)switch(i){case On:return x;case xn:return A;case Rn:return I;case Fn:return w;case Pn:return k}return t});var Ea=Re?Zo:vu;function Aa(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||xe)}function Da(e){return e==e&&!ns(e)}function Na(e,t){return function(r){return null!=r&&(r[e]===t&&(t!==n||e in Te(r)))}}function Ia(e,t,r){return t=_n(t===n?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=_n(n.length-t,0),o=Ee(a);++i<a;)o[i]=n[t+i];i=-1;for(var s=Ee(t+1);++i<t;)s[i]=n[i];return s[t]=r(o),Nt(e,this,s)}}function Ta(e,t){return t.length<2?e:Ar(e,ai(t,0,-1))}function wa(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var La=xa(ni),Ka=yt||function(e,t){return gt.setTimeout(e,t)},ka=xa(ri);function Oa(e,t,n){var r=t+"";return ka(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ue,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Tt(m,(function(n){var r="_."+n[0];t&n[1]&&!kt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ce);return t?t[1].split(le):[]}(r),n)))}function xa(e){var t=0,r=0;return function(){var i=bn(),a=16-(i-r);if(r=i,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(n,arguments)}}function Ra(e,t){var r=-1,i=e.length,a=i-1;for(t=t===n?i:t;++r<t;){var o=Xr(r,a),s=e[o];e[o]=e[r],e[r]=s}return e.length=t,e}var Fa=function(e){var t=Ro(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,n,r,i){t.push(r?i.replace(he,"$1"):n||e)})),t}));function Pa(e){if("string"==typeof e||ls(e))return e;var t=e+"";return"0"==t&&1/e==-p?"-0":t}function Ua(e){if(null!=e){try{return Fe.call(e)}catch{}try{return e+""}catch{}}return""}function Ba(e){if(e instanceof zn)return e.clone();var t=new qn(e.__wrapped__,e.__chain__);return t.__actions__=Li(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ha=Qr((function(e,t){return Yo(e)?hr(e,Sr(t,1,Yo,!0)):[]})),Va=Qr((function(e,t){var r=Ja(t);return Yo(r)&&(r=n),Yo(e)?hr(e,Sr(t,1,Yo,!0),la(r,2)):[]})),ja=Qr((function(e,t){var r=Ja(t);return Yo(r)&&(r=n),Yo(e)?hr(e,Sr(t,1,Yo,!0),n,r):[]}));function $a(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ys(n);return i<0&&(i=_n(r+i,0)),Vt(e,la(t,3),i)}function qa(e,t,r){var i=null==e?0:e.length;if(!i)return-1;var a=i-1;return r!==n&&(a=ys(r),a=r<0?_n(i+a,0):Cn(a,i-1)),Vt(e,la(t,3),a,!0)}function za(e){return(null==e?0:e.length)?Sr(e,1):[]}function Wa(e){return e&&e.length?e[0]:n}var Ga=Qr((function(e){var t=xt(e,Si);return t.length&&t[0]===e[0]?Lr(t):[]})),Ya=Qr((function(e){var t=Ja(e),r=xt(e,Si);return t===Ja(r)?t=n:r.pop(),r.length&&r[0]===e[0]?Lr(r,la(t,2)):[]})),Xa=Qr((function(e){var t=Ja(e),r=xt(e,Si);return(t="function"==typeof t?t:n)&&r.pop(),r.length&&r[0]===e[0]?Lr(r,n,t):[]}));function Ja(e){var t=null==e?0:e.length;return t?e[t-1]:n}var Qa=Qr(Za);function Za(e,t){return e&&e.length&&t&&t.length?Gr(e,t):e}var eo=ia((function(e,t){var n=null==e?0:e.length,r=ur(e,t);return Yr(e,xt(t,(function(e){return _a(e,n)?+e:e})).sort(Ii)),r}));function to(e){return null==e?e:An.call(e)}var no=Qr((function(e){return di(Sr(e,1,Yo,!0))})),ro=Qr((function(e){var t=Ja(e);return Yo(t)&&(t=n),di(Sr(e,1,Yo,!0),la(t,2))})),io=Qr((function(e){var t=Ja(e);return t="function"==typeof t?t:n,di(Sr(e,1,Yo,!0),n,t)}));function ao(e){if(!e||!e.length)return[];var t=0;return e=Kt(e,(function(e){if(Yo(e))return t=_n(e.length,t),!0})),Jt(t,(function(t){return xt(e,Wt(t))}))}function oo(e,t){if(!e||!e.length)return[];var r=ao(e);return null==t?r:xt(r,(function(e){return Nt(t,n,e)}))}var so=Qr((function(e,t){return Yo(e)?hr(e,t):[]})),uo=Qr((function(e){return mi(Kt(e,Yo))})),co=Qr((function(e){var t=Ja(e);return Yo(t)&&(t=n),mi(Kt(e,Yo),la(t,2))})),lo=Qr((function(e){var t=Ja(e);return t="function"==typeof t?t:n,mi(Kt(e,Yo),n,t)})),po=Qr(ao);var ho=Qr((function(e){var t=e.length,r=t>1?e[t-1]:n;return r="function"==typeof r?(e.pop(),r):n,oo(e,r)}));function fo(e){var t=Vn(e);return t.__chain__=!0,t}function go(e,t){return t(e)}var yo=ia((function(e){var t=e.length,r=t?e[0]:0,i=this.__wrapped__,a=function(t){return ur(t,e)};return!(t>1||this.__actions__.length)&&i instanceof zn&&_a(r)?((i=i.slice(r,+r+(t?1:0))).__actions__.push({func:go,args:[a],thisArg:n}),new qn(i,this.__chain__).thru((function(e){return t&&!e.length&&e.push(n),e}))):this.thru(a)}));var mo=ki((function(e,t,n){Pe.call(e,n)?++e[n]:sr(e,n,1)}));var vo=Bi($a),So=Bi(qa);function _o(e,t){return(zo(e)?Tt:fr)(e,la(t,3))}function Co(e,t){return(zo(e)?wt:gr)(e,la(t,3))}var bo=ki((function(e,t,n){Pe.call(e,n)?e[n].push(t):sr(e,n,[t])}));var Mo=Qr((function(e,t,n){var r=-1,i="function"==typeof t,a=Go(e)?Ee(e.length):[];return fr(e,(function(e){a[++r]=i?Nt(t,e,n):Kr(e,t,n)})),a})),Eo=ki((function(e,t,n){sr(e,n,t)}));function Ao(e,t){return(zo(e)?xt:Hr)(e,la(t,3))}var Do=ki((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var No=Qr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Ca(e,t[0],t[1])?t=[]:n>2&&Ca(t[0],t[1],t[2])&&(t=[t[0]]),zr(e,Sr(t,1),[])})),Io=ft||function(){return gt.Date.now()};function To(e,t,r){return t=r?n:t,t=e&&null==t?e.length:t,Zi(e,c,n,n,n,n,t)}function wo(e,t){var i;if("function"!=typeof t)throw new Ke(r);return e=ys(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=n),i}}var Lo=Qr((function(e,t,n){var r=1;if(n.length){var i=pn(n,ca(Lo));r|=s}return Zi(e,r,t,n,i)})),Ko=Qr((function(e,t,n){var r=3;if(n.length){var i=pn(n,ca(Ko));r|=s}return Zi(t,r,e,n,i)}));function ko(e,t,i){var a,o,s,u,c,l,p=0,d=!1,h=!1,f=!0;if("function"!=typeof e)throw new Ke(r);function g(t){var r=a,i=o;return a=o=n,p=t,u=e.apply(i,r)}function y(e){var r=e-l;return l===n||r>=t||r<0||h&&e-p>=s}function m(){var e=Io();if(y(e))return v(e);c=Ka(m,function(e){var n=t-(e-l);return h?Cn(n,s-(e-p)):n}(e))}function v(e){return c=n,f&&a?g(e):(a=o=n,u)}function S(){var e=Io(),r=y(e);if(a=arguments,o=this,l=e,r){if(c===n)return function(e){return p=e,c=Ka(m,t),d?g(e):u}(l);if(h)return Ei(c),c=Ka(m,t),g(l)}return c===n&&(c=Ka(m,t)),u}return t=vs(t)||0,ns(i)&&(d=!!i.leading,s=(h="maxWait"in i)?_n(vs(i.maxWait)||0,t):s,f="trailing"in i?!!i.trailing:f),S.cancel=function(){c!==n&&Ei(c),p=0,a=l=o=c=n},S.flush=function(){return c===n?u:v(Io())},S}var Oo=Qr((function(e,t){return dr(e,1,t)})),xo=Qr((function(e,t,n){return dr(e,vs(t)||0,n)}));function Ro(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ke(r);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(Ro.Cache||Yn),n}function Fo(e){if("function"!=typeof e)throw new Ke(r);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ro.Cache=Yn;var Po=bi((function(e,t){var n=(t=1==t.length&&zo(t[0])?xt(t[0],Zt(la())):xt(Sr(t,1),Zt(la()))).length;return Qr((function(r){for(var i=-1,a=Cn(r.length,n);++i<a;)r[i]=t[i].call(this,r[i]);return Nt(e,this,r)}))})),Uo=Qr((function(e,t){var r=pn(t,ca(Uo));return Zi(e,s,n,t,r)})),Bo=Qr((function(e,t){var r=pn(t,ca(Bo));return Zi(e,u,n,t,r)})),Ho=ia((function(e,t){return Zi(e,l,n,n,n,t)}));function Vo(e,t){return e===t||e!=e&&t!=t}var jo=Gi(Ir),$o=Gi((function(e,t){return e>=t})),qo=kr(function(){return arguments}())?kr:function(e){return rs(e)&&Pe.call(e,"callee")&&!Je.call(e,"callee")},zo=Ee.isArray,Wo=Ct?Zt(Ct):function(e){return rs(e)&&Nr(e)==O};function Go(e){return null!=e&&ts(e.length)&&!Zo(e)}function Yo(e){return rs(e)&&Go(e)}var Xo=Bt||vu,Jo=bt?Zt(bt):function(e){return rs(e)&&Nr(e)==C};function Qo(e){if(!rs(e))return!1;var t=Nr(e);return t==b||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!os(e)}function Zo(e){if(!ns(e))return!1;var t=Nr(e);return t==M||t==E||"[object AsyncFunction]"==t||"[object Proxy]"==t}function es(e){return"number"==typeof e&&e==ys(e)}function ts(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function ns(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function rs(e){return null!=e&&"object"==typeof e}var is=Mt?Zt(Mt):function(e){return rs(e)&&ya(e)==A};function as(e){return"number"==typeof e||rs(e)&&Nr(e)==D}function os(e){if(!rs(e)||Nr(e)!=N)return!1;var t=Ye(e);if(null===t)return!0;var n=Pe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Fe.call(n)==Ve}var ss=Et?Zt(Et):function(e){return rs(e)&&Nr(e)==T};var us=At?Zt(At):function(e){return rs(e)&&ya(e)==w};function cs(e){return"string"==typeof e||!zo(e)&&rs(e)&&Nr(e)==L}function ls(e){return"symbol"==typeof e||rs(e)&&Nr(e)==K}var ps=Dt?Zt(Dt):function(e){return rs(e)&&ts(e.length)&&!!ut[Nr(e)]};var ds=Gi(Br),hs=Gi((function(e,t){return e<=t}));function fs(e){if(!e)return[];if(Go(e))return cs(e)?fn(e):Li(e);if(nt&&e[nt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[nt]());var t=ya(e);return(t==A?cn:t==w?dn:Vs)(e)}function gs(e){return e?(e=vs(e))===p||e===-p?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ys(e){var t=gs(e),n=t%1;return t==t?n?t-n:t:0}function ms(e){return e?cr(ys(e),0,f):0}function vs(e){if("number"==typeof e)return e;if(ls(e))return h;if(ns(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ns(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Qt(e);var n=me.test(e);return n||Se.test(e)?dt(e.slice(2),n?2:8):ye.test(e)?h:+e}function Ss(e){return Ki(e,Os(e))}function _s(e){return null==e?"":pi(e)}var Cs=Oi((function(e,t){if(Aa(t)||Go(t))Ki(t,ks(t),e);else for(var n in t)Pe.call(t,n)&&rr(e,n,t[n])})),bs=Oi((function(e,t){Ki(t,Os(t),e)})),Ms=Oi((function(e,t,n,r){Ki(t,Os(t),e,r)})),Es=Oi((function(e,t,n,r){Ki(t,ks(t),e,r)})),As=ia(ur);var Ds=Qr((function(e,t){e=Te(e);var r=-1,i=t.length,a=i>2?t[2]:n;for(a&&Ca(t[0],t[1],a)&&(i=1);++r<i;)for(var o=t[r],s=Os(o),u=-1,c=s.length;++u<c;){var l=s[u],p=e[l];(p===n||Vo(p,xe[l])&&!Pe.call(e,l))&&(e[l]=o[l])}return e})),Ns=Qr((function(e){return e.push(n,ta),Nt(Rs,n,e)}));function Is(e,t,r){var i=null==e?n:Ar(e,t);return i===n?r:i}function Ts(e,t){return null!=e&&ma(e,t,wr)}var ws=ji((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=He.call(t)),e[t]=n}),nu(au)),Ls=ji((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=He.call(t)),Pe.call(e,t)?e[t].push(n):e[t]=[n]}),la),Ks=Qr(Kr);function ks(e){return Go(e)?Qn(e):Pr(e)}function Os(e){return Go(e)?Qn(e,!0):Ur(e)}var xs=Oi((function(e,t,n){$r(e,t,n)})),Rs=Oi((function(e,t,n,r){$r(e,t,n,r)})),Fs=ia((function(e,t){var n={};if(null==e)return n;var r=!1;t=xt(t,(function(t){return t=Ci(t,e),r||(r=t.length>1),t})),Ki(e,oa(e),n),r&&(n=lr(n,7,na));for(var i=t.length;i--;)hi(n,t[i]);return n}));var Ps=ia((function(e,t){return null==e?{}:function(e,t){return Wr(e,t,(function(t,n){return Ts(e,n)}))}(e,t)}));function Us(e,t){if(null==e)return{};var n=xt(oa(e),(function(e){return[e]}));return t=la(t),Wr(e,n,(function(e,n){return t(e,n[0])}))}var Bs=Qi(ks),Hs=Qi(Os);function Vs(e){return null==e?[]:en(e,ks(e))}var js=Pi((function(e,t,n){return t=t.toLowerCase(),e+(n?$s(t):t)}));function $s(e){return Qs(_s(e).toLowerCase())}function qs(e){return(e=_s(e))&&e.replace(Ce,an).replace(tt,"")}var zs=Pi((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Ws=Pi((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Gs=Fi("toLowerCase");var Ys=Pi((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Xs=Pi((function(e,t,n){return e+(n?" ":"")+Qs(t)}));var Js=Pi((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Qs=Fi("toUpperCase");function Zs(e,t,r){return e=_s(e),(t=r?n:t)===n?function(e){return at.test(e)}(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.match(pe)||[]}(e):e.match(t)||[]}var eu=Qr((function(e,t){try{return Nt(e,n,t)}catch(e){return Qo(e)?e:new De(e)}})),tu=ia((function(e,t){return Tt(t,(function(t){t=Pa(t),sr(e,t,Lo(e[t],e))})),e}));function nu(e){return function(){return e}}var ru=Hi(),iu=Hi(!0);function au(e){return e}function ou(e){return Fr("function"==typeof e?e:lr(e,1))}var su=Qr((function(e,t){return function(n){return Kr(n,e,t)}})),uu=Qr((function(e,t){return function(n){return Kr(e,n,t)}}));function cu(e,t,n){var r=ks(t),i=Er(t,r);null==n&&(!ns(t)||!i.length&&r.length)&&(n=t,t=e,e=this,i=Er(t,ks(t)));var a=!(ns(n)&&"chain"in n&&!n.chain),o=Zo(e);return Tt(i,(function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=Li(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Rt([this.value()],arguments))})})),e}function lu(){}var pu=qi(xt),du=qi(Lt),hu=qi(Ut);function fu(e){return ba(e)?Wt(Pa(e)):function(e){return function(t){return Ar(t,e)}}(e)}var gu=Wi(),yu=Wi(!0);function mu(){return[]}function vu(){return!1}var Su=$i((function(e,t){return e+t}),0),_u=Xi("ceil"),Cu=$i((function(e,t){return e/t}),1),bu=Xi("floor");var Mu=$i((function(e,t){return e*t}),1),Eu=Xi("round"),Au=$i((function(e,t){return e-t}),0);return Vn.after=function(e,t){if("function"!=typeof t)throw new Ke(r);return e=ys(e),function(){if(--e<1)return t.apply(this,arguments)}},Vn.ary=To,Vn.assign=Cs,Vn.assignIn=bs,Vn.assignInWith=Ms,Vn.assignWith=Es,Vn.at=As,Vn.before=wo,Vn.bind=Lo,Vn.bindAll=tu,Vn.bindKey=Ko,Vn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return zo(e)?e:[e]},Vn.chain=fo,Vn.chunk=function(e,t,r){t=(r?Ca(e,t,r):t===n)?1:_n(ys(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var a=0,o=0,s=Ee(mt(i/t));a<i;)s[o++]=ai(e,a,a+=t);return s},Vn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var a=e[t];a&&(i[r++]=a)}return i},Vn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=Ee(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return Rt(zo(n)?Li(n):[n],Sr(t,1))},Vn.cond=function(e){var t=null==e?0:e.length,n=la();return e=t?xt(e,(function(e){if("function"!=typeof e[1])throw new Ke(r);return[n(e[0]),e[1]]})):[],Qr((function(n){for(var r=-1;++r<t;){var i=e[r];if(Nt(i[0],this,n))return Nt(i[1],this,n)}}))},Vn.conforms=function(e){return function(e){var t=ks(e);return function(n){return pr(n,e,t)}}(lr(e,1))},Vn.constant=nu,Vn.countBy=mo,Vn.create=function(e,t){var n=jn(e);return null==t?n:or(n,t)},Vn.curry=function e(t,r,i){var a=Zi(t,8,n,n,n,n,n,r=i?n:r);return a.placeholder=e.placeholder,a},Vn.curryRight=function e(t,r,i){var a=Zi(t,o,n,n,n,n,n,r=i?n:r);return a.placeholder=e.placeholder,a},Vn.debounce=ko,Vn.defaults=Ds,Vn.defaultsDeep=Ns,Vn.defer=Oo,Vn.delay=xo,Vn.difference=Ha,Vn.differenceBy=Va,Vn.differenceWith=ja,Vn.drop=function(e,t,r){var i=null==e?0:e.length;return i?ai(e,(t=r||t===n?1:ys(t))<0?0:t,i):[]},Vn.dropRight=function(e,t,r){var i=null==e?0:e.length;return i?ai(e,0,(t=i-(t=r||t===n?1:ys(t)))<0?0:t):[]},Vn.dropRightWhile=function(e,t){return e&&e.length?gi(e,la(t,3),!0,!0):[]},Vn.dropWhile=function(e,t){return e&&e.length?gi(e,la(t,3),!0):[]},Vn.fill=function(e,t,r,i){var a=null==e?0:e.length;return a?(r&&"number"!=typeof r&&Ca(e,t,r)&&(r=0,i=a),function(e,t,r,i){var a=e.length;for((r=ys(r))<0&&(r=-r>a?0:a+r),(i=i===n||i>a?a:ys(i))<0&&(i+=a),i=r>i?0:ms(i);r<i;)e[r++]=t;return e}(e,t,r,i)):[]},Vn.filter=function(e,t){return(zo(e)?Kt:vr)(e,la(t,3))},Vn.flatMap=function(e,t){return Sr(Ao(e,t),1)},Vn.flatMapDeep=function(e,t){return Sr(Ao(e,t),p)},Vn.flatMapDepth=function(e,t,r){return r=r===n?1:ys(r),Sr(Ao(e,t),r)},Vn.flatten=za,Vn.flattenDeep=function(e){return(null==e?0:e.length)?Sr(e,p):[]},Vn.flattenDepth=function(e,t){return(null==e?0:e.length)?Sr(e,t=t===n?1:ys(t)):[]},Vn.flip=function(e){return Zi(e,512)},Vn.flow=ru,Vn.flowRight=iu,Vn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Vn.functions=function(e){return null==e?[]:Er(e,ks(e))},Vn.functionsIn=function(e){return null==e?[]:Er(e,Os(e))},Vn.groupBy=bo,Vn.initial=function(e){return(null==e?0:e.length)?ai(e,0,-1):[]},Vn.intersection=Ga,Vn.intersectionBy=Ya,Vn.intersectionWith=Xa,Vn.invert=ws,Vn.invertBy=Ls,Vn.invokeMap=Mo,Vn.iteratee=ou,Vn.keyBy=Eo,Vn.keys=ks,Vn.keysIn=Os,Vn.map=Ao,Vn.mapKeys=function(e,t){var n={};return t=la(t,3),br(e,(function(e,r,i){sr(n,t(e,r,i),e)})),n},Vn.mapValues=function(e,t){var n={};return t=la(t,3),br(e,(function(e,r,i){sr(n,r,t(e,r,i))})),n},Vn.matches=function(e){return Vr(lr(e,1))},Vn.matchesProperty=function(e,t){return jr(e,lr(t,1))},Vn.memoize=Ro,Vn.merge=xs,Vn.mergeWith=Rs,Vn.method=su,Vn.methodOf=uu,Vn.mixin=cu,Vn.negate=Fo,Vn.nthArg=function(e){return e=ys(e),Qr((function(t){return qr(t,e)}))},Vn.omit=Fs,Vn.omitBy=function(e,t){return Us(e,Fo(la(t)))},Vn.once=function(e){return wo(2,e)},Vn.orderBy=function(e,t,r,i){return null==e?[]:(zo(t)||(t=null==t?[]:[t]),zo(r=i?n:r)||(r=null==r?[]:[r]),zr(e,t,r))},Vn.over=pu,Vn.overArgs=Po,Vn.overEvery=du,Vn.overSome=hu,Vn.partial=Uo,Vn.partialRight=Bo,Vn.partition=Do,Vn.pick=Ps,Vn.pickBy=Us,Vn.property=fu,Vn.propertyOf=function(e){return function(t){return null==e?n:Ar(e,t)}},Vn.pull=Qa,Vn.pullAll=Za,Vn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Gr(e,t,la(n,2)):e},Vn.pullAllWith=function(e,t,r){return e&&e.length&&t&&t.length?Gr(e,t,n,r):e},Vn.pullAt=eo,Vn.range=gu,Vn.rangeRight=yu,Vn.rearg=Ho,Vn.reject=function(e,t){return(zo(e)?Kt:vr)(e,Fo(la(t,3)))},Vn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],a=e.length;for(t=la(t,3);++r<a;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r))}return Yr(e,i),n},Vn.rest=function(e,t){if("function"!=typeof e)throw new Ke(r);return Qr(e,t=t===n?t:ys(t))},Vn.reverse=to,Vn.sampleSize=function(e,t,r){return t=(r?Ca(e,t,r):t===n)?1:ys(t),(zo(e)?er:ei)(e,t)},Vn.set=function(e,t,n){return null==e?e:ti(e,t,n)},Vn.setWith=function(e,t,r,i){return i="function"==typeof i?i:n,null==e?e:ti(e,t,r,i)},Vn.shuffle=function(e){return(zo(e)?tr:ii)(e)},Vn.slice=function(e,t,r){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&Ca(e,t,r)?(t=0,r=i):(t=null==t?0:ys(t),r=r===n?i:ys(r)),ai(e,t,r)):[]},Vn.sortBy=No,Vn.sortedUniq=function(e){return e&&e.length?ci(e):[]},Vn.sortedUniqBy=function(e,t){return e&&e.length?ci(e,la(t,2)):[]},Vn.split=function(e,t,r){return r&&"number"!=typeof r&&Ca(e,t,r)&&(t=r=n),(r=r===n?f:r>>>0)?(e=_s(e))&&("string"==typeof t||null!=t&&!ss(t))&&(!(t=pi(t))&&un(e))?Mi(fn(e),0,r):e.split(t,r):[]},Vn.spread=function(e,t){if("function"!=typeof e)throw new Ke(r);return t=null==t?0:_n(ys(t),0),Qr((function(n){var r=n[t],i=Mi(n,0,t);return r&&Rt(i,r),Nt(e,this,i)}))},Vn.tail=function(e){var t=null==e?0:e.length;return t?ai(e,1,t):[]},Vn.take=function(e,t,r){return e&&e.length?ai(e,0,(t=r||t===n?1:ys(t))<0?0:t):[]},Vn.takeRight=function(e,t,r){var i=null==e?0:e.length;return i?ai(e,(t=i-(t=r||t===n?1:ys(t)))<0?0:t,i):[]},Vn.takeRightWhile=function(e,t){return e&&e.length?gi(e,la(t,3),!1,!0):[]},Vn.takeWhile=function(e,t){return e&&e.length?gi(e,la(t,3)):[]},Vn.tap=function(e,t){return t(e),e},Vn.throttle=function(e,t,n){var i=!0,a=!0;if("function"!=typeof e)throw new Ke(r);return ns(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),ko(e,t,{leading:i,maxWait:t,trailing:a})},Vn.thru=go,Vn.toArray=fs,Vn.toPairs=Bs,Vn.toPairsIn=Hs,Vn.toPath=function(e){return zo(e)?xt(e,Pa):ls(e)?[e]:Li(Fa(_s(e)))},Vn.toPlainObject=Ss,Vn.transform=function(e,t,n){var r=zo(e),i=r||Xo(e)||ps(e);if(t=la(t,4),null==n){var a=e&&e.constructor;n=i?r?new a:[]:ns(e)&&Zo(a)?jn(Ye(e)):{}}return(i?Tt:br)(e,(function(e,r,i){return t(n,e,r,i)})),n},Vn.unary=function(e){return To(e,1)},Vn.union=no,Vn.unionBy=ro,Vn.unionWith=io,Vn.uniq=function(e){return e&&e.length?di(e):[]},Vn.uniqBy=function(e,t){return e&&e.length?di(e,la(t,2)):[]},Vn.uniqWith=function(e,t){return t="function"==typeof t?t:n,e&&e.length?di(e,n,t):[]},Vn.unset=function(e,t){return null==e||hi(e,t)},Vn.unzip=ao,Vn.unzipWith=oo,Vn.update=function(e,t,n){return null==e?e:fi(e,t,_i(n))},Vn.updateWith=function(e,t,r,i){return i="function"==typeof i?i:n,null==e?e:fi(e,t,_i(r),i)},Vn.values=Vs,Vn.valuesIn=function(e){return null==e?[]:en(e,Os(e))},Vn.without=so,Vn.words=Zs,Vn.wrap=function(e,t){return Uo(_i(t),e)},Vn.xor=uo,Vn.xorBy=co,Vn.xorWith=lo,Vn.zip=po,Vn.zipObject=function(e,t){return vi(e||[],t||[],rr)},Vn.zipObjectDeep=function(e,t){return vi(e||[],t||[],ti)},Vn.zipWith=ho,Vn.entries=Bs,Vn.entriesIn=Hs,Vn.extend=bs,Vn.extendWith=Ms,cu(Vn,Vn),Vn.add=Su,Vn.attempt=eu,Vn.camelCase=js,Vn.capitalize=$s,Vn.ceil=_u,Vn.clamp=function(e,t,r){return r===n&&(r=t,t=n),r!==n&&(r=(r=vs(r))==r?r:0),t!==n&&(t=(t=vs(t))==t?t:0),cr(vs(e),t,r)},Vn.clone=function(e){return lr(e,4)},Vn.cloneDeep=function(e){return lr(e,5)},Vn.cloneDeepWith=function(e,t){return lr(e,5,t="function"==typeof t?t:n)},Vn.cloneWith=function(e,t){return lr(e,4,t="function"==typeof t?t:n)},Vn.conformsTo=function(e,t){return null==t||pr(e,t,ks(t))},Vn.deburr=qs,Vn.defaultTo=function(e,t){return null==e||e!=e?t:e},Vn.divide=Cu,Vn.endsWith=function(e,t,r){e=_s(e),t=pi(t);var i=e.length,a=r=r===n?i:cr(ys(r),0,i);return(r-=t.length)>=0&&e.slice(r,a)==t},Vn.eq=Vo,Vn.escape=function(e){return(e=_s(e))&&J.test(e)?e.replace(Y,on):e},Vn.escapeRegExp=function(e){return(e=_s(e))&&ae.test(e)?e.replace(ie,"\\$&"):e},Vn.every=function(e,t,r){var i=zo(e)?Lt:yr;return r&&Ca(e,t,r)&&(t=n),i(e,la(t,3))},Vn.find=vo,Vn.findIndex=$a,Vn.findKey=function(e,t){return Ht(e,la(t,3),br)},Vn.findLast=So,Vn.findLastIndex=qa,Vn.findLastKey=function(e,t){return Ht(e,la(t,3),Mr)},Vn.floor=bu,Vn.forEach=_o,Vn.forEachRight=Co,Vn.forIn=function(e,t){return null==e?e:_r(e,la(t,3),Os)},Vn.forInRight=function(e,t){return null==e?e:Cr(e,la(t,3),Os)},Vn.forOwn=function(e,t){return e&&br(e,la(t,3))},Vn.forOwnRight=function(e,t){return e&&Mr(e,la(t,3))},Vn.get=Is,Vn.gt=jo,Vn.gte=$o,Vn.has=function(e,t){return null!=e&&ma(e,t,Tr)},Vn.hasIn=Ts,Vn.head=Wa,Vn.identity=au,Vn.includes=function(e,t,n,r){e=Go(e)?e:Vs(e),n=n&&!r?ys(n):0;var i=e.length;return n<0&&(n=_n(i+n,0)),cs(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&jt(e,t,n)>-1},Vn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ys(n);return i<0&&(i=_n(r+i,0)),jt(e,t,i)},Vn.inRange=function(e,t,r){return t=gs(t),r===n?(r=t,t=0):r=gs(r),function(e,t,n){return e>=Cn(t,n)&&e<_n(t,n)}(e=vs(e),t,r)},Vn.invoke=Ks,Vn.isArguments=qo,Vn.isArray=zo,Vn.isArrayBuffer=Wo,Vn.isArrayLike=Go,Vn.isArrayLikeObject=Yo,Vn.isBoolean=function(e){return!0===e||!1===e||rs(e)&&Nr(e)==_},Vn.isBuffer=Xo,Vn.isDate=Jo,Vn.isElement=function(e){return rs(e)&&1===e.nodeType&&!os(e)},Vn.isEmpty=function(e){if(null==e)return!0;if(Go(e)&&(zo(e)||"string"==typeof e||"function"==typeof e.splice||Xo(e)||ps(e)||qo(e)))return!e.length;var t=ya(e);if(t==A||t==w)return!e.size;if(Aa(e))return!Pr(e).length;for(var n in e)if(Pe.call(e,n))return!1;return!0},Vn.isEqual=function(e,t){return Or(e,t)},Vn.isEqualWith=function(e,t,r){var i=(r="function"==typeof r?r:n)?r(e,t):n;return i===n?Or(e,t,n,r):!!i},Vn.isError=Qo,Vn.isFinite=function(e){return"number"==typeof e&&Gt(e)},Vn.isFunction=Zo,Vn.isInteger=es,Vn.isLength=ts,Vn.isMap=is,Vn.isMatch=function(e,t){return e===t||xr(e,t,da(t))},Vn.isMatchWith=function(e,t,r){return r="function"==typeof r?r:n,xr(e,t,da(t),r)},Vn.isNaN=function(e){return as(e)&&e!=+e},Vn.isNative=function(e){if(Ea(e))throw new De("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Rr(e)},Vn.isNil=function(e){return null==e},Vn.isNull=function(e){return null===e},Vn.isNumber=as,Vn.isObject=ns,Vn.isObjectLike=rs,Vn.isPlainObject=os,Vn.isRegExp=ss,Vn.isSafeInteger=function(e){return es(e)&&e>=-d&&e<=d},Vn.isSet=us,Vn.isString=cs,Vn.isSymbol=ls,Vn.isTypedArray=ps,Vn.isUndefined=function(e){return e===n},Vn.isWeakMap=function(e){return rs(e)&&ya(e)==k},Vn.isWeakSet=function(e){return rs(e)&&"[object WeakSet]"==Nr(e)},Vn.join=function(e,t){return null==e?"":vn.call(e,t)},Vn.kebabCase=zs,Vn.last=Ja,Vn.lastIndexOf=function(e,t,r){var i=null==e?0:e.length;if(!i)return-1;var a=i;return r!==n&&(a=(a=ys(r))<0?_n(i+a,0):Cn(a,i-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,a):Vt(e,qt,a,!0)},Vn.lowerCase=Ws,Vn.lowerFirst=Gs,Vn.lt=ds,Vn.lte=hs,Vn.max=function(e){return e&&e.length?mr(e,au,Ir):n},Vn.maxBy=function(e,t){return e&&e.length?mr(e,la(t,2),Ir):n},Vn.mean=function(e){return zt(e,au)},Vn.meanBy=function(e,t){return zt(e,la(t,2))},Vn.min=function(e){return e&&e.length?mr(e,au,Br):n},Vn.minBy=function(e,t){return e&&e.length?mr(e,la(t,2),Br):n},Vn.stubArray=mu,Vn.stubFalse=vu,Vn.stubObject=function(){return{}},Vn.stubString=function(){return""},Vn.stubTrue=function(){return!0},Vn.multiply=Mu,Vn.nth=function(e,t){return e&&e.length?qr(e,ys(t)):n},Vn.noConflict=function(){return gt._===this&&(gt._=je),this},Vn.noop=lu,Vn.now=Io,Vn.pad=function(e,t,n){e=_s(e);var r=(t=ys(t))?hn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return zi(St(i),n)+e+zi(mt(i),n)},Vn.padEnd=function(e,t,n){e=_s(e);var r=(t=ys(t))?hn(e):0;return t&&r<t?e+zi(t-r,n):e},Vn.padStart=function(e,t,n){e=_s(e);var r=(t=ys(t))?hn(e):0;return t&&r<t?zi(t-r,n)+e:e},Vn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Mn(_s(e).replace(oe,""),t||0)},Vn.random=function(e,t,r){if(r&&"boolean"!=typeof r&&Ca(e,t,r)&&(t=r=n),r===n&&("boolean"==typeof t?(r=t,t=n):"boolean"==typeof e&&(r=e,e=n)),e===n&&t===n?(e=0,t=1):(e=gs(e),t===n?(t=e,e=0):t=gs(t)),e>t){var i=e;e=t,t=i}if(r||e%1||t%1){var a=En();return Cn(e+a*(t-e+pt("1e-"+((a+"").length-1))),t)}return Xr(e,t)},Vn.reduce=function(e,t,n){var r=zo(e)?Ft:Yt,i=arguments.length<3;return r(e,la(t,4),n,i,fr)},Vn.reduceRight=function(e,t,n){var r=zo(e)?Pt:Yt,i=arguments.length<3;return r(e,la(t,4),n,i,gr)},Vn.repeat=function(e,t,r){return t=(r?Ca(e,t,r):t===n)?1:ys(t),Jr(_s(e),t)},Vn.replace=function(){var e=arguments,t=_s(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Vn.result=function(e,t,r){var i=-1,a=(t=Ci(t,e)).length;for(a||(a=1,e=n);++i<a;){var o=null==e?n:e[Pa(t[i])];o===n&&(i=a,o=r),e=Zo(o)?o.call(e):o}return e},Vn.round=Eu,Vn.runInContext=e,Vn.sample=function(e){return(zo(e)?Zn:Zr)(e)},Vn.size=function(e){if(null==e)return 0;if(Go(e))return cs(e)?hn(e):e.length;var t=ya(e);return t==A||t==w?e.size:Pr(e).length},Vn.snakeCase=Ys,Vn.some=function(e,t,r){var i=zo(e)?Ut:oi;return r&&Ca(e,t,r)&&(t=n),i(e,la(t,3))},Vn.sortedIndex=function(e,t){return si(e,t)},Vn.sortedIndexBy=function(e,t,n){return ui(e,t,la(n,2))},Vn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=si(e,t);if(r<n&&Vo(e[r],t))return r}return-1},Vn.sortedLastIndex=function(e,t){return si(e,t,!0)},Vn.sortedLastIndexBy=function(e,t,n){return ui(e,t,la(n,2),!0)},Vn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=si(e,t,!0)-1;if(Vo(e[n],t))return n}return-1},Vn.startCase=Xs,Vn.startsWith=function(e,t,n){return e=_s(e),n=null==n?0:cr(ys(n),0,e.length),t=pi(t),e.slice(n,n+t.length)==t},Vn.subtract=Au,Vn.sum=function(e){return e&&e.length?Xt(e,au):0},Vn.sumBy=function(e,t){return e&&e.length?Xt(e,la(t,2)):0},Vn.template=function(e,t,r){var i=Vn.templateSettings;r&&Ca(e,t,r)&&(t=n),e=_s(e),t=Ms({},t,i,ea);var a,o,s=Ms({},t.imports,i.imports,ea),u=ks(s),c=en(s,u),l=0,p=t.interpolate||be,d="__p += '",h=we((t.escape||be).source+"|"+p.source+"|"+(p===ee?fe:be).source+"|"+(t.evaluate||be).source+"|$","g"),f="//# sourceURL="+(Pe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++st+"]")+"\n";e.replace(h,(function(t,n,r,i,s,u){return r||(r=i),d+=e.slice(l,u).replace(Me,sn),n&&(a=!0,d+="' +\n__e("+n+") +\n'"),s&&(o=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+t.length,t})),d+="';\n";var g=Pe.call(t,"variable")&&t.variable;if(g){if(de.test(g))throw new De("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(q,""):d).replace(z,"$1").replace(W,"$1;"),d="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var y=eu((function(){return Ne(u,f+"return "+d).apply(n,c)}));if(y.source=d,Qo(y))throw y;return y},Vn.times=function(e,t){if((e=ys(e))<1||e>d)return[];var n=f,r=Cn(e,f);t=la(t),e-=f;for(var i=Jt(r,t);++n<e;)t(n);return i},Vn.toFinite=gs,Vn.toInteger=ys,Vn.toLength=ms,Vn.toLower=function(e){return _s(e).toLowerCase()},Vn.toNumber=vs,Vn.toSafeInteger=function(e){return e?cr(ys(e),-d,d):0===e?e:0},Vn.toString=_s,Vn.toUpper=function(e){return _s(e).toUpperCase()},Vn.trim=function(e,t,r){if((e=_s(e))&&(r||t===n))return Qt(e);if(!e||!(t=pi(t)))return e;var i=fn(e),a=fn(t);return Mi(i,nn(i,a),rn(i,a)+1).join("")},Vn.trimEnd=function(e,t,r){if((e=_s(e))&&(r||t===n))return e.slice(0,gn(e)+1);if(!e||!(t=pi(t)))return e;var i=fn(e);return Mi(i,0,rn(i,fn(t))+1).join("")},Vn.trimStart=function(e,t,r){if((e=_s(e))&&(r||t===n))return e.replace(oe,"");if(!e||!(t=pi(t)))return e;var i=fn(e);return Mi(i,nn(i,fn(t))).join("")},Vn.truncate=function(e,t){var r=30,i="...";if(ns(t)){var a="separator"in t?t.separator:a;r="length"in t?ys(t.length):r,i="omission"in t?pi(t.omission):i}var o=(e=_s(e)).length;if(un(e)){var s=fn(e);o=s.length}if(r>=o)return e;var u=r-hn(i);if(u<1)return i;var c=s?Mi(s,0,u).join(""):e.slice(0,u);if(a===n)return c+i;if(s&&(u+=c.length-u),ss(a)){if(e.slice(u).search(a)){var l,p=c;for(a.global||(a=we(a.source,_s(ge.exec(a))+"g")),a.lastIndex=0;l=a.exec(p);)var d=l.index;c=c.slice(0,d===n?u:d)}}else if(e.indexOf(pi(a),u)!=u){var h=c.lastIndexOf(a);h>-1&&(c=c.slice(0,h))}return c+i},Vn.unescape=function(e){return(e=_s(e))&&X.test(e)?e.replace(G,yn):e},Vn.uniqueId=function(e){var t=++Ue;return _s(e)+t},Vn.upperCase=Js,Vn.upperFirst=Qs,Vn.each=_o,Vn.eachRight=Co,Vn.first=Wa,cu(Vn,function(){var e={};return br(Vn,(function(t,n){Pe.call(Vn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),Vn.VERSION="4.17.21",Tt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Vn[e].placeholder=Vn})),Tt(["drop","take"],(function(e,t){zn.prototype[e]=function(r){r=r===n?1:_n(ys(r),0);var i=this.__filtered__&&!t?new zn(this):this.clone();return i.__filtered__?i.__takeCount__=Cn(r,i.__takeCount__):i.__views__.push({size:Cn(r,f),type:e+(i.__dir__<0?"Right":"")}),i},zn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Tt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;zn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:la(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Tt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");zn.prototype[e]=function(){return this[n](1).value()[0]}})),Tt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");zn.prototype[e]=function(){return this.__filtered__?new zn(this):this[n](1)}})),zn.prototype.compact=function(){return this.filter(au)},zn.prototype.find=function(e){return this.filter(e).head()},zn.prototype.findLast=function(e){return this.reverse().find(e)},zn.prototype.invokeMap=Qr((function(e,t){return"function"==typeof e?new zn(this):this.map((function(n){return Kr(n,e,t)}))})),zn.prototype.reject=function(e){return this.filter(Fo(la(e)))},zn.prototype.slice=function(e,t){e=ys(e);var r=this;return r.__filtered__&&(e>0||t<0)?new zn(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==n&&(r=(t=ys(t))<0?r.dropRight(-t):r.take(t-e)),r)},zn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},zn.prototype.toArray=function(){return this.take(f)},br(zn.prototype,(function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),a=Vn[i?"take"+("last"==t?"Right":""):t],o=i||/^find/.test(t);a&&(Vn.prototype[t]=function(){var t=this.__wrapped__,s=i?[1]:arguments,u=t instanceof zn,c=s[0],l=u||zo(t),p=function(e){var t=a.apply(Vn,Rt([e],s));return i&&d?t[0]:t};l&&r&&"function"==typeof c&&1!=c.length&&(u=l=!1);var d=this.__chain__,h=!!this.__actions__.length,f=o&&!d,g=u&&!h;if(!o&&l){t=g?t:new zn(this);var y=e.apply(t,s);return y.__actions__.push({func:go,args:[p],thisArg:n}),new qn(y,d)}return f&&g?e.apply(this,s):(y=this.thru(p),f?i?y.value()[0]:y.value():y)})})),Tt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ke[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Vn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(zo(i)?i:[],e)}return this[n]((function(n){return t.apply(zo(n)?n:[],e)}))}})),br(zn.prototype,(function(e,t){var n=Vn[t];if(n){var r=n.name+"";Pe.call(kn,r)||(kn[r]=[]),kn[r].push({name:t,func:n})}})),kn[Vi(n,2).name]=[{name:"wrapper",func:n}],zn.prototype.clone=function(){var e=new zn(this.__wrapped__);return e.__actions__=Li(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Li(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Li(this.__views__),e},zn.prototype.reverse=function(){if(this.__filtered__){var e=new zn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},zn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=zo(e),r=t<0,i=n?e.length:0,a=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var a=n[r],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=Cn(t,e+o);break;case"takeRight":e=_n(e,t-o)}}return{start:e,end:t}}(0,i,this.__views__),o=a.start,s=a.end,u=s-o,c=r?s:o-1,l=this.__iteratees__,p=l.length,d=0,h=Cn(u,this.__takeCount__);if(!n||!r&&i==u&&h==u)return yi(e,this.__actions__);var f=[];e:for(;u--&&d<h;){for(var g=-1,y=e[c+=t];++g<p;){var m=l[g],v=m.iteratee,S=m.type,_=v(y);if(2==S)y=_;else if(!_){if(1==S)continue e;break e}}f[d++]=y}return f},Vn.prototype.at=yo,Vn.prototype.chain=function(){return fo(this)},Vn.prototype.commit=function(){return new qn(this.value(),this.__chain__)},Vn.prototype.next=function(){this.__values__===n&&(this.__values__=fs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?n:this.__values__[this.__index__++]}},Vn.prototype.plant=function(e){for(var t,r=this;r instanceof $n;){var i=Ba(r);i.__index__=0,i.__values__=n,t?a.__wrapped__=i:t=i;var a=i;r=r.__wrapped__}return a.__wrapped__=e,t},Vn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof zn){var t=e;return this.__actions__.length&&(t=new zn(this)),(t=t.reverse()).__actions__.push({func:go,args:[to],thisArg:n}),new qn(t,this.__chain__)}return this.thru(to)},Vn.prototype.toJSON=Vn.prototype.valueOf=Vn.prototype.value=function(){return yi(this.__wrapped__,this.__actions__)},Vn.prototype.first=Vn.prototype.head,nt&&(Vn.prototype[nt]=function(){return this}),Vn}();mt?((mt.exports=mn)._=mn,yt._=mn):gt._=mn}).call(qn)}(Zr,Zr.exports);var sy=Zr.exports;const Sn=Jm(sy),uy=[...cy(),...dy(),...ly(),...fy()];function ly(){const e=Object.values(K).map((e=>({id:"variable-"+e,name:`Variable "${e}"`,description:`Insert variable named "${e}"`,commands:["insert",e,{valueType:$n.VARIABLE}],category:"variables-and-constants"})));return e.push({id:"pi",name:"π (Pi)",commands:b.insertPi,category:"variables-and-constants"},{id:"euler",name:"e (Euler const)",commands:b.insertEulerE,category:"variables-and-constants"}),e}function cy(){const e=Sn.range(0,10).map((e=>({id:"number-"+e,name:e+"",description:`Insert number ${e}`,commands:["insert",e+""],category:"numeric-input"})));return e.push({id:"decimal place",name:"Decimal place",description:"Insert decimal separator",commands:b.insertDecimalSeparator,category:"numeric-input"}),e}function fy(){let e=["left","right","up","down"].map((e=>({id:"navigation-"+e,name:`Move ${e}`,description:`Move cursor ${e}`,commands:"left"==e?b.cursorMoveLeft:"right"==e?b.cursorMoveRight:"up"==e?b.cursorMoveUp:b.cursorMoveDown})));const t=[];return t.push(...e,{id:"clear",name:"Clear",commands:b.deleteAll},{id:"delete",name:"Delete",commands:b.deleteBackward},{id:"copy",name:"Copy",commands:b.copy},{id:"paste",name:"Paste",commands:b.paste},{id:"select all",name:"Select All",commands:b.selectAll},{id:"undo",name:"Undo Edit",commands:b.undo},{id:"redo",name:"Redo Edit",commands:b.redo},{id:"enter-fullscreen-mode",name:"Enter fullscreen mode",commands:[b.toggleFullscreen,!0]},{id:"exist-fullscreen-mode",name:"Exit fullscreen mode",commands:[b.toggleFullscreen,!1]}),t.push({id:"comma",name:", (Comma)",commands:b.insertTermSeparator},{id:"colon",name:": (Colon)",commands:b.insertColon},{id:">",name:"> (Greater than)",commands:b.insertGreaterThan},{id:"<",name:"< (Less than)",commands:b.insertLessThan},{id:"(",name:"( (Open parentheses)",commands:b.insertParenthesesOpen},{id:")",name:") (Close parentheses)",commands:b.insertParenthesesClose}),t}function dy(){const e=[];return e.push({id:"plus",name:"+ Plus operator",description:'Insert plus "+"',commands:b.insertPlus},{id:"subtract",name:"- Subtract operator",description:'Insert subtract "-"',commands:b.insertMinus},{id:"multiply",name:"× Multiply operator",description:'Insert multiply "×"',commands:b.insertMultiplication},{id:"divide",name:"÷ Divide operator",description:'Insert divide "÷"',commands:b.insertDivide},{id:"equal",name:"= Equal operator",description:'Insert equal "="',commands:b.insertEqual},{id:"power",name:"Power operator",description:"",commands:b.insertXPowerByY},{id:"fraction",name:"Fraction template",description:"",commands:b.insertFraction},{id:"mixed fraction",name:"Mixed Fraction template",description:"",commands:b.insertMixedNumber},{id:"calculate",name:"Calculate result",description:"Calculate result immediately",commands:b.calculate},{id:"solve",name:"Solve",commands:b.solve},{id:"npr",name:"nPr",commands:b.insertNPR},{id:"ncr",name:"nCr",commands:b.insertNCR},{id:"mod",name:"Mod operator",commands:b.insertModule},{id:"divideR",name:"÷R operator",commands:b.insertQuotient},{id:"degree",name:"Degree",description:"Insert degree unit",commands:b.insertDmsUnit},{id:"percent",name:"% (Percent)",commands:b.insertPercentage},{id:"factorial",name:"! (Factorial)",commands:b.insertFactorial},{id:"imaginary",name:"i (Imaginary)",commands:b.insertImaginaryI},{id:"polar",name:"∠ (Polar)",commands:b.insertPolar},{id:"sin",name:"Sin",commands:b.insertSin},{id:"cos",name:"Cos",commands:b.insertCos},{id:"tan",name:"Tan",commands:b.insertTan},{id:"arcsin",name:"ArcSin",commands:b.insertArcSin},{id:"arccos",name:"ArcCos",commands:b.insertArcCos},{id:"arctan",name:"ArcTan",commands:b.insertArcTan},{id:"GCD",name:"GCD",commands:b.insertGCD},{id:"LCM",name:"LCM",commands:b.insertLCM},{id:"Pol",name:"Pol(x,y)",commands:b.insertPol},{id:"Rect",name:"Rec(x,y)",commands:b.insertRec},{id:"abs",name:"Abs |x|",commands:b.insertAbs},{id:"integral",name:"∫ dx (Integral)",commands:b.insertIntegral},{id:"derivative",name:"d/dx (Derivative)",commands:b.insertDerivative},{id:"sum",name:"∑ Sum",commands:b.insertSumX},{id:"production",name:"Π Production",commands:b.insertProdX},{id:"square",name:"^2 (Square)",commands:b.insertXPowerBy2},{id:"sqrt",name:"√ (Sqrt)",commands:b.insertSqrt},{id:"cube",name:"^3 (Cube)",commands:b.insertXPowerBy3},{id:"cube root",name:"∛ (Cube root)",commands:b.insertCubeRoot},{id:"ln",name:"Ln",commands:b.insertLn},{id:"log",name:"Log",commands:b.insertLog},{id:"loga(b)",name:"Log a (b)",commands:b.insertLogAOfB}),e.map((e=>(e.category="operations-and-functions",e)))}const hy={Control:"Control",Meta:"Meta",Alt:"Alt",Shift:"Shift",Digit0:"0",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Numpad0:"Numpad 0",Numpad1:"Numpad 1",Numpad2:"Numpad 2",Numpad3:"Numpad 3",Numpad4:"Numpad 4",Numpad5:"Numpad 5",Numpad6:"Numpad 6",Numpad7:"Numpad 7",Numpad8:"Numpad 8",Numpad9:"Numpad 9",KeyA:"A",KeyB:"B",KeyC:"C",KeyD:"D",KeyE:"E",KeyF:"F",KeyG:"G",KeyH:"H",KeyI:"I",KeyJ:"J",KeyK:"K",KeyL:"L",KeyM:"M",KeyN:"N",KeyO:"O",KeyP:"P",KeyQ:"Q",KeyR:"R",KeyS:"S",KeyT:"T",KeyU:"U",KeyV:"V",KeyW:"W",KeyX:"X",KeyY:"Y",KeyZ:"Z",Enter:"Enter",Escape:"Escape",Backspace:"Backspace",Tab:"Tab",Space:"Space",Minus:"-",Equal:"=",BracketLeft:"[",BracketRight:"]",Backslash:"\\",Semicolon:";",Quote:"'",Backquote:"Backquote",Comma:",",Period:".",Slash:"/",CapsLock:"CapsLock",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",F13:"F13",F14:"F14",F15:"F15",F16:"F16",F17:"F17",F18:"F18",F19:"F19",F20:"F20",F21:"F21",F22:"F22",F23:"F23",F24:"F24",PrintScreen:"PrintScreen",ScrollLock:"ScrollLock",Pause:"Pause",Insert:"Insert",Home:"Home",PageUp:"PageUp",Delete:"Delete",End:"End",PageDown:"PageDown",ArrowRight:"Arrow Right",ArrowLeft:"Arrow Left",ArrowDown:"Arrow Down",ArrowUp:"Arrow Up",NumLock:"NumLock",NumpadDivide:"Numpad Divide",NumpadMultiply:"Numpad Multiply",NumpadSubtract:"Numpad Subtract",NumpadAdd:"Numpad Add",NumpadEnter:"Numpad Enter",NumpadDecimal:"Numpad Decimal",NumpadEqual:"Numpad Equal",NumpadParenLeft:"Numpad ParenLeft",NumpadParenRight:"Numpad ParenRight",IntlBackslash:"IntlBackslash",ContextMenu:"ContextMenu",Power:"Power",Help:"Help",Undo:"Undo",Cut:"Cut",Copy:"Copy",Paste:"Paste",AudioVolumeMute:"Audio Volume Mute",AudioVolumeUp:"Audio Volume Up",AudioVolumeDown:"Audio Volume Down",NumpadComma:"Numpad Comma",IntlRo:"IntlRo",KanaMode:"KanaMode",IntlYen:"IntlYen",Convert:"Convert",NonConvert:"NonConvert",Lang1:"Lang1",Lang2:"Lang2",Lang3:"Lang3",Lang4:"Lang4",ControlLeft:"ControlLeft",ShiftLeft:"ShiftLeft",AltLeft:"AltLeft",MetaLeft:"MetaLeft",ControlRight:"ControlRight",ShiftRight:"ShiftRight",AltRight:"AltRight",MetaRight:"MetaRight",MediaTrackNext:"MediaTrackNext",MediaTrackPrevious:"MediaTrackPrevious",MediaStop:"MediaStop",Eject:"Eject",MediaPlayPause:"MediaPlayPause",MediaSelect:"MediaSelect",LaunchMail:"LaunchMail",LaunchApp2:"LaunchApp2",LaunchApp1:"LaunchApp1",BrowserSearch:"BrowserSearch",BrowserHome:"BrowserHome",BrowserBack:"BrowserBack",BrowserForward:"BrowserForward",BrowserStop:"BrowserStop",BrowserRefresh:"BrowserRefresh",BrowserFavorites:"BrowserFavorites",Sleep:"Sleep",WakeUp:"WakeUp"};class py{static getKeymapForFunction(e){return uy.map((t=>{let n=e.find((e=>e.functionId==t.id))?.keyCombos||[];return n&&(n=n.map((e=>({...e,displayKeys:e.keyCodes?.map((e=>hy[e]))})))),{...t,keyCombos:n}}))}}function gy(e,t,n){if(0===e.length)return"";for(let r=e.length-1;r>=0;r--)if(e[r].key===t&&(!e[r].ifMode||e[r].ifMode===n.calcSettingManager.calculatorMode))return e[r].command;return""}function my(e,t,n,r){if(r.isTrusted){ny(r);const e=Nu();t.keyboardLayout!==e.id&&(t.keyboardLayout=e.id,t._keybindings=void 0)}clearTimeout(t.inlineShortcutBufferFlushTimer),e.inlineShortcutBufferFlushTimer=0;let i="";return i||(i=gy(t.keybindings||[],n,e)),!i||(st.sendKeyboardShortcut(n),i&&e.executeCommands(i,{source:Rt.PHYSICAL_KEYBOARD,keyStroke:n}),r.preventDefault&&r.preventDefault(),!1)}class yy{keyboardDelegate;keyboardLayout;calculatorInstance;options={inlineShortcutTimeout:500};inlineShortcutBuffer;inlineShortcutBufferFlushTimer;constructor(e){this.calculatorInstance=e,this.keyboardDelegate=ay(document.getElementById(ut.screenWrapper),this),this.inlineShortcutBuffer=[],this.inlineShortcutBufferFlushTimer=0,e.calcSettingManager.$keyMapOverride.subscribe((e=>{console.log("$keyMapOverride",e),this._keybindings=void 0,this.keybindings}))}_keybindings;get keybindings(){if(this._keybindings)return this._keybindings;let[e,t]=this.getUserKeyMap();return t.length>0&&console.error(t),this._keybindings=e,e}onKeystroke(e,t){return my(this.calculatorInstance,this,e,t),!1}getUserKeyMap(){const e=[...oy];this.calculatorInstance.calcSettingManager.keyMapOverride.forEach((t=>{let n=e.findIndex((e=>e.functionId===t.functionId));n>=0&&(e[n]=t)}));const t=py.getKeymapForFunction(e),n=[],r=[];return t.forEach((e=>{e.keyCombos?.forEach((t=>{let i=iy(t),a=n.find((e=>e.key==i));a&&r.push(`Duplicate key combo ${i} of command: "${a.functionId}" and "${e.id}"`),n.push({functionId:e.id,key:i,command:e.commands})}))})),[n,r]}}class vy{static userSettingsToCalculatorSettingModel(e){let t={};for(let n in e.settings){let r=e.settings[n];try{switch(r.dataType){case"number":t[n]=Number(r.value);break;case"boolean":t[n]="true"==r.value;break;default:t[n]=JSON.parse(r.value)}}catch(t){console.error("userSettingsToCalculatorSettingModel",n,e,t)}}return t}}var me=(e=>(e.MATH_MODE="MATH_MODE",e.CALC_MODE="CALC_MODE",e))(me||{});class Kt{static CALCULATOR_SETTING_KEY="CALCULATOR_SETTING";$calculatorMainMode=pe();$calculatorMode=pe();$angleUnit=pe();$calculationType=pe();$loadingUserSettingFromServer=pe(!0);$keyMapOverride=pe([]);$userFunctions=pe();$useDecimalPointSeparator=pe();$scientificNotationType=pe();$percentCalculationType=pe();$thousandSeparatorChar=pe();$thousandthSeparatorChar=pe();$useIndianStyleOfDigitGrouping=pe();$decimalFormatType=pe();$precision=pe();$implicitMultiplication=pe();_authService=yn.getInstance();_calculatorService=Xn.getInstance();constructor(){yn.getInstance().isAuthenticated?this._calculatorService.getUserSetting().then((e=>{if(e.success){let t=vy.userSettingsToCalculatorSettingModel(e.data);console.log("User saved setting from server: ",t,e),this.saveDataLocalStorage(t)}else gu.error("Fetch User setting from server got error Handled ",e)})).catch((e=>{gu.error("Fetch User setting from server got error Unhandled ",e)})).finally((()=>{this.loadSettingFromLocalStorage(),this.$loadingUserSettingFromServer.set(!1)})):(this.loadSettingFromLocalStorage(),this.$loadingUserSettingFromServer.set(!1))}loadSettingFromLocalStorage(){let e=Kt.getSavedSetting();this.angleUnit=e.angleUnit,this.calculationType=e.calculationType,this.implicitMultiplication=e.implicitMultiplication,this.decimalFormatType=e.decimalFormatType,this.precision=e.precision,this.useDecimalPointSeparator=e.useDecimalPointSeparator,this.onUseDecimalPointSeparatorChange(this.useDecimalPointSeparator),this.thousandSeparatorChar=e.thousandSeparatorChar,this.onThousandSeparatorCharChange(this.thousandSeparatorChar),this.thousandthSeparatorChar=e.thousandthSeparatorChar,this.onThousandthSeparatorCharChange(this.thousandthSeparatorChar),this.useIndianStyleOfDigitGrouping=e.useIndianStyleOfDigitGrouping,this.scientificNotationType=e.scientificNotationType,this.percentCalculationType=e.percentCalculationType,this.calculatorMode=e.calculatorMode,this.calculatorMainMode=e.calculatorMainMode,this.setKeyMapOverride(e.keyMapOverride,"replace"),this.userSettingState=e.userSettingState,this.userFunctions=e.userFunctions,this.notifyUpdate()}get percentCalculationType(){return ce(this.$percentCalculationType)}set percentCalculationType(e){e!==this.percentCalculationType&&(this.$percentCalculationType.set(e),this.saveSingleSetting({percentCalculationType:e}),this.saveCurrentSetting())}get calculatorMainMode(){return ce(this.$calculatorMainMode)}set calculatorMainMode(e){this.calculatorMainMode!=e&&this.$calculatorMainMode.set(e)}get angleUnit(){return ce(this.$angleUnit)}set angleUnit(e){this.angleUnit!=e&&(this.$angleUnit.set(e),this.saveSingleSetting({angleUnit:e}),this.saveCurrentSetting())}get calculationType(){return ce(this.$calculationType)}set calculationType(e){this.calculationType!=e&&(this.$calculationType.set(e),this.saveSingleSetting({calculationType:e}),this.saveCurrentSetting())}get implicitMultiplication(){return ce(this.$implicitMultiplication)}set implicitMultiplication(e){this.implicitMultiplication!=e&&(this.$implicitMultiplication.set(e),this.saveSingleSetting({implicitMultiplication:e}),this.saveCurrentSetting())}get calculatorMode(){return ce(this.$calculatorMode)}set calculatorMode(e){this.calculatorMode!=e&&this.$calculatorMode.set(e)}get decimalFormatType(){return ce(this.$decimalFormatType)}set decimalFormatType(e){e!==this.decimalFormatType&&(this.$decimalFormatType.set(e),this.saveSingleSetting({decimalFormatType:e}),this.saveCurrentSetting())}get precision(){return ce(this.$precision)}set precision(e){this.precision!==e&&(this.$precision.set(e),this.saveSingleSetting({precision:e}),this.saveCurrentSetting())}get useDecimalPointSeparator(){return ce(this.$useDecimalPointSeparator)}set useDecimalPointSeparator(e){this.useDecimalPointSeparator!==e&&(this.onUseDecimalPointSeparatorChange(e),this.$useDecimalPointSeparator.set(e),this.saveSingleSetting({useDecimalPointSeparator:e}),this.saveCurrentSetting())}get thousandSeparatorChar(){return null==ce(this.$thousandSeparatorChar)?zt.Nothing:ce(this.$thousandSeparatorChar)}set thousandSeparatorChar(e){e!==this.thousandSeparatorChar&&(this.$thousandSeparatorChar.set(e??zt.Nothing),e==zt.Nothing&&(e=void 0),this.onThousandSeparatorCharChange(e),this.saveSingleSetting({thousandSeparatorChar:e}),this.saveCurrentSetting())}get thousandthSeparatorChar(){return null==ce(this.$thousandthSeparatorChar)?zt.Nothing:ce(this.$thousandthSeparatorChar)}set thousandthSeparatorChar(e){e!==this.thousandthSeparatorChar&&(e==zt.Nothing&&(e=void 0),this.$thousandthSeparatorChar.set(e),this.onThousandthSeparatorCharChange(e),this.saveSingleSetting({thousandthSeparatorChar:e}),this.saveCurrentSetting())}get useIndianStyleOfDigitGrouping(){return ce(this.$useIndianStyleOfDigitGrouping)}set useIndianStyleOfDigitGrouping(e){e!==this.useIndianStyleOfDigitGrouping&&(this.$useIndianStyleOfDigitGrouping.set(e),this.saveSingleSetting({useIndianStyleOfDigitGrouping:e}),this.saveCurrentSetting())}get scientificNotationType(){return ce(this.$scientificNotationType)}set scientificNotationType(e){e!==this.scientificNotationType&&(this.$scientificNotationType.set(e),this.saveSingleSetting({scientificNotationType:e}),this.saveCurrentSetting())}get keyMapOverride(){return ce(this.$keyMapOverride)}setKeyMapOverride(e,t="merge"){let n;if("replace"===t)n=e;else if("merge"===t){let t=[...this.keyMapOverride];e.forEach((e=>{let n=t.findIndex((t=>t.functionId===e.functionId));n>=0?t[n]=e:t.push(e)})),n=t}this.$keyMapOverride.set(n),this.saveSingleSetting({keyMapOverride:n}),this.saveCurrentSetting()}requestCommasKeyboardMapping(){wu.getCalculator().dialogManager.commasMappingSelectDialog.show()}_userSettingState=void 0;get userSettingState(){return this._userSettingState}set userSettingState(e){this._userSettingState=e,this.saveSingleSetting({userSettingState:e}),this.saveCurrentSetting(),this.notifyUpdate()}get userFunctions(){return ce(this.$userFunctions)}set userFunctions(e){this.$userFunctions.set(e),this.saveSingleSetting({userFunctions:e}),this.saveCurrentSetting()}static getSavedSetting(){let e={};for(let t in localStorage)if(t.startsWith(Kt.CALCULATOR_SETTING_KEY+"."))try{e[t.substring(Kt.CALCULATOR_SETTING_KEY.length+1)]=JSON.parse(localStorage.getItem(t))}catch(e){console.error("Get saved getting got error, ",e,t)}let t=Kt.getDefaultSetting(),n={calculatorMainMode:this.getSavedSettingOrDefault(e,t,"calculatorMainMode"),calculatorMode:this.getSavedSettingOrDefault(e,t,"calculatorMode"),calculationType:this.getSavedSettingOrDefault(e,t,"calculationType"),implicitMultiplication:this.getSavedSettingOrDefault(e,t,"implicitMultiplication"),decimalFormatType:this.getSavedSettingOrDefault(e,t,"decimalFormatType"),angleUnit:this.getSavedSettingOrDefault(e,t,"angleUnit"),precision:this.getSavedSettingOrDefault(e,t,"precision"),useDecimalPointSeparator:this.getSavedSettingOrDefault(e,t,"useDecimalPointSeparator"),thousandSeparatorChar:this.getSavedSettingOrDefault(e,t,"thousandSeparatorChar"),thousandthSeparatorChar:this.getSavedSettingOrDefault(e,t,"thousandthSeparatorChar"),useIndianStyleOfDigitGrouping:this.getSavedSettingOrDefault(e,t,"useIndianStyleOfDigitGrouping"),scientificNotationType:this.getSavedSettingOrDefault(e,t,"scientificNotationType"),percentCalculationType:this.getSavedSettingOrDefault(e,t,"percentCalculationType"),keyMapOverride:this.getSavedSettingOrDefault(e,t,"keyMapOverride"),userSettingState:this.getSavedSettingOrDefault(e,t,"userSettingState"),userFunctions:this.getSavedSettingOrDefault(e,t,"userFunctions")};return console.log("savedSettingOrDefault",n),n}static getSavedSettingOrDefault(e,t,n){return n in e&&null!=e[n]?e[n]:t[n]}static getDefaultSetting(){return{calculatorMainMode:me.MATH_MODE,calculatorMode:vn.DEFAULT,calculationType:Jt.FRAC,implicitMultiplication:!0,decimalFormatType:Hm.NORMAL,angleUnit:Wm.DEG,precision:10,useDecimalPointSeparator:!0,thousandSeparatorChar:zt.Space,thousandthSeparatorChar:zt.Space,useIndianStyleOfDigitGrouping:!1,scientificNotationType:Vm.DEFAULT,percentCalculationType:qm.PERCENT_TYPE_DIVIDE_100,userSettingState:{},keyMapOverride:[],userFunctions:[]}}saveSingleSetting(e){this.saveDataLocalStorage(e)}getSettingNeedToSaveOnly(){return{calculationType:this.calculationType,implicitMultiplication:this.implicitMultiplication,decimalFormatType:this.decimalFormatType,angleUnit:this.angleUnit,precision:this.precision,useDecimalPointSeparator:this.useDecimalPointSeparator,thousandSeparatorChar:this.thousandSeparatorChar,thousandthSeparatorChar:this.thousandthSeparatorChar,useIndianStyleOfDigitGrouping:this.useIndianStyleOfDigitGrouping,scientificNotationType:this.scientificNotationType,percentCalculationType:this.percentCalculationType,keyMapOverride:this.keyMapOverride,userSettingState:this.userSettingState,userFunctions:this.userFunctions}}saveCurrentSetting(){let e=this.getSettingNeedToSaveOnly();this.saveDateServerDebounce(e)}saveDataLocalStorage(e){Object.keys(e).forEach((t=>{let n=JSON.stringify(e[t]);localStorage.setItem(Kt.CALCULATOR_SETTING_KEY+"."+t,n)})),console.log("Save setting object: ",e)}saveDateServerDebounce=Sn.debounce((e=>{this.saveDataServer(e)}),500);saveDataServer(e){if(!this._authService.isAuthenticated||!0===ce(this.$loadingUserSettingFromServer))return;let t={settings:{}};for(let n of Object.keys(e)){let r=e[n];t.settings[n]={dataType:typeof r,value:JSON.stringify(r)}}this._calculatorService.updateUserSetting(t).then()}getSnapshot(){return{calculatorMainMode:this.calculatorMainMode,calculatorMode:this.calculatorMode,calculationType:this.calculationType,implicitMultiplication:this.implicitMultiplication,decimalFormatType:this.decimalFormatType,angleUnit:this.angleUnit,precision:this.precision,useDecimalPointSeparator:this.useDecimalPointSeparator,thousandSeparatorChar:this.thousandSeparatorChar,thousandthSeparatorChar:this.thousandthSeparatorChar,useIndianStyleOfDigitGrouping:this.useIndianStyleOfDigitGrouping,scientificNotationType:this.scientificNotationType,percentCalculationType:this.percentCalculationType}}resetDefault(){let e=Kt.getDefaultSetting();this.angleUnit=e.angleUnit,this.calculationType=e.calculationType,this.decimalFormatType=e.decimalFormatType,this.implicitMultiplication=e.implicitMultiplication,this.precision=e.precision,this.useDecimalPointSeparator=e.useDecimalPointSeparator,this.thousandSeparatorChar=e.thousandSeparatorChar,this.thousandthSeparatorChar=e.thousandthSeparatorChar,this.useIndianStyleOfDigitGrouping=e.useIndianStyleOfDigitGrouping,this.calculatorMode=e.calculatorMode,this.calculatorMainMode=e.calculatorMainMode,this.scientificNotationType=e.scientificNotationType,this.percentCalculationType=e.percentCalculationType,this.userSettingState=e.userSettingState,this.setKeyMapOverride(e.keyMapOverride,"replace"),this.onUseDecimalPointSeparatorChange(this.useDecimalPointSeparator),this.onThousandSeparatorCharChange(this.thousandSeparatorChar),this.onThousandthSeparatorCharChange(this.thousandthSeparatorChar),this.saveCurrentSetting(),this.notifyUpdate()}notifyUpdate(){}onUseDecimalPointSeparatorChange(e){Vr.decimalSeparatorChar=1==e||void 0===e?qr.Dot:qr.Comma,this.debounceReRenderAllMath()}onThousandSeparatorCharChange(e){Vr.thousandSeparatorChar=e||qr.Nothing,this.debounceReRenderAllMath()}onThousandthSeparatorCharChange(e){Vr.thousandthSeparatorChar=e||qr.Nothing,this.debounceReRenderAllMath()}debounceReRenderAllMath=Sn.debounce((function(){try{document.querySelectorAll("math-view").forEach((e=>e.render())),document.querySelectorAll("math-input").forEach((e=>e.reRender())),console.log("ReRender All math")}catch(e){console.error("reRenderAllMath got error ",e)}}),500)}var Gr=(e=>(e.CANCELLED="CANCELLED",e.WAITING_FOR_COMPUTE_RESULT="WAITING_FOR_COMPUTE_RESULT",e.COMPLETED="COMPLETED",e))(Gr||{}),Gn=(e=>(e.HORIZONTAL="HORIZONTAL",e.VERTICAL="VERTICAL",e.AUTO="AUTO",e))(Gn||{});const mu="HAS_USED_FULLSCREEN_MODE",Sy="DO_NOT_SHOW_FULLSCREEN_SUGGESTION_AGAIN";class nt{static getViewportSize(){return{height:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),width:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)}}static getRightPanelShowMode(){let e=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);return nt.getCalculatorLayout()==Gn.HORIZONTAL&&e<=950||e<=720?"dialog":"widget"}static isEmpty(e){return null==e||0==e.length}static getAttr(e){return document.getElementById(ut.calculatorPage).getAttribute(e)}static setAttr(e,t){null==t?document.getElementById(ut.calculatorPage).removeAttribute(e):document.getElementById(ut.calculatorPage).setAttribute(e,t.toString())}static setRightPanelAttribute(e){this.setAttr(Pe.rightPanelContainerType,e.containerType),this.setAttr(Pe.rightPanelContainerHideByUser,e.hideByUser),this.setAttr(Pe.rightPanelContainerOpen,e.show)}static getRightPanelAttribute(){let e=nt.getRightPanelShowMode(),t=null!==this.getAttr("data-show-right-side-bar");return{show:t,showWidget:t&&"widget"==e,containerType:e,hideByUser:"true"==this.getAttr(Pe.rightPanelContainerHideByUser)}}static getViewWidth(){return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)}static setRightSideBar({show:e}){e?this.setAttr("data-show-right-side-bar",""):this.setAttr("data-show-right-side-bar",void 0)}static getCalculatorLayout(){let e=Gn.AUTO,t=this.getAttr(Pe.calculatorLayout);return t&&(t=Gn[t]),t||e}static setCalculatorLayoutAttribute({layout:e,actual:t}){e==Gn.AUTO&&t?this.setAttr(Pe.recommendedCalculatorLayout,t.toString()):this.setAttr(Pe.recommendedCalculatorLayout,void 0),this.setAttr(Pe.calculatorLayout,e)}static getIsFullScreenMode(){return"true"==document.body.getAttribute(Pe.isFullscreenMode)}static getHasUsedFullscreenModeBefore(){return"true"===localStorage.getItem(mu)}static setFullScreenMode(e){e&&localStorage.setItem(mu,"true"),nt.setAttr(Pe.isFullscreenMode,e),document.body.setAttribute(Pe.isFullscreenMode,e.toString())}static couldSuggestOpenFullscreenMode(){return!this.getIsFullScreenMode()&&"true"!==localStorage.getItem(Sy)&&!this.getHasUsedFullscreenModeBefore()&&this.getViewportSize().width<750}}class _y extends Du{constructor(e){super(e)}}class _t{static isPrefixOperator(e){if(!e)return!1;let t=e instanceof _y;return t=t||e.type==pu.OPERATOR_MINUS,t=t||e.type==pu.OPERATOR_PLUS,t}static isInfixOperator(e){return!!e&&e instanceof Km}static isPostfixOperator(e){return!!e&&e instanceof Fm}static isPostfixCommandOperator(e){return!!e&&e instanceof Pm}}var _n,z=(e=>(e.CALCULATE_AND_SAVE_VARIABLE_VALUE="CALCULATE_AND_SAVE_VARIABLE_VALUE",e.CALCULATE_MAIN_MATH_RESULT="CALCULATE_MAIN_MATH_RESULT",e.CALCULATE_MAIN_MATH_RESULT_AND_EXIT_CALC_MODE="CALCULATE_MAIN_MATH_RESULT_AND_EXIT_CALC_MODE",e.SHOW_MAIN_MATH_RESULT="SHOW_MAIN_MATH_RESULT",e))(z||{}),Xe=function(){return Xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Xe.apply(this,arguments)},Cy=function(){function e(e){this.options=e,this.listeners={}}return e.prototype.on=function(e,t){var n=this.listeners[e]||[];this.listeners[e]=n.concat([t])},e.prototype.triggerEvent=function(e,t){var n=this;(this.listeners[e]||[]).forEach((function(e){return e({target:n,event:t})}))},e}();!function(e){e[e.Add=0]="Add",e[e.Remove=1]="Remove"}(_n||(_n={}));var Pt,Ey=function(){function e(){this.notifications=[]}return e.prototype.push=function(e){this.notifications.push(e),this.updateFn(e,_n.Add,this.notifications)},e.prototype.splice=function(e,t){var n=this.notifications.splice(e,t)[0];return this.updateFn(n,_n.Remove,this.notifications),n},e.prototype.indexOf=function(e){return this.notifications.indexOf(e)},e.prototype.onUpdate=function(e){this.updateFn=e},e}();!function(e){e.Dismiss="dismiss",e.Click="click"}(Pt||(Pt={}));var yu={types:[{type:"success",className:"notyf__toast--success",backgroundColor:"#3dc763",icon:{className:"notyf__icon--success",tagName:"i"}},{type:"error",className:"notyf__toast--error",backgroundColor:"#ed3d3d",icon:{className:"notyf__icon--error",tagName:"i"}}],duration:2e3,ripple:!0,position:{x:"right",y:"bottom"},dismissible:!1},My=function(){function e(){this.notifications=[],this.events={},this.X_POSITION_FLEX_MAP={left:"flex-start",center:"center",right:"flex-end"},this.Y_POSITION_FLEX_MAP={top:"flex-start",center:"center",bottom:"flex-end"};var e=document.createDocumentFragment(),t=this._createHTMLElement({tagName:"div",className:"notyf"});e.appendChild(t),document.body.appendChild(e),this.container=t,this.animationEndEventName=this._getAnimationEndEventName(),this._createA11yContainer()}return e.prototype.on=function(e,t){var n;this.events=Xe(Xe({},this.events),((n={})[e]=t,n))},e.prototype.update=function(e,t){t===_n.Add?this.addNotification(e):t===_n.Remove&&this.removeNotification(e)},e.prototype.removeNotification=function(e){var t,n,r=this,i=this._popRenderedNotification(e);i&&((t=i.node).classList.add("notyf__toast--disappear"),t.addEventListener(this.animationEndEventName,n=function(e){e.target===t&&(t.removeEventListener(r.animationEndEventName,n),r.container.removeChild(t))}))},e.prototype.addNotification=function(e){var t=this._renderNotification(e);this.notifications.push({notification:e,node:t}),this._announce(e.options.message||"Notification")},e.prototype._renderNotification=function(e){var t,n=this._buildNotificationCard(e),r=e.options.className;return r&&(t=n.classList).add.apply(t,r.split(" ")),this.container.appendChild(n),n},e.prototype._popRenderedNotification=function(e){for(var t=-1,n=0;n<this.notifications.length&&t<0;n++)this.notifications[n].notification===e&&(t=n);if(-1!==t)return this.notifications.splice(t,1)[0]},e.prototype.getXPosition=function(e){var t;return(null===(t=e?.position)||void 0===t?void 0:t.x)||"right"},e.prototype.getYPosition=function(e){var t;return(null===(t=e?.position)||void 0===t?void 0:t.y)||"bottom"},e.prototype.adjustContainerAlignment=function(e){var t=this.X_POSITION_FLEX_MAP[this.getXPosition(e)],n=this.Y_POSITION_FLEX_MAP[this.getYPosition(e)],r=this.container.style;r.setProperty("justify-content",n),r.setProperty("align-items",t)},e.prototype._buildNotificationCard=function(e){var t=this,n=e.options,r=n.icon;this.adjustContainerAlignment(n);var i=this._createHTMLElement({tagName:"div",className:"notyf__toast"}),a=this._createHTMLElement({tagName:"div",className:"notyf__ripple"}),o=this._createHTMLElement({tagName:"div",className:"notyf__wrapper"}),s=this._createHTMLElement({tagName:"div",className:"notyf__message"});s.innerHTML=n.message||"";var u=n.background||n.backgroundColor;if(r){var c=this._createHTMLElement({tagName:"div",className:"notyf__icon"});if(("string"==typeof r||r instanceof String)&&(c.innerHTML=new String(r).valueOf()),"object"==typeof r){var l=r.tagName,p=void 0===l?"i":l,d=r.className,h=r.text,f=r.color,g=void 0===f?u:f,y=this._createHTMLElement({tagName:p,className:d,text:h});g&&(y.style.color=g),c.appendChild(y)}o.appendChild(c)}if(o.appendChild(s),i.appendChild(o),u&&(n.ripple?(a.style.background=u,i.appendChild(a)):i.style.background=u),n.dismissible){var m=this._createHTMLElement({tagName:"div",className:"notyf__dismiss"}),v=this._createHTMLElement({tagName:"button",className:"notyf__dismiss-btn"});m.appendChild(v),o.appendChild(m),i.classList.add("notyf__toast--dismissible"),v.addEventListener("click",(function(n){var r,i;null===(i=(r=t.events)[Pt.Dismiss])||void 0===i||i.call(r,{target:e,event:n}),n.stopPropagation()}))}i.addEventListener("click",(function(n){var r,i;return null===(i=(r=t.events)[Pt.Click])||void 0===i?void 0:i.call(r,{target:e,event:n})}));var S="top"===this.getYPosition(n)?"upper":"lower";return i.classList.add("notyf__toast--"+S),i},e.prototype._createHTMLElement=function(e){var t=e.tagName,n=e.className,r=e.text,i=document.createElement(t);return n&&(i.className=n),i.textContent=r||null,i},e.prototype._createA11yContainer=function(){var e=this._createHTMLElement({tagName:"div",className:"notyf-announcer"});e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),e.style.border="0",e.style.clip="rect(0 0 0 0)",e.style.height="1px",e.style.margin="-1px",e.style.overflow="hidden",e.style.padding="0",e.style.position="absolute",e.style.width="1px",e.style.outline="0",document.body.appendChild(e),this.a11yContainer=e},e.prototype._announce=function(e){var t=this;this.a11yContainer.textContent="",setTimeout((function(){t.a11yContainer.textContent=e}),100)},e.prototype._getAnimationEndEventName=function(){var e,t=document.createElement("_fake"),n={MozTransition:"animationend",OTransition:"oAnimationEnd",WebkitTransition:"webkitAnimationEnd",transition:"animationend"};for(e in n)if(void 0!==t.style[e])return n[e];return"animationend"},e}(),Ay=function(){function e(e){var t=this;this.dismiss=this._removeNotification,this.notifications=new Ey,this.view=new My;var n=this.registerTypes(e);this.options=Xe(Xe({},yu),e),this.options.types=n,this.notifications.onUpdate((function(e,n){return t.view.update(e,n)})),this.view.on(Pt.Dismiss,(function(e){var n=e.target,r=e.event;t._removeNotification(n),n.triggerEvent(Pt.Dismiss,r)})),this.view.on(Pt.Click,(function(e){var t=e.target,n=e.event;return t.triggerEvent(Pt.Click,n)}))}return e.prototype.error=function(e){var t=this.normalizeOptions("error",e);return this.open(t)},e.prototype.success=function(e){var t=this.normalizeOptions("success",e);return this.open(t)},e.prototype.open=function(e){var t=this.options.types.find((function(t){return t.type===e.type}))||{},n=Xe(Xe({},t),e);this.assignProps(["ripple","position","dismissible"],n);var r=new Cy(n);return this._pushNotification(r),r},e.prototype.dismissAll=function(){for(;this.notifications.splice(0,1););},e.prototype.assignProps=function(e,t){var n=this;e.forEach((function(e){t[e]=null==t[e]?n.options[e]:t[e]}))},e.prototype._pushNotification=function(e){var t=this;this.notifications.push(e);var n=void 0!==e.options.duration?e.options.duration:this.options.duration;n&&setTimeout((function(){return t._removeNotification(e)}),n)},e.prototype._removeNotification=function(e){var t=this.notifications.indexOf(e);-1!==t&&this.notifications.splice(t,1)},e.prototype.normalizeOptions=function(e,t){var n={type:e};return"string"==typeof t?n.message=t:"object"==typeof t&&(n=Xe(Xe({},n),t)),n},e.prototype.registerTypes=function(e){var t=(e&&e.types||[]).slice();return yu.types.map((function(e){var n=-1;t.forEach((function(t,r){t.type===e.type&&(n=r)}));var r=-1!==n?t.splice(n,1)[0]:{};return Xe(Xe({},e),r)})).concat(t)},e}();class Qr{static instance;toast;constructor(){this.toast=new Ay({position:{x:"center",y:"top"}})}static getInstance(){return this.instance||(this.instance=new Qr),this.instance}info(e){this.toast.dismissAll();let t=this.toast.success({message:e.message,duration:1500});t.on("click",(()=>{this.toast.dismiss(t)}))}}class vu extends HTMLElement{dialogElement;confirmButton;cancelButton;static showConfirm({title:e}){const t=document.querySelector("confirm-action-dialog");return t.setData({title:e}),t.show(),new Promise((e=>{t.dialogElement.addEventListener("close",(()=>{e("cancel")}),{once:!0}),t.confirmButton.addEventListener("click",(()=>{e("confirm")}),{once:!0}),t.cancelButton.addEventListener("click",(()=>{e("cancel")}),{once:!0})}))}titleElement;constructor(){super(),this.dialogElement=this.querySelector("dialog"),this.confirmButton=this.querySelector('button[value="confirm"]'),this.cancelButton=this.querySelector('button[value="cancel"]'),this.cancelButton.addEventListener("click",(()=>{this.close()})),this.confirmButton.addEventListener("click",(()=>{this.close()})),this.titleElement=this.querySelector('div[data-name="title"]')}init(e){}setData({title:e}){this.titleElement.textContent=e}close(){this.dialogElement.close()}show(){this.dialogElement.showModal()}render(){}get open(){return this.dialogElement.open}}class Ea{static dbNCalcClipboard=(()=>{let e,t="ClipboardCache_v1";async function n(n,r){const i=await(e||(e=new Promise(((e,n)=>{const r=indexedDB.open("NcalcFxFormatDB",1);r.onerror=()=>{n(r.error)},r.onupgradeneeded=()=>{r.result.createObjectStore(t)},r.onsuccess=()=>{e(r.result)}})),e));return new Promise(((e,a)=>{const o=i.transaction(t,n);o.oncomplete=()=>e(),o.onerror=()=>a(o.error),r(o.objectStore(t))}))}return{async get(e){let t;return await n("readonly",(n=>{t=n.get(e)})),t.result},set:(e,t)=>n("readwrite",(n=>{n.put(t,e)})),delete:e=>n("readwrite",(t=>{t.delete(e)}))}})();static saveNcalcFxFormat(e,t){this.dbNCalcClipboard.set(e,t).then((e=>{console.log("saveNcalcFxFormat",e)}))}static getNcalcFxFormat(e){return this.dbNCalcClipboard.get(e)}}class by{commands;constructor(){this.commands={};for(const e of Object.keys(this))["commands","perform"].includes(e)?console.assert(!this.commands[e],"Selector already defined: ",e):this.commands[e]={fn:this[e]};console.log("ALL COMMAND: ",this.commands)}toggleFullscreen=(e,t,n)=>(Xr.markUsedFullscreenMode(),nt.getIsFullScreenMode()==n||(void 0===n&&(n=!nt.getIsFullScreenMode()),nt.setFullScreenMode(n),Qr.getInstance().info({message:n?$m():Gm()}),e.focusStateManager.restoreFocusState(),setTimeout((()=>{e.focusStateManager.restoreFocusState()}),500)),{});switchLayout=(e,t,n)=>(nt.setCalculatorLayoutAttribute({layout:n}),{});perform(e,t,n){if(!t)return!1;let r,i=[],a=!0,o=!1,s=!1,u=Fe.DEBOUNCE;Array.isArray(t)?(r=t[0],i=t.slice(1)):r=t;let c=this.commands[r];if(!c)return!1;let l=c?.fn(e,n??{},...i);return Promise.resolve(l).then((t=>{t.isCalculateAction&&e.increaseCalculateActionCount(),null!=t?.resetCalculatorMode&&(a=t.resetCalculatorMode),null!=t?.calculatePreview&&(o=t.calculatePreview),null!=t?.inputValue?t.inputValue:e.calculatorScreenElement.currentInput.value,null!=t?.triggerNewEvent&&(s=t.triggerNewEvent),null!=t?.calculatePriority&&(u=t.calculatePriority),t?.scrollToInputElement&&e.calculatorScreenElement.scrollToPosition("input"),a&&e.calcSettingManager.calculatorMode!=vn.DEFAULT&&(e.calcSettingManager.calculatorMode=vn.DEFAULT),s&&e.eventManager.createEvent(r,void 0,{isWaitingToComputeResult:!1}),o&&this.calculatePreview(e,{source:Rt.PROGRAM},u)})),!0}insert=(e,t,n,r)=>{let i,a;function o(){e.executeCommands(b.insertVariableAns)}if("[Comma]"===t.keyStroke&&t.source===Rt.PHYSICAL_KEYBOARD&&!e.calcSettingManager?.userSettingState?.isSelectedCommasMapping&&(e.calcSettingManager.requestCommasKeyboardMapping(),n=void 0),e.calculatorScreenElement.isFinishedEditSession&&n===Wr.INSERT_DMS_UNIT)return e.executeCommands(b.convertToDMS),{};n instanceof Du?(i=n.text,a=n):i=n,r&&(r.valueType==$n.DEFAULT||(r.valueType==$n.METRIC_CONVERSION?i=Wr.CONVERSION.replace("#1",i):r.valueType==$n.SCIENTIFIC_CONSTANT?i=Wr.CONST.replace("#1",i):r.valueType==$n.VARIABLE&&(i=Wr.VARIABLE.replace("#1",i))));let s=nt.isEmpty(e.mathExpression);return e.calculatorScreenElement.isFinishedEditSession?(!s&&(_t.isPostfixOperator(a)||_t.isInfixOperator(a)||_t.isPostfixCommandOperator(a))||_t.isInfixOperator(a)&&!_t.isPrefixOperator(a))&&o():s&&(_t.isPostfixOperator(a)||_t.isInfixOperator(a)&&!_t.isPrefixOperator(a)||_t.isPostfixCommandOperator(a))&&o(),void 0===i?{}:{calculatePreview:!0,resetCalculatorMode:!0,inputValue:e.calculatorScreenElement.insert(i),scrollToInputElement:r?.scrollIntoView,triggerNewEvent:!0}};openResultFormatDialog=(e,t,n,r)=>{let i=e.dialogManager.resultFormatDialog;return n||null==n?(i.data=r,i.show()):(i.close(),i.data=void 0),{}};openScientificConstantsDialog=(e,t,n)=>{let r=e.dialogManager.scientificConstantsDialog;return n||null==n?r.show():r.close(),{}};openMetricConversionsDialog=(e,t,n)=>{let r=e.dialogManager.metricConversionsDialog;return n||null==n?r.show():r.close(),{}};openHypDialog=(e,t,n)=>{let r=e.dialogManager.hypDialog;return n||null==n?r.show():r.close(),{}};openCMPLXDialog=(e,t,n)=>{let r=e.dialogManager.cmplxDialog;return n||null==n?r.show():r.close(),{}};openSettingsDialog=(e,t,n)=>{Xr.markUsedSetting();let r=e.dialogManager.settingsDialog;return n||null==n?r.showModal():r.close(),{}};openFeedbackDialog=(e,t,n)=>{let r=document.getElementById(ut.calculatorFeedbackDialog);return n||null==n?r.showModal():r.close(),{}};openMatrixDialog=(e,t,n)=>{let r=e.dialogManager.matrixDialog;return n||null==n?r.show():r.close(),{}};openDecimalFormatSettingDialog=(e,t,n)=>{let r=e.dialogManager.decimalFormatSettingDialog;return n||null==n?r.showModal():r.close(),{}};openInsertMatrixDialog=(e,t,n)=>{let r=e.dialogManager.insertMatrixDialog;return n||null==n?r.show():r.close(),{}};calculatePreview=(e,t,n)=>{let r=e.eventManager.createEvent("calculatePreview",void 0,{isWaitingToComputeResult:!0}),i=e.calculatorScreenElement.currentInput.value,a=e.calcSettingManager.getSnapshot(),o=e.variableManager.getSnapshot(),s=e.calcModeStateManager.getSnapshot(),u={event:r,mathExpression:i,triggerCommand:"calculatePreview"};return u={...u,calculatorStateSnapshot:{setting:a,variableValues:o,calculatorCalcModeState:s},instantResult:!0,priority:Fe.DEBOUNCE},u.usingVariables=e.variableManager.getOnlyVariablePresent(i,[],[K.Ans,K.PreAns]),n&&(u.priority=n),u.event&&e.eventManager.setCalculateOptions(u.event.id,u),e.computeEngine.createCalcRequest(u,(t=>{e.onCalcResponse(t)})),{triggerNewEvent:!1}};calculate=(e,t,n)=>{let r=e.calcSettingManager.getSnapshot(),i=e.variableManager.getSnapshot(),a=e.calcModeStateManager.getSnapshot(),o={isCalculateAction:!0},s=e.calculatorScreenElement.currentInput.value,u={mathExpression:s,triggerCommand:"calculate",priority:Fe.IMMEDIATELY,calculatorStateSnapshot:{setting:r,variableValues:i,calculatorCalcModeState:a},usingVariables:e.variableManager.getOnlyVariablePresent(s)};if(r.calculatorMainMode==me.MATH_MODE){let t=e.eventManager.createEvent("calculate",void 0,{isWaitingToComputeResult:!n?.calculateInSilence});return u={...u,event:t,updatingVariablesValue:{variableList:[K.Ans],strategy:mn.ALWAYS_UPDATE},isFinishEditSection:!0,isRecordHistory:!0},e.eventManager.setCalculateOptions(t.id,u),e.computeEngine.createCalcRequest(u,(t=>{e.onCalcResponse(t)})),o}if(r.calculatorMainMode==me.CALC_MODE){let t=a.currentStep?.actions,n=a.currentStep?.variableName;if(t==z.CALCULATE_MAIN_MATH_RESULT_AND_EXIT_CALC_MODE)return this.perform(e,["changeCalculatorMainMode",me.MATH_MODE]),this.perform(e,"calculate"),o;if(t==z.CALCULATE_AND_SAVE_VARIABLE_VALUE){if(i[n]?.displayingLatex===s)return e.calcModeStateManager.getNextStep(a.currentStep),o;let t=e.eventManager.createEvent("calculate");u.event=t,u={...u,saveResultInVariable:[n],isFinishEditSection:!0,calcModeOptions:{goToNextStep:!0}},e.eventManager.setCalculateOptions(t.id,u),e.computeEngine.createCalcRequest(u,(t=>{e.onCalcResponse(t)}))}if(t==z.CALCULATE_MAIN_MATH_RESULT){let t=e.eventManager.createEvent("calculate");u={...u,event:t,mathExpression:a.mainMathExpression,saveResultInVariable:[n],isFinishEditSection:!0,usingVariables:e.variableManager.getOnlyVariablePresent(a.mainMathExpression),calcModeOptions:{goToNextStep:!0},updatingVariablesValue:{variableList:[K.Ans],strategy:mn.ALWAYS_UPDATE},isRecordHistory:!0},e.eventManager.setCalculateOptions(t.id,u),e.computeEngine.createCalcRequest(u,(t=>{e.onCalcResponse(t)}))}t==z.SHOW_MAIN_MATH_RESULT&&e.calcModeStateManager.getNextStep(a.currentStep)}return o};calculateMPlus=(e,t)=>this.calculateMPlusMinus(e,{source:Rt.PROGRAM},b.calculateMPlus);calculateMMinus=(e,t)=>this.calculateMPlusMinus(e,{source:Rt.PROGRAM},b.calculateMMinus);convertToMixedFraction=(e,t)=>{if(e.isCalcMode&&e.calcModeStateManager.currentStep?.actions!=z.SHOW_MAIN_MATH_RESULT)return Ke.show({message:Ct.FUNCTION_NOT_SUPPORT_IN_MODE,type:"error"}),{};let n=e.calculatorScreenElement.computeResult;if(!n?.resultObject)return{};let r=e.eventManager.createEvent(b.convertToMixedFraction),i=e.calcSettingManager.getSnapshot(),a=e.variableManager.getSnapshot(),o=e.calcModeStateManager.getSnapshot(),s=e.calculatorScreenElement.currentInput.value,u={event:r,mathExpression:s,calculatorStateSnapshot:{setting:i,variableValues:a,calculatorCalcModeState:o},priority:Fe.IMMEDIATELY,usingVariables:e.variableManager.getOnlyVariablePresent(s),isFinishEditSection:!0,isRecordHistory:!0,triggerCommand:b.convertToMixedFraction,expectOutputType:"Mixed Fraction"===n?.resultName?"Fraction":"Mixed Fraction",convertResultOnly:!0,resultObject:n.resultObject};return e.eventManager.setCalculateOptions(r.id,u),e.computeEngine.createCalcRequest(u,(t=>{e.onCalcResponse(t)})),{}};convertToDMS=(e,t)=>{if(e.isCalcMode&&e.calcModeStateManager.currentStep?.actions!=z.SHOW_MAIN_MATH_RESULT)return Ke.show({message:Ct.FUNCTION_NOT_SUPPORT_IN_MODE,type:"error"}),{};let n=e.calculatorScreenElement.computeResult;if(!n?.resultObject)return{};let r=e.eventManager.createEvent(b.convertToDMS),i=e.calcSettingManager.getSnapshot(),a=e.variableManager.getSnapshot(),o=e.calcModeStateManager.getSnapshot(),s=e.calculatorScreenElement.currentInput.value,u={event:r,mathExpression:s,calculatorStateSnapshot:{setting:i,variableValues:a,calculatorCalcModeState:o},priority:Fe.IMMEDIATELY,usingVariables:e.variableManager.getOnlyVariablePresent(s),isFinishEditSection:!0,isRecordHistory:!0,triggerCommand:b.convertToDMS,expectOutputType:"DMS"===n?.resultName?e.calcSettingManager.calculationType===Jt.FRAC?"Fraction":"Numeric":"DMS",convertResultOnly:!0,resultObject:n.resultObject};return e.eventManager.setCalculateOptions(r.id,u),e.computeEngine.createCalcRequest(u,(t=>{e.onCalcResponse(t)})),{}};switchSymbolicAndDecimal=(e,t)=>{if(e.isCalcMode&&e.calcModeStateManager.currentStep?.actions!=z.SHOW_MAIN_MATH_RESULT)return Ke.show({message:Ct.FUNCTION_NOT_SUPPORT_IN_MODE,type:"error"}),{};let n,r=e.calculatorScreenElement.computeResult?.resultName,i=e.calculatorScreenElement.computeResult?.availableResultNames;return"Fraction"==r&&i.includes("Repeated Decimal")&&(n="Repeated Decimal"),"Repeated Decimal"==n?e.executeCommands([b.changeCalculationType,Jt.FRAC],{expectedOutputResultName:n}):e.executeCommands(b.changeCalculationType),{}};solve=(e,t)=>{if(!e.isMathMode)return{};let n=e.eventManager.createEvent("solve"),r=e.calcSettingManager.getSnapshot(),i=e.variableManager.getSnapshot(),a=e.calcModeStateManager.getSnapshot(),o=e.calculatorScreenElement.currentInput.value,s={event:n,mathExpression:o,calculatorStateSnapshot:{setting:r,variableValues:i,calculatorCalcModeState:a},priority:Fe.IMMEDIATELY,updatingVariablesValue:{variableList:Object.values(K),strategy:mn.ONLY_UPDATE_IF_PRESENT},usingVariables:e.variableManager.getOnlyVariablePresent(o),isFinishEditSection:!0,isRecordHistory:!0,triggerCommand:"solve"};return e.eventManager.setCalculateOptions(n.id,s),e.computeEngine.createCalcRequest(s,(t=>{e.onCalcResponse(t)})),{isCalculateAction:!0}};primeFactor=(e,t)=>{if(!e.isMathMode)return{};let n=e.eventManager.createEvent("primeFactor"),r=e.calcSettingManager.getSnapshot(),i=e.variableManager.getSnapshot(),a=e.calcModeStateManager.getSnapshot(),o=e.calculatorScreenElement.currentInput.value,s={event:n,mathExpression:o,calculatorStateSnapshot:{setting:r,variableValues:i,calculatorCalcModeState:a},priority:Fe.IMMEDIATELY,updatingVariablesValue:{variableList:[K.Ans],strategy:mn.ALWAYS_UPDATE},usingVariables:e.variableManager.getOnlyVariablePresent(o),isFinishEditSection:!0,isRecordHistory:!0,triggerCommand:"primeFactor"};return e.eventManager.setCalculateOptions(n.id,s),e.computeEngine.createCalcRequest(s,(t=>{e.onCalcResponse(t)})),{isCalculateAction:!0}};deleteBackward=(e,t)=>({inputValue:e.calculatorScreenElement.delete(),triggerNewEvent:!0,calculatePreview:!0});deleteAll=(e,t)=>{if(e.isCalcMode)return e.calcModeStateManager.currentStep?.actions==z.SHOW_MAIN_MATH_RESULT||e.calculatorScreenElement.currentInput.isEmpty?(this.changeCalculatorMainMode(e,{source:Rt.PROGRAM},me.MATH_MODE),{scrollToInputElement:!0,triggerNewEvent:!0}):{inputValue:e.calculatorScreenElement.clear(),triggerNewEvent:!0,calculatePreview:!0,scrollToInputElement:!0};let n=e.calculatorScreenElement.clear();return e.focusStateManager.setFocusState({focusElement:e.calculatorScreenElement.currentInput.focusElementName}),{inputValue:n,triggerNewEvent:!0,calculatePreview:!0,scrollToInputElement:!0}};changeCalculatorMode=(e,t,n)=>{console.log("Change Mode: ",n);let r=!0;return n===vn.STO&&e.isCalcMode&&e.calcModeStateManager.currentStep?.actions!=z.SHOW_MAIN_MATH_RESULT&&(r=!1,Ke.show({message:Ct.FUNCTION_NOT_SUPPORT_IN_MODE,type:"error"})),r&&(e.calcSettingManager.calculatorMode=n),{resetCalculatorMode:!1}};changeCalculationType=(e,t,n)=>{n?e.calcSettingManager.calculationType=n:e.calcSettingManager.calculationType==Jt.FRAC?e.calcSettingManager.calculationType=Jt.DEC:e.calcSettingManager.calculationType=Jt.FRAC;let r=e.calculatorScreenElement.computeResult;if(!r?.resultObject)return{};let i=e.calcSettingManager.getSnapshot(),a=e.variableManager.getSnapshot(),o=e.calcModeStateManager.getSnapshot(),s=e.calculatorScreenElement.currentInput.value,u=e.eventManager.createEvent(b.changeCalculationType),c=t?.expectedOutputResultName;null==c&&(c=e.calcSettingManager.calculationType===Jt.FRAC?"Fraction":"Numeric");let l={event:u,mathExpression:s,calculatorStateSnapshot:{setting:i,variableValues:a,calculatorCalcModeState:o},triggerCommand:b.changeCalculationType,isRecordScreenHistory:!0,expectOutputType:c,convertResultOnly:!0,resultObject:r.resultObject,fallbackCalcResponse:r.calcResponse?.parentCalcResponse??r.calcResponse};return e.eventManager.setCalculateOptions(u.id,l),e.computeEngine.createCalcRequest(l,(t=>{e.onCalcResponse(t)})),{}};changeAngleUnit=(e,t,n)=>(e.calcSettingManager.angleUnit=n,{calculatePreview:!0,triggerNewEvent:!0,calculatePriority:Fe.IMMEDIATELY});changeDecimalFormatType=(e,t,n)=>(e.calcSettingManager.decimalFormatType=n,{triggerNewEvent:!0,calculatePreview:!0});changePrecision=(e,t,n)=>(e.calcSettingManager.precision=n,{triggerNewEvent:!0,calculatePreview:!0});changeCalculatorMainMode=(e,t,n)=>{if(n==e.calcSettingManager.calculatorMainMode)return{};let r=e.calcModeStateManager;if(n==me.MATH_MODE)return r.stopCalcMode(),{scrollToInputElement:!0};if(n==me.CALC_MODE){let t=e.calculatorScreenElement.mathModeScreen.mathInput.value;return r.startCalcMode(t)?r.getNextStep(void 0):e.executeCommands([b.calculate]),{scrollToInputElement:!0}}};toggleUseDecimalPointSeparator=(e,t,n)=>(e.calcSettingManager.useDecimalPointSeparator=n,n?e.calcSettingManager.setKeyMapOverride([{functionId:"decimal place",keyCombos:[{keyCodes:["Period"]},{keyCodes:["NumpadDecimal"]}]},{functionId:"comma",keyCombos:[{keyCodes:["Comma"]}]}],"merge"):e.calcSettingManager.setKeyMapOverride([{functionId:"decimal place",keyCombos:[{keyCodes:["NumpadDecimal"]},{keyCodes:["Comma"]}]},{functionId:"comma",keyCombos:[{keyCodes:["Period"]}]}],"merge"),{});toggleUseIndianStyleOfDigitGrouping=(e,t,n)=>(e.calcSettingManager.useIndianStyleOfDigitGrouping=n,{triggerNewEvent:!0,calculatePreview:!0,calculatePriority:Fe.IMMEDIATELY});changeThousandSeparatorChar=(e,t,n)=>(console.log("changeThousandSeparatorChar: ",`"${n}"`),e.calcSettingManager.thousandSeparatorChar=n,{});changeThousandthSeparatorChar=(e,t,n)=>(console.log("changeThousandthSeparatorChar: ",`"${n}"`),e.calcSettingManager.thousandthSeparatorChar=n,{});changeScientificNotationType=(e,t,n)=>(console.log("changeScientificNotationType: ",n),e.calcSettingManager.scientificNotationType=n,{triggerNewEvent:!0,calculatePreview:!0});changePercentCalculationType=(e,t,n)=>(console.log("changePercentCalculationType: ",n),e.calcSettingManager.percentCalculationType=n,{triggerNewEvent:!0,calculatePreview:!0});changeImplicitMultiplication=(e,t,n)=>(console.log("changeImplicitMultiplication: ",n),e.calcSettingManager.implicitMultiplication=n,{triggerNewEvent:!0,calculatePreview:!0});moveCursor=(e,t,n)=>(e.calculatorScreenElement.currentInput.hasFocus?e.calculatorScreenElement.moveCursor(n):e.focusStateManager.setFocusState({focusElement:e.calculatorScreenElement.currentInput.focusElementName}),{triggerNewEvent:!0});stoVariable=(e,t,n)=>{if(!e.isMathMode)return{};let r=e.eventManager.createEvent("stoVariable"),i=e.calcSettingManager.getSnapshot(),a=e.variableManager.getSnapshot(),o=e.calcModeStateManager.getSnapshot(),s=e.calculatorScreenElement.currentInput.value,u={event:r,mathExpression:s,calculatorStateSnapshot:{setting:i,variableValues:a,calculatorCalcModeState:o},stoVariables:[n],priority:Fe.IMMEDIATELY,usingVariables:e.variableManager.getOnlyVariablePresent(s),isFinishEditSection:!0,isRecordHistory:!0,triggerCommand:"stoVariable"};return e.eventManager.setCalculateOptions(r.id,u),e.computeEngine.createCalcRequest(u,(t=>{e.onCalcResponse(t)})),{}};clearAllVariableValue=(e,t,n=!1)=>n?(vu.showConfirm({title:Ym()}).then((t=>{"confirm"==t&&e.variableManager.clear()})),{}):(e.variableManager.clear(),{});clearHistory=(e,t,n)=>n?(vu.showConfirm({title:Xm()}).then((t=>{"confirm"==t&&e.calcHistoryManager.clear()})),{}):(e.calcHistoryManager.clear(),{});resetDefaultSetting=(e,t)=>(e.calcSettingManager.resetDefault(),{triggerNewEvent:!0,calculatePreview:!0});selectAll=(e,t)=>(e.calculatorScreenElement.currentInput.selectAll(),{});undo=(e,t)=>{let n=e.calculatorScreenElement.currentInput;if(n.canUndo)return e.isCalcMode&&(e.calcModeStateManager.currentStep.actions===z.SHOW_MAIN_MATH_RESULT||e.calcModeStateManager.currentStep.actions===z.CALCULATE_MAIN_MATH_RESULT)&&e.executeCommands([b.changeCalculatorMainMode,me.MATH_MODE]),n.undo(),e.focusStateManager.focusOnCurrentInput(),{triggerNewEvent:!0}};redo=(e,t)=>{let n=e.calculatorScreenElement.currentInput;if(n.canRedo)return e.isCalcMode&&(e.calcModeStateManager.currentStep.actions===z.SHOW_MAIN_MATH_RESULT||e.calcModeStateManager.currentStep.actions===z.CALCULATE_MAIN_MATH_RESULT)&&e.executeCommands([b.changeCalculatorMainMode,me.MATH_MODE]),n.redo(),e.focusStateManager.focusOnCurrentInput(),{triggerNewEvent:!0}};copy=(e,t,n)=>{let r=n?.targetFormat,i=n?.sourceFormat,a=n?.value;function o(e){return new Promise(((t,n)=>{navigator.permissions.query({name:"clipboard-write"}).then((r=>{"granted"===r.state||"prompt"===r.state?navigator.clipboard.writeText(e).then((e=>{t()})):n()}))}))}try{let t=void 0!==a?a:e.calculatorScreenElement?.currentInput?.selectedValue||e.calculatorScreenElement?.currentInput?.value;if(!t)return{};Ke.show({message:"Coping",type:"loading"}),r=r||"plaintext",i=i||"NCalcLatex","plaintext"===r&&"NCalcLatex"==i&&e.calculatorService.convertToInfix(t).then((e=>{if(e.success){let n=e.data?.expressions[0]?.infix;o(n).then((()=>{Ke.show({message:"Copied plain text to Clipboard",type:"success"})})),void 0===a?st.sendMathContextMenuEvent("copy-plain-text-from-input"):st.sendMathContextMenuEvent("copy-plain-text"),Ea.saveNcalcFxFormat(n,t)}else Ke.showUnknownError()})),"latex"===r&&"NCalcLatex"===i&&e.calculatorService.ncalcLatexToStandardLatex(t).then((e=>{if(e.success){let n=`${e.data?.expressions[0]?.latex}`;o(n).then((()=>{Ke.show({message:"Copied LaTex to Clipboard",type:"success"})})),void 0===a?st.sendMathContextMenuEvent("copy-latex-from-input"):st.sendMathContextMenuEvent("copy-latex"),Ea.saveNcalcFxFormat(n,t)}else Ke.showUnknownError()}))}catch(e){console.error("Failed to copy: ",e)}return{}};paste=async(e,t)=>{try{let t=await navigator.clipboard.readText();console.info("Pasted content: ",t),Ke.show({message:"Processing paste",type:"loading"}),Ea.getNcalcFxFormat(t).then((n=>{new Promise(((r,i)=>{n?r(n):e.calculatorService.convertTextToNcalcFxLatexFormat({value:t}).then((e=>{e.success&&e.data?.expressions?.length>0&&e.data?.expressions[0]?.latex?r(e.data.expressions[0].latex):i(e)}))})).then((t=>{e.calculatorScreenElement.insert(t),e.focusStateManager.restoreFocusState(),Ke.show({message:"Paste successfully",type:"success"})})).catch((e=>{Ke.show({message:e.error?.data?.message||"Invalid math",type:"error"})}))}))}catch(e){console.error("Failed to read clipboard contents: ",e)}return{calculatePreview:!0,calculatePriority:Fe.IMMEDIATELY}};calculateMPlusMinus(e,t,n){if(e.isCalcMode){if(e.calcModeStateManager.currentStep?.actions!=z.SHOW_MAIN_MATH_RESULT)return Ke.show({message:Ct.FUNCTION_NOT_SUPPORT_IN_MODE,type:"error"}),{};this.changeCalculatorMainMode(e,{source:Rt.PROGRAM},me.MATH_MODE)}let r=e.eventManager.createEvent(n),i=e.calcSettingManager.getSnapshot(),a=e.variableManager.getSnapshot(),o=e.calcModeStateManager.getSnapshot(),s=e.calculatorScreenElement.currentInput.value,u={event:r,mathExpression:s,calculatorStateSnapshot:{setting:i,variableValues:a,calculatorCalcModeState:o},priority:Fe.IMMEDIATELY,usingVariables:e.variableManager.getOnlyVariablePresent(s),isFinishEditSection:!0,isRecordHistory:!0,triggerCommand:n};return e.eventManager.setCalculateOptions(r.id,u),e.computeEngine.createCalcRequest(u,(t=>{e.onCalcResponse(t)})),{isCalculateAction:!0}}}function Et(e){return"function"==typeof e}function Ou(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ma=Ou((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function Na(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var jr=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=Da(a),s=o.next();!s.done;s=o.next()){s.value.remove(this)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var u=this.initialTeardown;if(Et(u))try{u()}catch(e){i=e instanceof Ma?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var l=Da(c),p=l.next();!p.done;p=l.next()){var d=p.value;try{Su(d)}catch(e){i=i??[],e instanceof Ma?i=xa(xa([],wa(i)),wa(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(i)throw new Ma(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Su(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Na(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Na(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),Ru=jr.EMPTY;function Ku(e){return e instanceof jr||e&&"closed"in e&&Et(e.remove)&&Et(e.add)&&Et(e.unsubscribe)}function Su(e){Et(e)?e():e.unsubscribe()}var Fu={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Iy={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,xa([e,t],wa(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Ty(e){Iy.setTimeout((function(){throw e}))}function _u(){}function Yr(e){e()}var Pu=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Ku(t)&&t.add(n)):n.destination=Ly,n}return Yn(t,e),t.create=function(e,t,n){return new Oa(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(jr),Dy=Function.prototype.bind;function Aa(e,t){return Dy.call(e,t)}var xy=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){$r(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){$r(e)}else $r(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){$r(e)}},e}(),Oa=function(e){function t(t,n,r){var i,a,o=e.call(this)||this;Et(t)||!t?i={next:t??void 0,error:n??void 0,complete:r??void 0}:o&&Fu.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},i={next:t.next&&Aa(t.next,a),error:t.error&&Aa(t.error,a),complete:t.complete&&Aa(t.complete,a)}):i=t;return o.destination=new xy(i),o}return Yn(t,e),t}(Pu);function $r(e){Ty(e)}function wy(e){throw e}var Ly={closed:!0,next:_u,error:wy,complete:_u},Ny="function"==typeof Symbol&&Symbol.observable||"@@observable";function Oy(e){return e}function Ry(e){return 0===e.length?Oy:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Cu=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this,i=Fy(e)?e:new Oa(e,t,n);return Yr((function(){var e=r,t=e.operator,n=e.source;i.add(t?t.call(i,n):n?r._subscribe(i):r._trySubscribe(i))})),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Eu(t))((function(t,r){var i=new Oa({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Ny]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ry(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Eu(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Eu(e){var t;return null!==(t=e??Fu.Promise)&&void 0!==t?t:Promise}function Ky(e){return e&&Et(e.next)&&Et(e.error)&&Et(e.complete)}function Fy(e){return e&&e instanceof Pu||Ky(e)&&Ku(e)}var Py=Ou((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),ku=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return Yn(t,e),t.prototype.lift=function(e){var t=new Mu(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Py},t.prototype.next=function(e){var t=this;Yr((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=Da(t.currentObservers),a=i.next();!a.done;a=i.next()){a.value.next(e)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;Yr((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;Yr((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,a=n.observers;return r||i?Ru:(this.currentObservers=null,a.push(e),new jr((function(){t.currentObservers=null,Na(a,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new Cu;return e.source=this,e},t.create=function(e,t){return new Mu(e,t)},t}(Cu),Mu=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return Yn(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Ru},t}(ku),ze=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return Yn(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(ku);class Au{eventId;status;result;resultName;resultRepresentation;error;variables;config;resultObject;calcModeStep;options;outputType;availableResultNames;calcResponse;constructor(e,t){if(this.eventId=e.payload?.requestId,this.calcResponse=e,this.options=t,this.outputType=e.outputType,!e)return void(this.status=1);e.error&&(this.status=0,this.error={message:t.hideErrorMessage?"":e.error?.message?.toString()});let n=new Set;if(e.result?.resultName&&(n.add(e.result.resultName),e.result.alternativeForms?.RepeatDecimalResult?.resultName&&n.add(e.result.alternativeForms?.RepeatDecimalResult?.resultName),e.result.alternativeForms?.MixedFractionResult?.resultName&&n.add(e.result.alternativeForms?.MixedFractionResult?.resultName)),this.availableResultNames=Array.from(n),e.result){let n=e.result?.displayResultLatex,r=e.result?.numericRepresentation?.displayResultLatex;this.resultObject=e.result?.resultObject,this.resultName=e.result?.resultName,"Repeated Decimal"===this.outputType&&(n=e.result?.alternativeForms?.RepeatDecimalResult?.displayResultLatex??n,this.resultObject=e.result?.alternativeForms?.RepeatDecimalResult?.resultObject,r=void 0,this.resultName=e.result?.alternativeForms?.RepeatDecimalResult?.resultName??this.resultName),void 0!==n&&(this.result={latex:n.trim()}),void 0!==r&&r!==n&&(this.resultRepresentation={latex:"= "+r?.trim()}),t?.stoVariable&&e.variables?.Ans&&(this.resultRepresentation=void 0,this.result={latex:e.variables.Ans.displayingLatex.trim()+`\\rightarrow\\variable{${t.stoVariable}}`}),t?.assignToM&&e.variables?.Ans&&(this.resultRepresentation=void 0,this.result={latex:e.variables.Ans.displayingLatex.trim()+"\\rightarrow M"})}this.calcModeStep=t?.calcModeStep,this.result&&this.result.latex.trim().length>0&&(this.status=2),this.result&&0==this.result.latex.trim().length&&(this.status=1)}}class bu{input;constructor(e){this.input={latex:e}}}const ge=[];for(let e=0;e<256;++e)ge.push((e+256).toString(16).slice(1));function ky(e,t=0){return(ge[e[t+0]]+ge[e[t+1]]+ge[e[t+2]]+ge[e[t+3]]+"-"+ge[e[t+4]]+ge[e[t+5]]+"-"+ge[e[t+6]]+ge[e[t+7]]+"-"+ge[e[t+8]]+ge[e[t+9]]+"-"+ge[e[t+10]]+ge[e[t+11]]+ge[e[t+12]]+ge[e[t+13]]+ge[e[t+14]]+ge[e[t+15]]).toLowerCase()}let ba;const Uy=new Uint8Array(16);function By(){if(!ba){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ba=crypto.getRandomValues.bind(crypto)}return ba(Uy)}const Hy=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Iu={randomUUID:Hy};function Jr(e,t,n){if(Iu.randomUUID&&!t&&!e)return Iu.randomUUID();const r=(e=e||{}).random||(e.rng||By)();return r[6]=15&r[6]|64,r[8]=63&r[8]|128,ky(r)}class Ft{static CALC_HISTORIES_KEY="CALC_HISTORIES_KEY";static MAX_HISTORY_LENGTH=50;$loadingHistory=new ze(!0);$historyList=new ze([]);$screenHistoryList=new ze([]);$historyListChangedAction=new ze({action:"init",originList:this.historyList});$screenHistoryListChangedAction=new ze({action:"init",originList:this.screenHistoryList});_calculatorService=Xn.getInstance();_pendingScreenHistoryRecord;constructor(){this.historyList=[],yn.getInstance().isAuthenticated?this._calculatorService.getHistory().then((async e=>{e.success?(e.data.data.length>0&&await new Promise((e=>setTimeout(e,5e3))),this.historyList=e.data.data.map((e=>Ft.convertCalcHistoryModelToCalcLocalHistory(e))).reverse()):this.historyList=[]})).catch((e=>{console.log("Fetch history got error: ",e)})).finally((()=>{this.$loadingHistory.next(!1)})):this.$loadingHistory.next(!1)}_historyList=[];get historyList(){return this._historyList}set historyList(e){this._historyList=e,this.cutListIfLengthOverLimitSize(),this.$historyList.next(e),this.$historyListChangedAction.next({action:"init",originList:this.historyList})}_screenHistoryList=[];get screenHistoryList(){return this._screenHistoryList}set screenHistoryList(e){this._screenHistoryList=e,this.$screenHistoryList.next(e),this.$screenHistoryListChangedAction.next({action:"init",originList:this.screenHistoryList})}static convertCalcLocalHistoryToCalcHistoryModel(e){let t={};t.localId=e.id,t={...t,...e?.extraInfo||{}},e.result?.resultRepresentation&&(t.result2=e.result.resultRepresentation.latex);let n={input:e.input?.input.latex,result:e.result?.result?.latex,calcModel:"CalcES",createdAt:e.calcAt?.getTime(),inputType:"latex",resultType:"latex"};return n.extraInfo=JSON.stringify(t),n}static convertCalcHistoryModelToCalcLocalHistory(e){let t={serverId:e.id,result:{result:{latex:e.result}},calcAt:e.createdAt,input:{input:{latex:e.input}}};return e.extraInfo&&("string"==typeof e.extraInfo&&(e.extraInfo=JSON.parse(e.extraInfo)),t.extraInfo={...e.extraInfo},e.extraInfo.result2&&(t.result.resultRepresentation={latex:e.extraInfo.result2}),e.extraInfo.localId&&(t.id=e.extraInfo.localId)),t}pushPendingScreenHistoryToList(){return!!this._pendingScreenHistoryRecord&&(this.screenHistoryList.push(this._pendingScreenHistoryRecord),this.$screenHistoryListChangedAction.next({action:"push",originList:this.screenHistoryList,value:this._pendingScreenHistoryRecord}),this._pendingScreenHistoryRecord=void 0,this.$screenHistoryList.next(this.screenHistoryList),!0)}clearScreenHistory(){this._pendingScreenHistoryRecord=void 0,this.screenHistoryList=[]}saveOnServer(e){yn.getInstance().isAuthenticated&&this._calculatorService.createHistory(Ft.convertCalcLocalHistoryToCalcHistoryModel(e)).then((e=>{if(e.success){let t=Ft.convertCalcHistoryModelToCalcLocalHistory(e.data),n=this._historyList.findIndex((e=>e.id==t.id));n>=0&&(this._historyList[n]=t)}else console.error("saveOnServer History got error: ",e)}))}clear(){this.historyList=[],yn.getInstance().isAuthenticated&&(this._calculatorService.deleteAllHistory().then((e=>{Qr.getInstance().info({message:zm()})})),this.notifyUpdate())}recordPendingScreenHistory(e,t,n){if(!e?.mathExpression||e.mathExpression.trim().length<=0)return;let r={id:e.event?.id||Jr(),input:new bu(e.mathExpression),result:t,calcAt:new Date,extraInfo:n},i=this._screenHistoryList[this._screenHistoryList.length-1];return r.input?.input&&void 0===r.result?.error&&r.result?.result&&r.result?.result?.latex?.trim().length>0&&r.input?.input.latex.trim().length>0?(i&&i.input?.input.latex==r.input?.input.latex&&i.result?.result?.latex==r.result?.result?.latex&&i.result?.resultRepresentation?.latex==r.result?.resultRepresentation?.latex&&(r.duplicateCount=(i.duplicateCount||1)+1),r.duplicateCount?this._pendingScreenHistoryRecord=void 0:this._pendingScreenHistoryRecord=r):this._pendingScreenHistoryRecord=void 0,r}record(e,t,n){if(!e?.mathExpression||e.mathExpression.trim().length<=0)return;let r=this._historyList[this._historyList.length-1],i={id:e.event?.id||Jr(),input:new bu(e.mathExpression),result:t,calcAt:new Date,extraInfo:n};return i.input?.input&&void 0===i.result?.error&&i.result?.result&&i.result?.result?.latex?.trim().length>0&&i.input?.input.latex.trim().length>0&&(r&&r.input?.input.latex==i.input?.input.latex&&r.result?.result?.latex==i.result?.result?.latex&&r.result?.resultRepresentation?.latex==i.result?.resultRepresentation?.latex&&(i.duplicateCount=(r.duplicateCount||1)+1),i.duplicateCount?(this._historyList[this._historyList.length-1]=i,this.$historyListChangedAction.next({action:"update",originList:this.historyList,value:i})):(this._historyList.push(i),this.cutListIfLengthOverLimitSize(),this.$historyListChangedAction.next({action:"push",originList:this.historyList,value:i}),this.saveOnServer(i))),this.notifyUpdate(),i}deleteHistory(e){return this._calculatorService.deleteHistory(this.historyList.find((t=>t.id==e))?.serverId).then().catch(console.error),this.historyList.splice(this.historyList.findIndex((t=>t.id==e)),1),this.$historyListChangedAction.next({action:"delete",originList:this.historyList,value:{id:e}}),this.notifyUpdate(),!0}notifyUpdate(){this.cutListIfLengthOverLimitSize(),this.$historyList.next(this.historyList),localStorage.setItem(Ft.CALC_HISTORIES_KEY,JSON.stringify(this.historyList))}cutListIfLengthOverLimitSize(){this.historyList.length>Ft.MAX_HISTORY_LENGTH&&this.historyList.splice(0,this.historyList.length-Ft.MAX_HISTORY_LENGTH)}}function Wy(e,t){let n=[];const r=new RegExp("\\\\variable{\\w+}","gm");let i;for(;null!==(i=r.exec(e));)i.index===r.lastIndex&&r.lastIndex++,i.forEach((e=>{let r=e.slice(10,e.length-1),i=K[r];i&&!t?.ignoreVariable?.includes(i)&&n.push(i)}));return n=n.filter((function(e,t,n){return t===n.indexOf(e)})),n.sort(),n}function Vy(e,t){if(0!=e.length){if(void 0===t)return e[0];var n=e.indexOf(t);if(n!=e.length-1&&0<=n&&n<e.length-1)return e[n+1]}}function qy(e,t){return JSON.stringify(e)==JSON.stringify(t)}function mv(e,t){try{let n={root:document.documentElement};new IntersectionObserver(((e,n)=>{e.forEach((e=>{t(e.intersectionRatio>0)}))}),n).observe(e)}catch(e){console.error(e)}}var Qt=(e=>(e.MATH_MODE_INPUT="MATH_MODE_INPUT,",e.CALC_MODE_INPUT="CALC_MODE_INPUT,",e.SCREEN_CONTAINER="SCREEN_CONTAINER,",e))(Qt||{});class $y{$currentStep=new ze(void 0);_variableInMath;constructor(e){this._calculator=e}_mainMathExpression;get mainMathExpression(){return this._mainMathExpression}set mainMathExpression(e){this._mainMathExpression=e,this._variableInMath=e?Wy(e,{ignoreVariable:[K.Ans,K.PreAns]}):[]}_currentStep;get currentStep(){return this._currentStep}set currentStep(e){qy(e,this._currentStep)||(this._currentStep=e,this.$currentStep.next(e),e?.actions==z.CALCULATE_MAIN_MATH_RESULT&&this.calculator.executeCommands([b.calculate]))}_calculator;get calculator(){return this._calculator}get variablesInMath(){return this._variableInMath||[]}startCalcMode(e){return this.mainMathExpression=e,this.variablesInMath.length>0?(this.calculator.calcSettingManager.calculatorMainMode=me.CALC_MODE,!0):(this.mainMathExpression=void 0,!1)}stopCalcMode(){this.calculator.calcSettingManager.calculatorMainMode=me.MATH_MODE,this.mainMathExpression=void 0,this.currentStep=void 0}getNextStep(e){if(void 0===e)return 0==this.variablesInMath.length?(this.currentStep=void 0,this.currentStep):(this.currentStep={variableName:this.variablesInMath[0],actions:z.CALCULATE_AND_SAVE_VARIABLE_VALUE},this.currentStep);if(e.actions==z.CALCULATE_AND_SAVE_VARIABLE_VALUE){if(this.isLastVariable(e.variableName))return this.currentStep={variableName:void 0,actions:z.CALCULATE_MAIN_MATH_RESULT},this.currentStep;let t=Vy(this.variablesInMath,e.variableName);return this.currentStep={variableName:t,actions:z.CALCULATE_AND_SAVE_VARIABLE_VALUE},this.currentStep}return e.actions==z.CALCULATE_MAIN_MATH_RESULT?(this.currentStep={variableName:void 0,actions:z.SHOW_MAIN_MATH_RESULT},this.currentStep):e.actions==z.SHOW_MAIN_MATH_RESULT?(this.currentStep={variableName:this.variablesInMath[0],actions:z.CALCULATE_AND_SAVE_VARIABLE_VALUE},this.currentStep):void(this.currentStep=void 0)}isLastVariable(e){return this.variablesInMath.indexOf(e)==this.variablesInMath.length-1}getSnapshot(){return{currentStep:this._currentStep,mainMathExpression:this._mainMathExpression,variablesInMath:this._variableInMath}}}const Ia={[K.a]:void 0,[K.b]:void 0,[K.c]:void 0,[K.d]:void 0,[K.z]:void 0,[K.f]:void 0,[K.x]:void 0,[K.y]:void 0,[K.m]:void 0,[K.t]:void 0,[K.Ans]:{displayingLatex:"0",internalValue:'{"tokens":[{"highPrecision":false,"symbol":"","rationalizationMode":0,"tokenClass":"number","displayRadix":10,"bitSize":-1,"indexInList":0,"associative":"NONE","type":"NUMBER","value":"0","rationalize":true,"precedence":290}],"version":"1.0"}'},[K.PreAns]:{displayingLatex:"0",internalValue:'{"tokens":[{"highPrecision":false,"symbol":"","rationalizationMode":0,"tokenClass":"number","displayRadix":10,"bitSize":-1,"indexInList":0,"associative":"NONE","type":"NUMBER","value":"0","rationalize":true,"precedence":290}],"version":"1.0"}'}},Gy={[K.a]:void 0,[K.b]:void 0,[K.c]:void 0,[K.d]:void 0,[K.z]:void 0,[K.f]:void 0,[K.x]:void 0,[K.y]:void 0,[K.m]:void 0,[K.t]:void 0,[K.Ans]:void 0,[K.PreAns]:void 0},Ta="CALC_VARIABLES";class Yy{$variableList=new ze(void 0);constructor(){this.variables=this.localSavedVariables,this.$variableList.subscribe((e=>{this.saveToLocal(e)}))}getSnapshot(){return{...this.variables}}getOnlyVariablePresent(e="",t=[],n){const r=/\\variable{\w+}/gm;let i,a=new Set;for(t.forEach((e=>{a.add(e)}));null!==(i=r.exec(e));)i.index===r.lastIndex&&r.lastIndex++,i.forEach((e=>{a.add(e.substring(10,e.length-1))}));let o={...this.emptyVariables};if(a.forEach((e=>{o[e]=this.variables[e]})),n)for(let e in o)n.findIndex((t=>t===e))<0&&(o[e]=void 0);return o}get defaultVariables(){return{...Ia}}get emptyVariables(){return{...Gy}}get localSavedVariables(){try{let e=localStorage.getItem(Ta);if(e){let t=JSON.parse(e);if(!t&&"object"==typeof t)throw new Error("Saved Variable invalid");return t}}catch(e){console.error("Load variable values local got error",e)}return{...Ia}}saveToLocal(e){e?localStorage.setItem(Ta,JSON.stringify(e)):localStorage.removeItem(Ta)}_variables;get variables(){return this._variables}set variables(e){this._variables=e,this.$variableList.next(e)}clear(){this.variables={...Ia}}update(e,t){return e==K.Ans&&(this.variables[K.PreAns]=this._variables.Ans),this.variables[e]=t,this.$variableList.next(this.variables),this._variables}batchUpdate(e,t){if(!t)return;let n=e.variableList,r=e.strategy;n.forEach((e=>{let n=t[e];(r==mn.ALWAYS_UPDATE||r===mn.ONLY_UPDATE_IF_PRESENT&&n)&&(e==K.Ans&&(this.variables[K.PreAns]=this.variables.Ans),this.variables[e]=n)})),this.$variableList.next(this.variables)}}class Xy{calculatorScreenElement;_calculator;mathModeScreen;calcModeScreen;lastFocusState;constructor(e){this._calculator=e,this.calculatorScreenElement=e.calculatorScreenElement;let t=this.calculatorScreenElement.mathModeScreen.mathInput;t.addEventListener("editor-click",(()=>{t.readOnly?this.restoreFocusState():this.setFocusState({focusElement:Qt.MATH_MODE_INPUT})}));let n=this.calculatorScreenElement.calcModeScreen.mathInput;n.addEventListener("editor-click",(()=>{n.readOnly?this.restoreFocusState():this.setFocusState({focusElement:Qt.CALC_MODE_INPUT})})),this.calculatorScreenElement.addEventListener("mousedown",(e=>{e.preventDefault()}));let r=document.getElementById(ut.calculator);r.addEventListener("click",(()=>{this.restoreFocusState()})),r.addEventListener("mousedown",(e=>{e.preventDefault()})),this.mathModeScreen=this.calculatorScreenElement.mathModeScreen,this.calcModeScreen=this.calculatorScreenElement.calcModeScreen,this.mathModeScreen.mathInput.addEventListener("focus",(e=>{if(e.detail.focus){let e=this._calculator.calcModeStateManager.currentStep;this._calculator.isCalcMode&&(e?.actions==z.SHOW_MAIN_MATH_RESULT||e?.actions==z.CALCULATE_MAIN_MATH_RESULT)&&this._calculator.executeCommands([b.changeCalculatorMainMode,me.MATH_MODE])}}))}onFinishedEditSession(){this.setFocusState({focusElement:Qt.SCREEN_CONTAINER}),this.calculatorScreenElement.currentInput.clearInNextInsert=!0}focusOnCurrentInput(){this.setFocusState({focusElement:this.calculatorScreenElement.currentInput.focusElementName})}setFocusState(e){switch(e.focusElement){case Qt.CALC_MODE_INPUT:this.calculatorScreenElement.focus(),this.calcModeScreen.focus();break;case Qt.MATH_MODE_INPUT:this.calculatorScreenElement.focus(),this.mathModeScreen.focus();break;case Qt.SCREEN_CONTAINER:this.calculatorScreenElement.focus();break;default:return void console.error("Focus state not handled,",e)}this.lastFocusState=e}restoreFocusState(){this.setFocusState(this.lastFocusState)}onCloseCalculatorDialog(){this.restoreFocusState()}}class Zt{requestId;status;results;result;error;config;payload;variables;inputStatus;outputType;parentCalcResponse;constructor(e){this.update(e)}update(e){this.error=e.error,this.result=e.result,this.results=e.results,this.config=e.config,this.payload=e.payload,this.variables=e.variables,this.requestId=e.payload?.requestId,this.inputStatus=e.inputStatus,this.error?this.status="ERROR":this.status="SUCCESS",this.outputType=e.outputType,this.parentCalcResponse=e.parentCalcResponse}}class zy{calculatorService=Xn.getInstance();previewCalcDelay=300;debouncedCalculateFunc=Sn.debounce(this.calculate,this.previewCalcDelay);user;constructor(e){this.user=e}lastPreviewCalcAt=0;createCalcRequest(e,t){if(this.debouncedCalculateFunc.cancel(),0==e.mathExpression?.length)return void this.calculate(this,e,t);if(e?.priority==Fe.IMMEDIATELY)return void this.calculate(this,e,t);let n=(new Date).getTime();n-this.lastPreviewCalcAt>this.previewCalcDelay?this.calculate(this,e,t):this.debouncedCalculateFunc(this,e,t),this.lastPreviewCalcAt=n}calculate(e,t,n){function r({error:e,message:n,code:r}){return{payload:{requestId:t.event?.id},error:{input:{format:"latex",value:t.mathExpression},message:429==r?"Too many requests. Please try again later":r>=500?"Something went wrong...":n??"Unknown Error"}}}function i(){return{payload:{requestId:t.event?.id},result:{displayResultLatex:""}}}const a=t.calculatorStateSnapshot?.setting,o={angleUnit:a.angleUnit,calculationType:a.calculationType,options:[1],percentCalculationType:a.percentCalculationType,instantResult:t.instantResult,smartResult:!0,autoDetectDms:t.autoDetectDms,implicitMultiplication:a.implicitMultiplication},s={decimalFormatType:a.decimalFormatType,normalPrecision:a.precision,sciencePrecision:a.precision,engPrecision:a.precision,fixPrecision:a.precision,useDecimalPointSeparator:a.useDecimalPointSeparator,thousandSeparatorChar:a.thousandSeparatorChar,thousandthSeparatorChar:a.thousandthSeparatorChar,useIndianStyleOfDigitGrouping:a.useIndianStyleOfDigitGrouping,scientificNotationType:a.scientificNotationType};new Promise(((n,a)=>{let u="calculate";"solve"==t?.triggerCommand?u="solve":"primeFactor"==t?.triggerCommand&&(u="primeFactor");let c={inputs:[{format:"latex",value:t.mathExpression}],actionCode:u,calculationConfig:o,resultFormatSettings:s,variables:t.usingVariables};if(!t.mathExpression||t.mathExpression.includes("placeholder")||0==t.mathExpression.trim().length)return void n(new Zt({...i(),inputStatus:xu.ERROR}));let l=t.instantResult?()=>e.calculatorService.calculateInstantResult(c):()=>e.calculatorService.calculate(c);t.convertResultOnly&&(t.resultObject||n(new Zt({...i()})),l=()=>new Promise(((e,n)=>{e({success:!0,data:{result:{resultObject:t.resultObject}}})}))),l().then((i=>{if(i.success){i.isFromCache&&(this.lastPreviewCalcAt=0);let a=t.expectOutputType;const u="Mixed Fraction"===a?e.calculatorService.convertResultToMixedFraction:"DMS"===a?e.calculatorService.convertResultToDMS:"Numeric"===a?e.calculatorService.convertResultToNumeric:"Symbolic"===a||"Fraction"===a||"Repeated Decimal"===a?e.calculatorService.convertResultToSymbolic:void 0;if(u){u(i.data.result.resultObject,o,s).then((e=>{if(e.success)switch(e.data||(e.data={}),e.data.parentCalcResponse=t.fallbackCalcResponse??i.data,e.data?.result?.displayResultLatex&&n(new Zt(e.data)),t.fallbackCalcResponse&&n(t.fallbackCalcResponse),a){case"DMS":n(r({message:Ct.CANNOT_CONVERT_TO_DMS}));break;case"Mixed Fraction":n(r({message:Ct.CANNOT_CONVERT_TO_MIXED_FRACTION}));break;case"Symbolic":case"Fraction":case"Numeric":n(r({message:Ct.CANNOT_CONVERT_TO_FRACTION}));break;default:n(r(e.data.error))}e.error&&(console.error("Error on calc request Handled: ",e.error),n(new Zt({...r(e.error)})))}))}else n(new Zt(i.data))}else i.error&&(console.error("Error on calc request Handled: ",i.error),n(new Zt({...r(i.error)})))})).catch((e=>{console.error("Error on calc request unhandled: ",e),n(new Zt({...r({error:e})}))}))})).then((e=>{e.payload||(e.payload={}),e.payload.requestId=t.event?.id,e.outputType=t.expectOutputType,n(e)}))}convertResult(e){}}class Zy{$eventUpdateSubject=new ze(void 0);$newEventCreatedSubject=new ze(void 0);_lastEvent;eventList=[];constructor(){console.log("Init","EventManager")}get lastEvent(){return this._lastEvent}getLastEventById(e){if(this._lastEvent?.id===e)return this._lastEvent}getRecentEventById(e){return this.eventList.find((t=>t.id===e))}createEvent(e,t,n){let r={id:Jr(),commands:e,calculateOptions:t,createdAt:new Date};return null==n?.isWaitingToComputeResult||n?.isWaitingToComputeResult?r.status=Gr.WAITING_FOR_COMPUTE_RESULT:(r.status=Gr.COMPLETED,r.finishedAt=new Date),this._lastEvent=r,Zm(this.eventList,r,10),this.notifyNewEventCreated(r),console.log("NEW EVENT CREATED: ",r),r}notifyLastEventUpdate(e){e.id==this._lastEvent?.id&&this.$eventUpdateSubject.next(e)}notifyNewEventCreated(e){this.$newEventCreatedSubject.next(e)}onReceivedComputeResult(e){let t=this.getLastEventById(e.eventId);if(t)return t.status=Gr.COMPLETED,t.computeResult=e,t.finishedAt=new Date,this.notifyLastEventUpdate(t),t}increaseCalcRequestCount(e){let t=this.getLastEventById(e);if(!t)return;let n=(t.calculateRequestCount||0)+1;return t.calculateRequestCount=n,n}setCalculateOptions(e,t){let n=this.getLastEventById(e);if(n)return n.calculateOptions=t,this.notifyLastEventUpdate(n),n}}class Jy{resultFormatDialog;scientificConstantsDialog;metricConversionsDialog;hypDialog;cmplxDialog;settingsDialog;matrixDialog;insertMatrixDialog;decimalFormatSettingDialog;commasMappingSelectDialog;confirmActionDialog;dialogWrapper;changeLayoutDialog;calculator;constructor(e){this.calculator=e,this.dialogWrapper=document.querySelector("calculator-dialog-wrapper"),this.resultFormatDialog=this.dialogWrapper.querySelector("result-format-dialog"),this.resultFormatDialog.init(e),this.resultFormatDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.scientificConstantsDialog=this.dialogWrapper.querySelector("scientific-constants-dialog"),this.scientificConstantsDialog.init(e),this.scientificConstantsDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.metricConversionsDialog=this.dialogWrapper.querySelector("metric-conversions-dialog"),this.metricConversionsDialog.init(e),this.metricConversionsDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.hypDialog=this.dialogWrapper.querySelector("hyp-dialog"),this.hypDialog.init(e),this.hypDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.cmplxDialog=this.dialogWrapper.querySelector("cmplx-dialog"),this.cmplxDialog.init(e),this.cmplxDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.settingsDialog=this.dialogWrapper.querySelector(`#${ut.settingDialog}`),this.settingsDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.matrixDialog=this.dialogWrapper.querySelector("matrix-dialog"),this.matrixDialog.init(e),this.matrixDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.decimalFormatSettingDialog=this.dialogWrapper.querySelector(`#${ut.decimalFormatSettingDialog}`),this.decimalFormatSettingDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.insertMatrixDialog=this.dialogWrapper.querySelector("insert-matrix-dialog"),this.insertMatrixDialog.init(e),this.insertMatrixDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.commasMappingSelectDialog=this.dialogWrapper.querySelector("commas-mapping-select-dialog"),this.commasMappingSelectDialog.init(e),this.commasMappingSelectDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.confirmActionDialog=this.dialogWrapper.querySelector("confirm-action-dialog"),this.confirmActionDialog.init(e),this.confirmActionDialog.addEventListener("close",(()=>{this.onCloseDialog()})),this.changeLayoutDialog=this.dialogWrapper.querySelector("#changeLayoutDialog"),this.changeLayoutDialog?.querySelector('form[name="changeLayout"]')?.querySelectorAll('input[type="radio"]')?.forEach((t=>{t.addEventListener("change",(t=>{t.target.checked&&e.executeCommands([b.switchLayout,t.target.value])}))}))}onCloseDialog(e){e||setTimeout((()=>{this.calculator.focusStateManager.onCloseCalculatorDialog()}),100)}hasAnyDialogOpening(){for(let e of document.querySelectorAll("dialog"))if(e.open)return!0;return!1}}class kt{static AUTO_OPEN_FEEDBACK_IN_SECOND="AUTO_OPEN_FEEDBACK_IN_SECOND";static AUTO_OPEN_SUGGEST_FULL_SCREEN_MODE_IN_SECOND="AUTO_OPEN_SUGGEST_FULL_SCREEN_MODE_IN_SECOND";static instance=null;apiService=km.getInstance();baseUrl;constructor(e=`${Lu.apiUrl}`){this.baseUrl=e+"/system-config"}static getInstance(){return null==kt.instance&&(kt.instance=new kt),this.instance}static configs;static fetchingDataRequest;static async getConfig(e){if(!this.configs)try{this.fetchingDataRequest||(this.fetchingDataRequest=this.getInstance().getAll());let e=await this.fetchingDataRequest;this.configs={},e.forEach((e=>{try{this.configs[e.attrKey]="number"==e.attrType?Number(e.attrValue):e.attrValue}catch(t){console.error("Get System config got error",e,t)}})),console.log("System config: ",this.configs)}catch(e){console.error("System config load error",e),this.configs={}}return this.configs[e]}getAll(){return this.apiService.get(this.baseUrl).then((e=>e.success?e.data.data:[]))}}const Qy=Bm({open:!1});class jy{_userFunctions;$userFunctions=new ze(void 0);_calculatorService=Xn.getInstance();_authService=yn.getInstance();_calcSettingManager;constructor(e){this._userFunctions=[],this._calcSettingManager=e,this._calcSettingManager.$userFunctions.subscribe((e=>{this.userFunctions=e||[]}))}create(e,t){e=Sn.cloneDeep(e);let n={},r=Jr(),i=[...this._userFunctions],a=this._userFunctions.find((t=>t.name===e.name));return a&&(a.params?.length||0)===(e.params?.length||0)?t?.override?i=i.map((t=>t.id===a.id?(e.id=r,e):t)):(n.error=!0,n.isDuplicated=!0,n.duplicateFunction=Sn.cloneDeep(a)):i.push(e),n.error||(this.userFunctions=i,this.saveToServer(i)),n}update(e){throw new Error("Method not implemented.")}delete(e){throw new Error("Method not implemented.")}async getFromServer(){throw new Error("Method not implemented.")}set userFunctions(e){this._userFunctions=e,this.$userFunctions.next(e)}getAllUserFunctions(){return this._userFunctions}saveToServer(e){try{wu.getCalculator().calcSettingManager.userFunctions=e}catch(e){console.error("Save User Function to Server Fail",e)}}saveToLocal(e){throw new Error("Method not implemented.")}}const ev=pe(!1),Tu="IS_SENT_CALCULATOR_FEEDBACK_KEY";class Ra extends HTMLElement{calculatorService;variableManager;calcHistoryManager;calculatorScreenElement;calculatorMenuBarElement;calcSettingManager;dialogManager;physicalKeyboardManager;eventManager;commandExecutor;computeEngine;calcModeStateManager;focusStateManager;userFunctionsManager;mathContextMenu;$isReadyToUse=new ze(!1);$calculateActionCount=new ze(0);user;showFeedbackDialogRetry=!1;showFullscreenSuggestRetry=!1;constructor(){super(),this.calculatorService=Xn.getInstance(),this.variableManager=new Yy,this.calcHistoryManager=new Ft,this.computeEngine=new zy,this.commandExecutor=new by,this.calcModeStateManager=new $y(this),this.eventManager=new Zy,this.calcSettingManager=new Kt,this.userFunctionsManager=new jy(this.calcSettingManager),this.physicalKeyboardManager=new yy(this),this.user=Um()?.user,this.mathContextMenu=document.querySelector("math-context-menu"),this.calcSettingManager.$calculatorMode.subscribe((e=>{this.setPageAttribute(Pe.calculatorMode,e)})),console.log("Finished Init Calculator")}get isCalcMode(){return this.calcSettingManager.calculatorMainMode==me.CALC_MODE}get isMathMode(){return this.calcSettingManager.calculatorMainMode==me.MATH_MODE}_isReadyToUse;get isReadyToUse(){return this._isReadyToUse||!1}set isReadyToUse(e){ev.set(e),this._isReadyToUse=e,this.$isReadyToUse.next(e),this.setPageAttribute(Pe.isReadyToUse,e),console.log("READY TO USE"),window.dispatchEvent(new CustomEvent("calc-loaded",{detail:{loaded:e}}))}get mathExpression(){return this.calculatorScreenElement.currentInput.value}static getIsSentCalculatorFeedback(){return"true"===localStorage.getItem(Tu)}static setIsSentCalculatorFeedback(e){localStorage.setItem(Tu,JSON.stringify(e))}increaseCalculateActionCount(){let e=this.$calculateActionCount.value+1;return this.$calculateActionCount.next(e),console.log("calculationActionCount ",e),e}onCalcResponse(e){let t=this.eventManager.getLastEventById(e?.payload?.requestId);if(!t)return;let n=t?.calculateOptions,r=e.inputStatus!==xu.ERROR&&!e.error;if(t.id==e?.payload?.requestId){t.calcResponse=e;let i=this.eventManager.increaseCalcRequestCount(t.id),a=n?.calculatorStateSnapshot?.calculatorCalcModeState.currentStep,o=t.commands;if(!r){let n=new Au(e,{calcModeStep:a,hideErrorMessage:"calculatePreview"===t.commands});a?.actions===z.CALCULATE_MAIN_MATH_RESULT&&this.executeCommands([b.changeCalculatorMainMode,me.MATH_MODE],{source:Rt.PROGRAM}),this.focusStateManager.focusOnCurrentInput(),this.eventManager.onReceivedComputeResult(n)}if(r){if((o==b.calculateMPlus||o==b.calculateMMinus)&&1==i){let n=e.variables?.[K.Ans]?.displayingLatex;if(n)return t.calculateOptions.saveResultInVariable=[K.m],void this.computeEngine.createCalcRequest({...t.calculateOptions,mathExpression:`${this.variableManager.variables.m?.displayingLatex||0}${o==b.calculateMPlus?"+":"-"}${n}`},(e=>{this.onCalcResponse(e)}))}let s;n?.updatingVariablesValue&&this.variableManager.batchUpdate(n.updatingVariablesValue,e.variables),n?.stoVariables&&n?.stoVariables.forEach((t=>{this.variableManager.update(t,e.variables?.[K.Ans])})),n?.stoVariables&&n?.stoVariables.length>0&&(s=n?.stoVariables[0]);let u=new Au(e,{stoVariable:s,calcModeStep:a,assignToM:t.commands==b.calculateMPlus||t.commands==b.calculateMMinus,scrollToResultView:[b.calculate,b.calculateMMinus,b.calculateMPlus,b.solve,b.primeFactor,b.stoVariable,b.convertToMixedFraction,b.convertToDMS].includes(o),ansValue:t.calculateOptions?.calculatorStateSnapshot?.variableValues?.Ans?.displayingLatex});this.eventManager.onReceivedComputeResult(u),n?.saveResultInVariable&&n?.saveResultInVariable.length>0&&n?.saveResultInVariable.forEach((t=>{this.variableManager.update(t,e.variables?.[K.Ans])})),n?.isFinishEditSection&&this.focusStateManager.onFinishedEditSession(),n?.calcModeOptions?.goToNextStep&&(r||!r&&a?.actions===z.CALCULATE_MAIN_MATH_RESULT)&&this.calcModeStateManager.getNextStep(a),n?.isRecordHistory&&this.calcHistoryManager.record(n,u,{command:n.triggerCommand,calcActionCount:this.$calculateActionCount.value,calcTime:t.calculateRequestCount,resultObject:t.computeResult?.resultObject,ansValue:t.calculateOptions?.calculatorStateSnapshot?.variableValues?.Ans?.displayingLatex}),(n?.isRecordHistory||n.isRecordScreenHistory)&&this.calcHistoryManager.recordPendingScreenHistory(n,u,{command:n.triggerCommand,calcActionCount:this.$calculateActionCount.value,calcTime:t.calculateRequestCount,resultObject:t.computeResult?.resultObject,ansValue:t.calculateOptions?.calculatorStateSnapshot?.variableValues?.Ans?.displayingLatex})}}}init(){this.dialogManager=new Jy(this),console.log("Init","Calculator Instance"),this.calculatorScreenElement=this.querySelector("calculator-screen"),this.calculatorMenuBarElement=this.querySelector("calculator-menu-bar"),this.focusStateManager=new Xy(this),this.isReadyToUse=!0,this.runStartScript(),this.focusStateManager.setFocusState({focusElement:this.calculatorScreenElement.mathModeScreen.mathInput.focusElementName}),window.addEventListener("keydown",(e=>{"Escape"===e.key&&!this.dialogManager.hasAnyDialogOpening()&&nt.getIsFullScreenMode()&&this.executeCommands([b.toggleFullscreen,!1])})),Xr.recordStartSession()}runStartScript(){Lu.isDevelopmentEnv&&console.log("Run start script")}executeCommands(e,t){console.info("command: ",e,"\nCalc Step: ",this.calcModeStateManager.currentStep),st.sendCommands(e);const n=this.commandExecutor.perform(this,e,t),r=new CustomEvent("command-executed",{detail:{command:e,extra:t,isHandled:n}});this.dispatchEvent(r),!n&&this.calcSettingManager.calculatorMode!=vn.DEFAULT&&(this.calcSettingManager.calculatorMode=vn.DEFAULT)}showFullscreenSuggestInTime(){let e=this.showFullscreenSuggestRetry;this.showFullscreenSuggestRetry=!1,kt.getConfig(kt.AUTO_OPEN_SUGGEST_FULL_SCREEN_MODE_IN_SECOND).then((t=>{if(0!==t)try{let n=1e3*(t??30);console.log("Open Suggest Fullscreen in ",n/1e3,"s"),setTimeout((()=>{nt.couldSuggestOpenFullscreenMode()&&(document.hidden?(st.sendOpenFullscreenSuggestDialog("open-auto-but-not-visible"),this.showFullscreenSuggestRetry=!0):(Qy.setKey("open",!0),st.sendOpenFullscreenSuggestDialog(e?"open-auto-retry":"open-auto"),this.showFullscreenSuggestRetry=!1,console.log("Open Suggest Fullscreen in ","retry",e)))}),n)}catch(e){console.log("Suggest Open Fullscreen Mode dialog got error: ",e)}}))}showFeedbackDialogInTime(){let e=this.showFeedbackDialogRetry;this.showFeedbackDialogRetry=!1;let t=Xr.getSessionInfo();if(console.log("sessionInfo",t),!t.firstUseAt)return void console.log("Not show feedback");let n=((new Date).getTime()-t.firstUseAt.getTime())/1e3/60/60;n<24?console.log("Not show feedback, first time using differ ",n):kt.getConfig(kt.AUTO_OPEN_FEEDBACK_IN_SECOND).then((t=>{try{if(!Ra.getIsSentCalculatorFeedback()){let n=1e3*(t??300);console.log("Open feedback dialog in ",n/1e3,"s"),setTimeout((()=>{Ra.getIsSentCalculatorFeedback()||(document.hidden?(st.sendOpenFeedbackDialog("open-auto-but-not-visible"),this.showFeedbackDialogRetry=!0):(this.executeCommands(b.openFeedbackDialog),st.sendOpenFeedbackDialog(e?"open-auto-retry":"open-auto"),console.log("Open feedback dialog in ","retry ",e)))}),n)}}catch(e){console.log("Auto Open Feedback dialog got error: ",e)}}))}setPageAttribute(e,t){null==t?document.getElementById(ut.calculatorPage).removeAttribute(e):document.getElementById(ut.calculatorPage).setAttribute(e,t.toString())}}export{Ra as C,Gr as E,Qt as F,Sn as _,me as a,z as b,nt as c,vu as d,gv as e,qy as i,mv as r};