import{g as Pr}from"./utils.Cz7UNdBz.js";import{a as ne}from"./authStore.CN9YIAzg.js";class Dr{static sendCommands(e){try{if(!e)return;let t,n;Array.isArray(e)?(t=e[0],n=e.slice(1)):t=e,this.sendGTMEvent({event:"calc_command_executed",value:t,commandArgs:n})}catch(e){console.error("Send Command to GTM got error: ",e)}}static sendKeyboardShortcut(e){try{this.sendGTMEvent({event:"calc_kbs_pressed",value:e})}catch(e){console.error("Send sendKeyboardShortcut to GTM got error: ",e)}}static sendOpenFeedbackDialog(e){try{this.sendGTMEvent({event:"calc_feedback_dialog_open",value:e})}catch(e){console.error("Send sendOpenFeedbackDialog to GTM got error: ",e)}}static sendOpenLoginDialog(e){try{this.sendGTMEvent({event:"calc_feedback_dialog_open",value:e})}catch(e){console.error("Send sendOpenLoginDialog to GTM got error: ",e)}}static sendOpenCommasMappingSelectDialog(e){try{this.sendGTMEvent({event:"calc_comma_keymap_select",value:e})}catch(e){console.error("Send sendOpenCommasMappingSelectDialog to GTM got error: ",e)}}static sendOpenFullscreenSuggestDialog(e){try{this.sendGTMEvent({event:"calc_fullscreen_suggest",value:e})}catch(e){console.error("Send sendOpenFullscreenSuggestDialog to GTM got error: ",e)}}static sendCacheHit(e){try{this.sendGTMEvent({event:"calc_cache_hit",value:e})}catch(e){console.error("Send sendCacheHit to GTM got error: ",e)}}static sendMathContextMenuEvent(e){try{this.sendGTMEvent({event:"calc_math_context_menu",value:e})}catch(e){console.error("Send sendOpenFullscreenSuggestDialog to GTM got error: ",e)}}static sendGTMEvent(e){typeof window>"u"||!e||(window.dataLayer=window.dataLayer||[],window.dataLayer.push(e))}}class re{static instance=null;lastToken=void 0;constructor(){}static getInstance(){return null==re.instance&&(re.instance=new re),this.instance}fetch(e,t={}){Z.getInstance().isAuthenticated?(this.lastToken||(this.lastToken=nt()?.jwtToken?.token),t.headers||(t.headers={}),t.headers.Authorization=`Bearer ${this.lastToken}`):(this.lastToken=void 0,delete t?.headers?.Authorization);const n={success:!1};return new Promise((function(r){fetch(e,t).then((async t=>{if(!t.ok)return n.success=!1,n.error={code:t.status,message:t.statusText,data:await t.json()},void r(n);n.success=!0;try{n.data=await t.json(),n.isFromCache=!!n.data.isFromCache,n.isFromCache&&Dr.sendCacheHit(e)}catch{n.data=t}r(n)})).catch((e=>{n.success=!1,n.error={error:e},r(n)}))}))}get(e,t,n){return t&&(e+=`/${t}`),this.fetch(e+""+(n?.params?"?"+new URLSearchParams(n?.params):""),{method:"GET"})}post(e,t,n){return this.fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...n?.headers},body:JSON.stringify(t)})}delete(e,t,n){return e+=`/${t}`,this.fetch(e+""+(n?"?"+new URLSearchParams(n):""),{method:"DELETE"})}}var At={};const dn=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Nr=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")},hn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,c=o?e[t+2]:0,l=i>>2,u=(3&i)<<4|a>>4;let h=(15&a)<<2|c>>6,d=63&c;o||(d=64,s||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(dn(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Nr(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const o=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==o)throw new Mr;const c=i<<2|s>>4;if(r.push(c),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==o){const e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Mr extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Lr=function(e){const t=dn(e);return hn.encodeByteArray(t,!0)},fn=function(e){return Lr(e).replace(/\./g,"")},pn=function(e){try{return hn.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ur(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Fr=()=>Ur().__FIREBASE_DEFAULTS__,xr=()=>{if(typeof process>"u"||typeof At>"u")return;const e=At.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0},$r=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&pn(e[1]);return t&&JSON.parse(t)},rt=()=>{try{return Fr()||xr()||$r()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},Br=e=>{var t,n;return null===(n=null===(t=rt())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},gn=()=>{var e;return null===(e=rt())||void 0===e?void 0:e.config},mn=e=>{var t;return null===(t=rt())||void 0===t?void 0:t[`_${e}`]};class jr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function m(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Vr(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())}function Hr(){return typeof navigator<"u"&&"Cloudflare-Workers"===navigator.userAgent}function _n(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function Wr(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Gr(){const e=m();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function vn(){try{return"object"==typeof indexedDB}catch{return!1}}function In(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function zr(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const qr="FirebaseError";class T extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=qr,Object.setPrototypeOf(this,T.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,z.prototype.create)}}class z{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?Kr(i,n):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new T(r,a,n)}}function Kr(e,t){return e.replace(Jr,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}const Jr=/\{\$([^}]+)}/g;function Yr(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Ie(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(kt(n)&&kt(s)){if(!Ie(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function kt(e){return null!==e&&"object"==typeof e}function le(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Xr(e,t){const n=new Qr(e,t);return n.subscribe.bind(n)}class Qr{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=Zr(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Ue),void 0===r.error&&(r.error=Ue),void 0===r.complete&&(r.complete=Ue);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}})),this.observers.push(r),i}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){typeof console<"u"&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Zr(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}function Ue(){}const ei=1e3,ti=2,ni=144e5,ri=.5;function Ct(e,t=ei,n=2){const r=t*Math.pow(n,e),i=Math.round(ri*r*(Math.random()-.5)*2);return Math.min(ni,r+i)}function q(e){return e&&e._delegate?e._delegate:e}class b{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const B="[DEFAULT]";class ii{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new jr;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),r=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(oi(e))try{this.getOrInitializeService({instanceIdentifier:B})}catch{}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch{}}}}clearInstance(e=B){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=B){return this.instances.has(e)}getOptions(e=B){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:si(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=B){return this.component?this.component.multipleInstances?e:B:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function si(e){return e===B?void 0:e}function oi(e){return"EAGER"===e.instantiationMode}class ai{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ii(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var f;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(f||(f={}));const ci={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},li=f.INFO,ui={[f.DEBUG]:"log",[f.VERBOSE]:"log",[f.INFO]:"info",[f.WARN]:"warn",[f.ERROR]:"error"},di=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=ui[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class it{constructor(e){this.name=e,this._logLevel=li,this._logHandler=di,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in f))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ci[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,f.DEBUG,...e),this._logHandler(this,f.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,f.VERBOSE,...e),this._logHandler(this,f.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,f.INFO,...e),this._logHandler(this,f.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,f.WARN,...e),this._logHandler(this,f.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,f.ERROR,...e),this._logHandler(this,f.ERROR,...e)}}const hi=(e,t)=>t.some((t=>e instanceof t));let Rt,Ot;function fi(){return Rt||(Rt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pi(){return Ot||(Ot=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yn=new WeakMap,ze=new WeakMap,wn=new WeakMap,Fe=new WeakMap,st=new WeakMap;function gi(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(F(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&yn.set(t,e)})).catch((()=>{})),st.set(t,e),t}function mi(e){if(ze.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));ze.set(e,t)}let qe={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ze.get(e);if("objectStoreNames"===t)return e.objectStoreNames||wn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return F(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function _i(e){qe=e(qe)}function vi(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?pi().includes(e)?function(...t){return e.apply(xe(this),t),F(yn.get(this))}:function(...t){return F(e.apply(xe(this),t))}:function(t,...n){const r=e.call(xe(this),t,...n);return wn.set(r,t.sort?t.sort():[t]),F(r)}}function Ii(e){return"function"==typeof e?vi(e):(e instanceof IDBTransaction&&mi(e),hi(e,fi())?new Proxy(e,qe):e)}function F(e){if(e instanceof IDBRequest)return gi(e);if(Fe.has(e))return Fe.get(e);const t=Ii(e);return t!==e&&(Fe.set(e,t),st.set(t,e)),t}const xe=e=>st.get(e);function bn(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(e,t),o=F(a);return r&&a.addEventListener("upgradeneeded",(e=>{r(F(a.result),e.oldVersion,e.newVersion,F(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const yi=["get","getKey","getAll","getAllKeys","count"],wi=["put","add","delete","clear"],$e=new Map;function Pt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if($e.get(t))return $e.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=wi.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!yi.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let a=s.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),i&&s.done]))[0]};return $e.set(t,s),s}_i((e=>({...e,get:(t,n,r)=>Pt(t,n)||e.get(t,n,r),has:(t,n)=>!!Pt(t,n)||e.has(t,n)})));class bi{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(Ti(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}function Ti(e){const t=e.getComponent();return"VERSION"===t?.type}const Ke="@firebase/app",Dt="0.10.16",C=new it("@firebase/app"),Ei="@firebase/app-compat",Si="@firebase/analytics-compat",Ai="@firebase/analytics",ki="@firebase/app-check-compat",Ci="@firebase/app-check",Ri="@firebase/auth",Oi="@firebase/auth-compat",Pi="@firebase/database",Di="@firebase/data-connect",Ni="@firebase/database-compat",Mi="@firebase/functions",Li="@firebase/functions-compat",Ui="@firebase/installations",Fi="@firebase/installations-compat",xi="@firebase/messaging",$i="@firebase/messaging-compat",Bi="@firebase/performance",ji="@firebase/performance-compat",Vi="@firebase/remote-config",Hi="@firebase/remote-config-compat",Wi="@firebase/storage",Gi="@firebase/storage-compat",zi="@firebase/firestore",qi="@firebase/vertexai",Ki="@firebase/firestore-compat",Ji="firebase",Yi="11.0.2",Je="[DEFAULT]",Xi={[Ke]:"fire-core",[Ei]:"fire-core-compat",[Ai]:"fire-analytics",[Si]:"fire-analytics-compat",[Ci]:"fire-app-check",[ki]:"fire-app-check-compat",[Ri]:"fire-auth",[Oi]:"fire-auth-compat",[Pi]:"fire-rtdb",[Di]:"fire-data-connect",[Ni]:"fire-rtdb-compat",[Mi]:"fire-fn",[Li]:"fire-fn-compat",[Ui]:"fire-iid",[Fi]:"fire-iid-compat",[xi]:"fire-fcm",[$i]:"fire-fcm-compat",[Bi]:"fire-perf",[ji]:"fire-perf-compat",[Vi]:"fire-rc",[Hi]:"fire-rc-compat",[Wi]:"fire-gcs",[Gi]:"fire-gcs-compat",[zi]:"fire-fst",[Ki]:"fire-fst-compat",[qi]:"fire-vertex","fire-js":"fire-js",[Ji]:"fire-js-all"},oe=new Map,Qi=new Map,Ye=new Map;function Nt(e,t){try{e.container.addComponent(t)}catch(n){C.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function R(e){const t=e.name;if(Ye.has(t))return C.debug(`There were multiple attempts to register component ${t}.`),!1;Ye.set(t,e);for(const t of oe.values())Nt(t,e);for(const t of Qi.values())Nt(t,e);return!0}function Ae(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function U(e){return void 0!==e.settings}const Zi={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},x=new z("app","Firebase",Zi);class es{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new b("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw x.create("app-deleted",{appName:this._name})}}const ue=Yi;function Tn(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:Je,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw x.create("bad-app-name",{appName:String(i)});if(n||(n=gn()),!n)throw x.create("no-options");const s=oe.get(i);if(s){if(Ie(n,s.options)&&Ie(r,s.config))return s;throw x.create("duplicate-app",{appName:i})}const a=new ai(i);for(const e of Ye.values())a.addComponent(e);const o=new es(n,r,a);return oe.set(i,o),o}function En(e=Je){const t=oe.get(e);if(!t&&e===Je&&gn())return Tn();if(!t)throw x.create("no-app",{appName:e});return t}function ts(){return Array.from(oe.values())}function I(e,t,n){var r;let i=null!==(r=Xi[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void C.warn(e.join(" "))}R(new b(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const ns="firebase-heartbeat-database",rs=1,ae="firebase-heartbeat-store";let Be=null;function Sn(){return Be||(Be=bn(ns,1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ae)}catch(e){console.warn(e)}}}).catch((e=>{throw x.create("idb-open",{originalErrorMessage:e.message})}))),Be}async function is(e){try{const t=(await Sn()).transaction(ae),n=await t.objectStore(ae).get(An(e));return await t.done,n}catch(e){if(e instanceof T)C.warn(e.message);else{const t=x.create("idb-get",{originalErrorMessage:e?.message});C.warn(t.message)}}}async function Mt(e,t){try{const n=(await Sn()).transaction(ae,"readwrite");await n.objectStore(ae).put(t,An(e)),await n.done}catch(e){if(e instanceof T)C.warn(e.message);else{const t=x.create("idb-set",{originalErrorMessage:e?.message});C.warn(t.message)}}}function An(e){return`${e.name}!${e.options.appId}`}const ss=1024,os=2592e6;class as{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ls(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Lt();return null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r))?void 0:(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=os})),this._storage.overwrite(this._heartbeatsCache))}catch(e){C.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Lt(),{heartbeatsToSend:n,unsentEntries:r}=cs(this._heartbeatsCache.heartbeats),i=fn(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return C.warn(e),""}}}function Lt(){return(new Date).toISOString().substring(0,10)}function cs(e,t=ss){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Ut(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ut(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class ls{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!vn()&&In().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await is(this.app);return e?.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Mt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Mt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ut(e){return fn(JSON.stringify({version:2,heartbeats:e})).length}function us(e){R(new b("platform-logger",(e=>new bi(e)),"PRIVATE")),R(new b("heartbeat",(e=>new as(e)),"PRIVATE")),I(Ke,Dt,e),I(Ke,Dt,"esm2017"),I("fire-js","")}us("");var Xe=function(e,t){return(Xe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function jc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Xe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function ot(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Vc(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hc(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a}function Wc(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function kn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ds=kn,Cn=new z("auth","Firebase",kn()),ye=new it("@firebase/auth");function hs(e,...t){ye.logLevel<=f.WARN&&ye.warn(`Auth (${ue}): ${e}`,...t)}function ge(e,...t){ye.logLevel<=f.ERROR&&ye.error(`Auth (${ue}): ${e}`,...t)}function O(e,...t){throw at(e,...t)}function y(e,...t){return at(e,...t)}function Rn(e,t,n){const r=Object.assign(Object.assign({},ds()),{[t]:n});return new z("auth","Firebase",r).create(t,{appName:e.name})}function V(e){return Rn(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function at(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Cn.create(e,...t)}function u(e,t,...n){if(!e)throw at(t,...n)}function S(e){const t="INTERNAL ASSERTION FAILED: "+e;throw ge(t),new Error(t)}function P(e,t){e||S(t)}function Qe(){var e;return typeof self<"u"&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function fs(){return"http:"===Ft()||"https:"===Ft()}function Ft(){var e;return typeof self<"u"&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function ps(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(fs()||_n()||"connection"in navigator))||navigator.onLine}function gs(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}class de{constructor(e,t){this.shortDelay=e,this.longDelay=t,P(t>e,"Short delay should be less than long delay!"),this.isMobile=Vr()||Wr()}get(){return ps()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ct(e,t){P(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class On{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void S("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void S("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void S("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ms={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},_s=new de(3e4,6e4);function lt(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function te(e,t,n,r,i={}){return Pn(e,i,(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const a=le(Object.assign({key:e.config.apiKey},s)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:o},i);return Hr()||(c.referrerPolicy="no-referrer"),On.fetch()(Dn(e,e.config.apiHost,n,a),c)}))}async function Pn(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},ms),t);try{const t=new Is(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw pe(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw pe(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw pe(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw pe(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw Rn(e,o,a);O(e,o)}}catch(t){if(t instanceof T)throw t;O(e,"network-request-failed",{message:String(t)})}}async function vs(e,t,n,r,i={}){const s=await te(e,t,n,r,i);return"mfaPendingCredential"in s&&O(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Dn(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?ct(e.config,i):`${e.config.apiScheme}://${i}`}class Is{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(y(this.auth,"network-request-failed"))),_s.get())}))}}function pe(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=y(e,t,r);return i.customData._tokenResponse=n,i}async function ys(e,t){return te(e,"POST","/v1/accounts:delete",t)}async function Nn(e,t){return te(e,"POST","/v1/accounts:lookup",t)}function ie(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function ws(e,t=!1){const n=q(e),r=await n.getIdToken(t),i=ut(r);u(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:ie(je(i.auth_time)),issuedAtTime:ie(je(i.iat)),expirationTime:ie(je(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function je(e){return 1e3*Number(e)}function ut(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return ge("JWT malformed, contained fewer than 3 sections"),null;try{const e=pn(n);return e?JSON.parse(e):(ge("Failed to decode base64 JWT payload"),null)}catch(e){return ge("Caught error parsing JWT payload as JSON",e?.toString()),null}}function xt(e){const t=ut(e);return u(t,"internal-error"),u(typeof t.exp<"u","internal-error"),u(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function ce(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof T&&bs(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}function bs({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class Ts{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&this.schedule(!0))}this.schedule()}}class Ze{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ie(this.lastLoginAt),this.creationTime=ie(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function we(e){var t;const n=e.auth,r=await e.getIdToken(),i=await ce(e,Nn(n,{idToken:r}));u(i?.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=null!==(t=s.providerUserInfo)&&void 0!==t&&t.length?Mn(s.providerUserInfo):[],o=Ss(e.providerData,a),c=e.isAnonymous,l=!(e.email&&s.passwordHash||o?.length),h=!!c&&l,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ze(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,d)}async function Es(e){const t=q(e);await we(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function Ss(e,t){return[...e.filter((e=>!t.some((t=>t.providerId===e.providerId)))),...t]}function Mn(e){return e.map((e=>{var{providerId:t}=e,n=ot(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}async function As(e,t){const n=await Pn(e,{},(async()=>{const n=le({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Dn(e,r,"/v1/token",`key=${i}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",On.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function ks(e,t){return te(e,"POST","/v2/accounts:revokeToken",lt(e,t))}class Y{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){u(e.idToken,"internal-error"),u(typeof e.idToken<"u","internal-error"),u(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xt(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){u(0!==e.length,"internal-error");const t=xt(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(u(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await As(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Y;return n&&(u("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(u("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(u("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Y,this.toJSON())}_performRefresh(){return S("not implemented")}}function D(e,t){u("string"==typeof e||typeof e>"u","internal-error",{appName:t})}class A{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=ot(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ts(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ze(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ce(this,this.stsTokenManager.getToken(this.auth,e));return u(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ws(this,e)}reload(){return Es(this)}_assign(e){this!==e&&(u(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new A(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){u(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await we(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(U(this.auth.app))return Promise.reject(V(this.auth));const e=await this.getIdToken();return await ce(this,ys(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,a,o,c,l;const h=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,p=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,g=null!==(a=t.tenantId)&&void 0!==a?a:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,v=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:w,emailVerified:I,isAnonymous:_,providerData:b,stsTokenManager:T}=t;u(w&&T,e,"internal-error");const S=Y.fromJSON(this.name,T);u("string"==typeof w,e,"internal-error"),D(h,e.name),D(d,e.name),u("boolean"==typeof I,e,"internal-error"),u("boolean"==typeof _,e,"internal-error"),D(p,e.name),D(f,e.name),D(g,e.name),D(m,e.name),D(v,e.name),D(y,e.name);const E=new A({uid:w,auth:e,email:d,emailVerified:I,displayName:h,isAnonymous:_,photoURL:f,phoneNumber:p,tenantId:g,stsTokenManager:S,createdAt:v,lastLoginAt:y});return b&&Array.isArray(b)&&(E.providerData=b.map((e=>Object.assign({},e)))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t,n=!1){const r=new Y;r.updateFromServerResponse(t);const i=new A({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await we(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];u(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Mn(r.providerUserInfo):[],s=!(r.email&&r.passwordHash||i?.length),a=new Y;a.updateFromIdToken(n);const o=new A({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Ze(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||i?.length)};return Object.assign(o,c),o}}const $t=new Map;function k(e){P(e instanceof Function,"Expected a class definition");let t=$t.get(e);return t?(P(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,$t.set(e,t),t)}class Ln{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ln.type="NONE";const Bt=Ln;function me(e,t,n){return`firebase:${e}:${t}:${n}`}class X{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=me(this.userKey,r.apiKey,i),this.fullPersistenceKey=me("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?A._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new X(k(Bt),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||k(Bt);const s=me(n,e.config.apiKey,e.name);let a=null;for(const n of t)try{const t=await n._get(s);if(t){const r=A._fromJSON(e,t);n!==i&&(a=r),i=n;break}}catch{}const o=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&o.length?(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch{}}))),new X(i,e,n)):new X(i,e,n)}}function jt(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if($n(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Un(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(jn(t))return"Blackberry";if(Vn(t))return"Webos";if(Fn(t))return"Safari";if((t.includes("chrome/")||xn(t))&&!t.includes("edge/"))return"Chrome";if(Bn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function Un(e=m()){return/firefox\//i.test(e)}function Fn(e=m()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function xn(e=m()){return/crios\//i.test(e)}function $n(e=m()){return/iemobile/i.test(e)}function Bn(e=m()){return/android/i.test(e)}function jn(e=m()){return/blackberry/i.test(e)}function Vn(e=m()){return/webos/i.test(e)}function dt(e=m()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Cs(e=m()){var t;return dt(e)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}function Rs(){return Gr()&&10===document.documentMode}function Hn(e=m()){return dt(e)||Bn(e)||Vn(e)||jn(e)||/windows phone/i.test(e)||$n(e)}function Wn(e,t=[]){let n;switch(e){case"Browser":n=jt(m());break;case"Worker":n=`${jt(m())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${ue}/${r}`}class Os{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}}async function Ps(e,t={}){return te(e,"GET","/v2/passwordPolicy",lt(e,t))}const Ds=6;class Ns{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Ms{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Vt(this),this.idTokenSubscription=new Vt(this),this.beforeStateQueue=new Os(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Cn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=k(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await X.create(this,e),!this._deleted)){if(null!==(n=this._popupRedirectResolver)&&void 0!==n&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid)return this._currentUser._assign(e),void await this.currentUser.getIdToken();await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Nn(this,{idToken:e}),n=await A._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(U(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!n||n===s)&&a?.user&&(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return u(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await we(e)}catch(e){if("auth/network-request-failed"!==e?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gs()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(U(this.app))return Promise.reject(V(this));const t=e?q(e):null;return t&&u(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&u(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return U(this.app)?Promise.reject(V(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return U(this.app)?Promise.reject(V(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(k(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ps(this),t=new Ns(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new z("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await ks(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&k(e)||this._popupRedirectResolver;u(t,this,"argument-error"),this.redirectPersistenceManager=await X.create(this,[k(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(u(a,this,"internal-error"),a.then((()=>{s||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return u(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Wn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return t?.error&&hs(`Error while retrieving App Check token: ${t.error}`),t?.token}}function ke(e){return q(e)}class Vt{constructor(e){this.auth=e,this.observer=null,this.addObserver=Xr((e=>this.observer=e))}get next(){return u(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ht={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ls(e){ht=e}function Us(e){return ht.loadJS(e)}function Fs(){return ht.gapiScript}function xs(e){return`__${e}${Math.floor(1e6*Math.random())}`}function $s(e,t){const n=Ae(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Ie(n.getOptions(),t??{}))return e;O(e,"already-initialized")}return n.initialize({options:t})}function Bs(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(k);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}function js(e,t,n){const r=ke(e);u(r._canInitEmulator,r,"emulator-config-failed"),u(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=Gn(t),{host:s,port:a}=Vs(t),o=null===a?"":`:${a}`;r.config.emulator={url:`${i}//${s}${o}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:!1})}),Hs()}function Gn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Vs(e){const t=Gn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Ht(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Ht(t)}}}function Ht(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function Hs(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}class zn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return S("not implemented")}_getIdTokenResponse(e){return S("not implemented")}_linkToIdToken(e,t){return S("not implemented")}_getReauthenticationResolver(e){return S("not implemented")}}async function Q(e,t){return vs(e,"POST","/v1/accounts:signInWithIdp",lt(e,t))}const Ws="http://localhost";class H extends zn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new H(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):O("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=ot(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new H(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Q(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Q(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Q(e,t)}buildRequest(){const e={requestUri:Ws,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=le(t)}return e}}class qn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class he extends qn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class N extends he{constructor(){super("facebook.com")}static credential(e){return H._fromParams({providerId:N.PROVIDER_ID,signInMethod:N.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return N.credentialFromTaggedObject(e)}static credentialFromError(e){return N.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return N.credential(e.oauthAccessToken)}catch{return null}}}N.FACEBOOK_SIGN_IN_METHOD="facebook.com",N.PROVIDER_ID="facebook.com";class E extends he{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return H._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return E.credentialFromTaggedObject(e)}static credentialFromError(e){return E.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return E.credential(t,n)}catch{return null}}}E.GOOGLE_SIGN_IN_METHOD="google.com",E.PROVIDER_ID="google.com";class M extends he{constructor(){super("github.com")}static credential(e){return H._fromParams({providerId:M.PROVIDER_ID,signInMethod:M.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return M.credentialFromTaggedObject(e)}static credentialFromError(e){return M.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return M.credential(e.oauthAccessToken)}catch{return null}}}M.GITHUB_SIGN_IN_METHOD="github.com",M.PROVIDER_ID="github.com";class L extends he{constructor(){super("twitter.com")}static credential(e,t){return H._fromParams({providerId:L.PROVIDER_ID,signInMethod:L.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return L.credentialFromTaggedObject(e)}static credentialFromError(e){return L.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return L.credential(t,n)}catch{return null}}}L.TWITTER_SIGN_IN_METHOD="twitter.com",L.PROVIDER_ID="twitter.com";class ee{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await A._fromIdTokenResponse(e,n,r),s=Wt(n);return new ee({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Wt(n);return new ee({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Wt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class be extends T{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,be.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new be(e,t,n,r)}}function Kn(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{throw"auth/multi-factor-auth-required"===n.code?be._fromErrorAndOperation(e,n,t,r):n}))}async function Gs(e,t,n=!1){const r=await ce(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ee._forOperation(e,"link",r)}async function zs(e,t,n=!1){const{auth:r}=e;if(U(r.app))return Promise.reject(V(r));const i="reauthenticate";try{const s=await ce(e,Kn(r,i,t,e),n);u(s.idToken,r,"internal-error");const a=ut(s.idToken);u(a,r,"internal-error");const{sub:o}=a;return u(e.uid===o,r,"user-mismatch"),ee._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===e?.code&&O(r,"user-mismatch"),e}}async function Jn(e,t,n=!1){if(U(e.app))return Promise.reject(V(e));const r="signIn",i=await Kn(e,r,t),s=await ee._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function qs(e,t){return Jn(ke(e),t)}function Ks(e,t,n,r){return q(e).onIdTokenChanged(t,n,r)}function Js(e,t,n){return q(e).beforeAuthStateChanged(t,n)}const Te="__sak";class Yn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Te,"1"),this.storage.removeItem(Te),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Ys=1e3,Xs=10;class Xn extends Yn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Hn(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);!t&&this.localCache[n]===e||this.notifyListeners(n,e)},i=this.storage.getItem(n);Rs()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),Ys)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Xn.type="LOCAL";const Qs=Xn;class Qn extends Yn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Qn.type="SESSION";const Zn=Qn;function Zs(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}class Ce{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Ce(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!s?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(s).map((async e=>e(t.origin,i))),o=await Zs(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ft(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Ce.receivers=[];class eo{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((a,o)=>{const c=ft("",20);r.port1.start();const l=setTimeout((()=>{o(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),i=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),a(t.data.response);break;default:clearTimeout(l),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function w(){return window}function to(e){w().location.href=e}function er(){return typeof w().WorkerGlobalScope<"u"&&"function"==typeof w().importScripts}async function no(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ro(){var e;return(null===(e=navigator?.serviceWorker)||void 0===e?void 0:e.controller)||null}function io(){return er()?self:null}const tr="firebaseLocalStorageDb",so=1,Ee="firebaseLocalStorage",nr="fbase_key";class fe{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Re(e,t){return e.transaction([Ee],t?"readwrite":"readonly").objectStore(Ee)}function oo(){const e=indexedDB.deleteDatabase(tr);return new fe(e).toPromise()}function et(){const e=indexedDB.open(tr,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Ee,{keyPath:nr})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Ee)?t(n):(n.close(),await oo(),t(await et()))}))}))}async function Gt(e,t,n){const r=Re(e,!0).put({[nr]:t,value:n});return new fe(r).toPromise()}async function ao(e,t){const n=Re(e,!1).get(t),r=await new fe(n).toPromise();return void 0===r?null:r.value}function zt(e,t){const n=Re(e,!0).delete(t);return new fe(n).toPromise()}const co=800,lo=3;class rr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await et()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return er()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ce._getInstance(io()),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await no(),!this.activeServiceWorker)return;this.sender=new eo(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&ro()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await et();return await Gt(e,Te,"1"),await zt(e,Te),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Gt(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>ao(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>zt(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Re(e,!1).getAll();return new fe(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),co)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}rr.type="LOCAL";const uo=rr;function ho(e,t){return t?k(t):(u(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}new de(3e4,6e4);class pt extends zn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Q(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Q(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Q(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function fo(e){return Jn(e.auth,new pt(e),e.bypassAuthState)}function po(e){const{auth:t,user:n}=e;return u(n,t,"internal-error"),zs(n,new pt(e),e.bypassAuthState)}async function go(e){const{auth:t,user:n}=e;return u(n,t,"internal-error"),Gs(n,new pt(e),e.bypassAuthState)}class ir{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fo;case"linkViaPopup":case"linkViaRedirect":return go;case"reauthViaPopup":case"reauthViaRedirect":return po;default:O(this.auth,"internal-error")}}resolve(e){P(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){P(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const mo=new de(2e3,1e4);class J extends ir{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,J.currentPopupAction&&J.currentPopupAction.cancel(),J.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return u(e,this.auth,"internal-error"),e}async onExecution(){P(1===this.filter.length,"Popup operations only handle one event");const e=ft();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(y(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(y(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,J.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;null!==(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)&&void 0!==n&&n.closed?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(y(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,mo.get())};e()}}J.currentPopupAction=null;const _o="pendingRedirect",_e=new Map;class vo extends ir{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=_e.get(this.auth._key());if(!e){try{const t=await Io(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}_e.set(this.auth._key(),e)}return this.bypassAuthState||_e.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function Io(e,t){const n=bo(t),r=wo(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}function yo(e,t){_e.set(e._key(),t)}function wo(e){return k(e._redirectPersistence)}function bo(e){return me(_o,e.config.apiKey,e.name)}async function To(e,t,n=!1){if(U(e.app))return Promise.reject(V(e));const r=ke(e),i=ho(r,t),s=await new vo(r,i,n).execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}const Eo=6e5;class So{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!Ao(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!sr(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(y(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Eo&&this.cachedEventUids.clear(),this.cachedEventUids.has(qt(e))}saveEventToCache(e){this.cachedEventUids.add(qt(e)),this.lastProcessedEventTime=Date.now()}}function qt(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function sr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===t?.code}function Ao(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sr(e);default:return!1}}async function ko(e,t={}){return te(e,"GET","/v1/projects",t)}const Co=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ro=/^https?/;async function Oo(e){if(e.config.emulator)return;const{authorizedDomains:t}=await ko(e);for(const e of t)try{if(Po(e))return}catch{}O(e,"unauthorized-domain")}function Po(e){const t=Qe(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Ro.test(n))return!1;if(Co.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Do=new de(3e4,6e4);function Kt(){const e=w().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function No(e){return new Promise(((t,n)=>{var r,i,s;function a(){Kt(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Kt(),n(y(e,"network-request-failed"))},timeout:Do.get()})}if(null!==(i=null===(r=w().gapi)||void 0===r?void 0:r.iframes)&&void 0!==i&&i.Iframe)t(gapi.iframes.getContext());else{if(null===(s=w().gapi)||void 0===s||!s.load){const t=xs("iframefcb");return w()[t]=()=>{gapi.load?a():n(y(e,"network-request-failed"))},Us(`${Fs()}?onload=${t}`).catch((e=>n(e)))}a()}})).catch((e=>{throw ve=null,e}))}let ve=null;function Mo(e){return ve=ve||No(e),ve}const Lo=new de(5e3,15e3),Uo="__/auth/iframe",Fo="emulator/auth/iframe",xo={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$o=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Bo(e){const t=e.config;u(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?ct(t,Fo):`https://${e.config.authDomain}/${Uo}`,r={apiKey:t.apiKey,appName:e.name,v:ue},i=$o.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${le(r).slice(1)}`}async function jo(e){const t=await Mo(e),n=w().gapi;return u(n,e,"internal-error"),t.open({where:document.body,url:Bo(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xo,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=y(e,"network-request-failed"),s=w().setTimeout((()=>{r(i)}),Lo.get());function a(){w().clearTimeout(s),n(t)}t.ping(a).then(a,(()=>{r(i)}))}))))}const Vo={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ho=500,Wo=600,Go="_blank",zo="http://localhost";class Jt{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qo(e,t,n,r=Ho,i=Wo){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const c=Object.assign(Object.assign({},Vo),{width:r.toString(),height:i.toString(),top:s,left:a}),l=m().toLowerCase();n&&(o=xn(l)?Go:n),Un(l)&&(t=t||zo,c.scrollbars="yes");const h=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(Cs(l)&&"_self"!==o)return Ko(t||"",o),new Jt(null);const d=window.open(t||"",o,h);u(d,e,"popup-blocked");try{d.focus()}catch{}return new Jt(d)}function Ko(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const Jo="__/auth/handler",Yo="emulator/auth/handler",Xo=encodeURIComponent("fac");async function Yt(e,t,n,r,i,s){u(e.config.authDomain,e,"auth-domain-config-required"),u(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:ue,eventId:i};if(t instanceof qn){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",Yr(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))a[e]=t}if(t instanceof he){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const e of Object.keys(o))void 0===o[e]&&delete o[e];const c=await e._getAppCheckToken(),l=c?`#${Xo}=${encodeURIComponent(c)}`:"";return`${Qo(e)}?${le(o).slice(1)}${l}`}function Qo({config:e}){return e.emulator?ct(e,Yo):`https://${e.authDomain}/${Jo}`}const Ve="webStorageSupport";class Zo{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zn,this._completeRedirectFn=To,this._overrideRedirectResult=yo}async _openPopup(e,t,n,r){var i;P(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return qo(e,await Yt(e,t,n,Qe(),r),ft())}async _openRedirect(e,t,n,r){await this._originValidation(e);return to(await Yt(e,t,n,Qe(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(P(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await jo(e),n=new So(e);return t.register("authEvent",(t=>(u(t?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ve,{type:Ve},(n=>{var r;const i=null===(r=n?.[0])||void 0===r?void 0:r[Ve];void 0!==i&&t(!!i),O(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Oo(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Hn()||Fn()||dt()}}const ea=Zo;var Xt="@firebase/auth",Qt="1.8.1";class ta{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e(t?.stsTokenManager.accessToken||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){u(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function na(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ra(e){R(new b("auth",((t,{options:n})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;u(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wn(e)},l=new Ms(r,i,s,c);return Bs(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),R(new b("auth-internal",(e=>{const t=ke(e.getProvider("auth").getImmediate());return new ta(t)}),"PRIVATE").setInstantiationMode("EXPLICIT")),I(Xt,Qt,na(e)),I(Xt,Qt,"esm2017")}const ia=300,sa=mn("authIdTokenMaxAge")||ia;let Zt=null;const oa=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>sa)return;const i=n?.token;Zt!==i&&(Zt=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function aa(e=En()){const t=Ae(e,"auth");if(t.isInitialized())return t.getImmediate();const n=$s(e,{popupRedirectResolver:ea,persistence:[uo,Qs,Zn]}),r=mn("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=oa(e.toString());Js(n,t,(()=>t(n.currentUser))),Ks(n,(e=>t(e)))}}const i=Br("auth");return i&&js(n,`http://${i}`),n}function ca(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}Ls({loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=y("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",ca().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),ra("Browser");const la="AIzaSyCsDxFn6CQU9WPvlfHg_Gx80dPd9Z7-h2A",ua="tera-research-lab-6952e.firebaseapp.com",da="tera-research-lab-6952e",ha="tera-research-lab-6952e.appspot.com",fa="440702260673",pa="1:440702260673:web:3489bd92ac7d82de48cb40",ga="G-47EDKP6RQ2",ma={apiKey:la,authDomain:ua,projectId:da,storageBucket:ha,messagingSenderId:fa,appId:pa,measurementId:ga},or="@firebase/installations",gt="0.6.11",ar=1e4,cr=`w:${gt}`,lr="FIS_v2",_a="https://firebaseinstallations.googleapis.com/v1",va=36e5,Ia="installations",ya="Installations",wa={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},W=new z(Ia,ya,wa);function ur(e){return e instanceof T&&e.code.includes("request-failed")}function dr({projectId:e}){return`${_a}/projects/${e}/installations`}function hr(e){return{token:e.token,requestStatus:2,expiresIn:Ta(e.expiresIn),creationTime:Date.now()}}async function fr(e,t){const n=(await t.json()).error;return W.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function pr({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function ba(e,{refreshToken:t}){const n=pr(e);return n.append("Authorization",Ea(t)),n}async function gr(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Ta(e){return Number(e.replace("s","000"))}function Ea(e){return`${lr} ${e}`}async function Sa({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=dr(e),i=pr(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const a={fid:n,authVersion:lr,appId:e.appId,sdkVersion:cr},o={method:"POST",headers:i,body:JSON.stringify(a)},c=await gr((()=>fetch(r,o)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:hr(e.authToken)}}throw await fr("Create Installation",c)}function mr(e){return new Promise((t=>{setTimeout(t,e)}))}function Aa(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}const ka=/^[cdef][\w-]{21}$/,tt="";function Ca(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=Ra(e);return ka.test(t)?t:""}catch{return""}}function Ra(e){return Aa(e).substr(0,22)}function Oe(e){return`${e.appName}!${e.appId}`}const _r=new Map;function vr(e,t){const n=Oe(e);Ir(n,t),Oa(n,t)}function Ir(e,t){const n=_r.get(e);if(n)for(const e of n)e(t)}function Oa(e,t){const n=Pa();n&&n.postMessage({key:e,fid:t}),Da()}let j=null;function Pa(){return!j&&"BroadcastChannel"in self&&(j=new BroadcastChannel("[Firebase] FID Change"),j.onmessage=e=>{Ir(e.data.key,e.data.fid)}),j}function Da(){0===_r.size&&j&&(j.close(),j=null)}const Na="firebase-installations-database",Ma=1,G="firebase-installations-store";let He=null;function mt(){return He||(He=bn(Na,1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(G)}})),He}async function Se(e,t){const n=Oe(e),r=(await mt()).transaction(G,"readwrite"),i=r.objectStore(G),s=await i.get(n);return await i.put(t,n),await r.done,(!s||s.fid!==t.fid)&&vr(e,t.fid),t}async function yr(e){const t=Oe(e),n=(await mt()).transaction(G,"readwrite");await n.objectStore(G).delete(t),await n.done}async function Pe(e,t){const n=Oe(e),r=(await mt()).transaction(G,"readwrite"),i=r.objectStore(G),s=await i.get(n),a=t(s);return void 0===a?await i.delete(n):await i.put(a,n),await r.done,a&&(!s||s.fid!==a.fid)&&vr(e,a.fid),a}async function _t(e){let t;const n=await Pe(e.appConfig,(n=>{const r=La(n),i=Ua(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}function La(e){return wr(e||{fid:Ca(),registrationStatus:0})}function Ua(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(W.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:Fa(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:xa(e)}:{installationEntry:t}}async function Fa(e,t){try{const n=await Sa(e,t);return Se(e.appConfig,n)}catch(n){throw ur(n)&&409===n.customData.serverCode?await yr(e.appConfig):await Se(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}async function xa(e){let t=await en(e.appConfig);for(;1===t.registrationStatus;)await mr(100),t=await en(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await _t(e);return n||t}return t}function en(e){return Pe(e,(e=>{if(!e)throw W.create("installation-not-found");return wr(e)}))}function wr(e){return $a(e)?{fid:e.fid,registrationStatus:0}:e}function $a(e){return 1===e.registrationStatus&&e.registrationTime+ar<Date.now()}async function Ba({appConfig:e,heartbeatServiceProvider:t},n){const r=ja(e,n),i=ba(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const a={installation:{sdkVersion:cr,appId:e.appId}},o={method:"POST",headers:i,body:JSON.stringify(a)},c=await gr((()=>fetch(r,o)));if(c.ok){return hr(await c.json())}throw await fr("Generate Auth Token",c)}function ja(e,{fid:t}){return`${dr(e)}/${t}/authTokens:generate`}async function vt(e,t=!1){let n;const r=await Pe(e.appConfig,(r=>{if(!br(r))throw W.create("not-registered");const i=r.authToken;if(!t&&Wa(i))return r;if(1===i.requestStatus)return n=Va(e,t),r;{if(!navigator.onLine)throw W.create("app-offline");const t=za(r);return n=Ha(e,t),t}}));return n?await n:r.authToken}async function Va(e,t){let n=await tn(e.appConfig);for(;1===n.authToken.requestStatus;)await mr(100),n=await tn(e.appConfig);const r=n.authToken;return 0===r.requestStatus?vt(e,t):r}function tn(e){return Pe(e,(e=>{if(!br(e))throw W.create("not-registered");return qa(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e}))}async function Ha(e,t){try{const n=await Ba(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await Se(e.appConfig,r),n}catch(n){if(!ur(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Se(e.appConfig,n)}else await yr(e.appConfig);throw n}}function br(e){return void 0!==e&&2===e.registrationStatus}function Wa(e){return 2===e.requestStatus&&!Ga(e)}function Ga(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+va}function za(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function qa(e){return 1===e.requestStatus&&e.requestTime+ar<Date.now()}async function Ka(e){const t=e,{installationEntry:n,registrationPromise:r}=await _t(t);return r?r.catch(console.error):vt(t).catch(console.error),n.fid}async function Ja(e,t=!1){const n=e;return await Ya(n),(await vt(n,t)).token}async function Ya(e){const{registrationPromise:t}=await _t(e);t&&await t}function Xa(e){if(!e||!e.options)throw We("App Configuration");if(!e.name)throw We("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw We(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function We(e){return W.create("missing-app-config-values",{valueName:e})}const Tr="installations",Qa="installations-internal",Za=e=>{const t=e.getProvider("app").getImmediate();return{app:t,appConfig:Xa(t),heartbeatServiceProvider:Ae(t,"heartbeat"),_delete:()=>Promise.resolve()}},ec=e=>{const t=Ae(e.getProvider("app").getImmediate(),Tr).getImmediate();return{getId:()=>Ka(t),getToken:e=>Ja(t,e)}};function tc(){R(new b(Tr,Za,"PUBLIC")),R(new b(Qa,ec,"PRIVATE"))}tc(),I(or,gt),I(or,gt,"esm2017");const nn="analytics",nc="firebase_id",rc="origin",ic=6e4,sc="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",It="https://www.googletagmanager.com/gtag/js",_=new it("@firebase/analytics"),oc={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},v=new z("analytics","Analytics",oc);function ac(e){if(!e.startsWith(It)){const t=v.create("invalid-gtag-resource",{gtagURL:e});return _.warn(t.message),""}return e}function Er(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function cc(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}function lc(e,t){const n=cc("firebase-js-sdk-policy",{createScriptURL:ac}),r=document.createElement("script"),i=`${It}?l=${e}&id=${t}`;r.src=n?n?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function uc(e){let t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}async function dc(e,t,n,r,i,s){const a=r[i];try{if(a)await t[a];else{const e=(await Er(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){_.error(e)}e("config",i,s)}async function hc(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await Er(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){_.error(e)}}function fc(e,t,n,r){return async function(i,...s){try{if("event"===i){const[r,i]=s;await hc(e,t,n,r,i)}else if("config"===i){const[i,a]=s;await dc(e,t,n,r,i,a)}else if("consent"===i){const[t,n]=s;e("consent",t,n)}else if("get"===i){const[t,n,r]=s;e("get",t,n,r)}else if("set"===i){const[t]=s;e("set",t)}else e(i,...s)}catch(e){_.error(e)}}}function pc(e,t,n,r,i){let s=function(...e){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=fc(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}function gc(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(It)&&n.src.includes(e))return n;return null}const mc=30,_c=1e3;class vc{constructor(e={},t=_c){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Sr=new vc;function Ic(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function yc(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:Ic(r)},s=sc.replace("{app-id}",n),a=await fetch(s,i);if(200!==a.status&&304!==a.status){let e="";try{const n=await a.json();null!==(t=n.error)&&void 0!==t&&t.message&&(e=n.error.message)}catch{}throw v.create("config-fetch-failed",{httpStatus:a.status,responseMessage:e})}return a.json()}async function wc(e,t=Sr,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw v.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw v.create("no-api-key")}const a=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Ec;return setTimeout((async()=>{o.abort()}),ic),Ar({appId:r,apiKey:i,measurementId:s},a,o,t)}async function Ar(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=Sr){var s;const{appId:a,measurementId:o}=e;try{await bc(r,t)}catch(e){if(o)return _.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e?.message}]`),{appId:a,measurementId:o};throw e}try{const t=await yc(e);return i.deleteThrottleMetadata(a),t}catch(t){const c=t;if(!Tc(c)){if(i.deleteThrottleMetadata(a),o)return _.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:a,measurementId:o};throw t}const l=503===Number(null===(s=c?.customData)||void 0===s?void 0:s.httpStatus)?Ct(n,i.intervalMillis,30):Ct(n,i.intervalMillis),u={throttleEndTimeMillis:Date.now()+l,backoffCount:n+1};return i.setThrottleMetadata(a,u),_.debug(`Calling attemptFetch again in ${l} millis`),Ar(e,u,r,i)}}function bc(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(v.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}function Tc(e){if(!(e instanceof T&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}class Ec{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}async function Sc(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}async function Ac(){if(!vn())return _.warn(v.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await In()}catch(e){return _.warn(v.create("indexeddb-unavailable",{errorInfo:e?.toString()}).message),!1}return!0}async function kc(e,t,n,r,i,s,a){var o;const c=wc(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&_.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>_.error(e))),t.push(c);const l=Ac().then((e=>{if(e)return r.getId()})),[u,h]=await Promise.all([c,l]);gc(s)||lc(s,u.measurementId),i("js",new Date);const d=null!==(o=a?.config)&&void 0!==o?o:{};return d[rc]="firebase",d.update=!0,null!=h&&(d[nc]=h),i("config",u.measurementId,d),u.measurementId}class Cc{constructor(e){this.app=e}_delete(){return delete se[this.app.options.appId],Promise.resolve()}}let se={},rn=[];const sn={};let on,kr,Ge="dataLayer",Rc="gtag",an=!1;function Oc(){const e=[];if(_n()&&e.push("This is a browser extension environment."),zr()||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=v.create("invalid-analytics-context",{errorInfo:t});_.warn(n.message)}}function Pc(e,t,n){Oc();const r=e.options.appId;if(!r)throw v.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw v.create("no-api-key");_.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=se[r])throw v.create("already-exists",{id:r});if(!an){uc(Ge);const{wrappedGtag:e,gtagCore:t}=pc(se,rn,sn,Ge,Rc);kr=e,on=t,an=!0}return se[r]=kc(e,rn,sn,t,on,Ge,n),new Cc(e)}function Dc(e,t,n,r){e=q(e),Sc(kr,se[e.app.options.appId],t,n,r).catch((e=>_.error(e)))}const cn="@firebase/analytics",ln="0.10.10";function Nc(){R(new b(nn,((e,{options:t})=>Pc(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),R(new b("analytics-internal",(function(e){try{const t=e.getProvider(nn).getImmediate();return{logEvent:(e,n,r)=>Dc(t,e,n,r)}}catch(e){throw v.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),I(cn,ln),I(cn,ln,"esm2017")}Nc();var Mc="firebase",Lc="11.0.2";I(Mc,Lc,"app");const Uc=ma,Fc=ts.length>0?En():Tn(Uc);class xc{info(e,...t){console.log(e,...t)}log(e,...t){console.log(e,...t)}error(...e){console.error(e)}}const $=new xc;class Z{static instance=null;static AUTH_INFO_KEY="auth-info";static TOKEN_KEY="token";static SESSION_KEY="session";static USER_KEY="user";apiService=re.getInstance();baseUrl;constructor(){this.baseUrl="/auth";let e=nt();ne.setKey("session",e),ne.setKey("status",e?"authenticated":"unauthenticated"),console.log("authStore set value",ne.get())}get isAuthenticated(){return"authenticated"===ne.get()?.status||"unauthenticated"!==ne.get()?.status&&!!nt()}static getInstance(){return null==Z.instance&&(Z.instance=new Z),this.instance}async logout({reload:e=!0}){localStorage?.clear(),location?.reload&&e&&location.reload()}async getFirebaseUserIdToken(e){const t=aa(Fc),n=E.credential(e);return await qs(t,n),t.currentUser?.getIdToken()}async signInWithEmailAndPassword({username:e,password:t},n){try{const r=await un("credentials",{username:e,password:t});$.log("signInResponse: ",r),r.ok?n?location.href=n:location.reload():$.error("Sign in with username password got error: ",r.status,r.statusText)}catch(n){$.error("Sign In with username password got error",e,t,n)}}async signInWithGoogleCredential(e,t){try{if(!e)return void $.error("Google googleAccountCredential empty!");let n=await this.getFirebaseUserIdToken(e);const r=await un("credentials",{redirect:!1,firebaseAccessToken:n});$.log("signInResponse: ",r),r.ok?t?location.href=t:location.reload():$.error("Sign in with Google got error: ",r.status,r.statusText)}catch(t){$.error('Sign In by Google error: function "signInWithGoogleCredential" ',"googleAccountCredential: ",e,t)}}}function nt(){try{return JSON.parse(Pr("session"))}catch{return}}const Cr="/auth";async function Gc(e){await Z.getInstance().signInWithGoogleCredential(e.credential)}async function un(e,t){const n=`${Cr}/callback/${e}`;return await fetch(n,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({json:"true",redirect:"false",callbackUtl:"http://127.0.0.1:4321",tz:Intl.DateTimeFormat().resolvedOptions().timeZone,source:"calculator",...t})})}async function zc(e){try{console.log("Logout"),localStorage?.clear();const{callbackUrl:t=window.location.href,prefix:n=Cr}=e??{},r=(await fetch(`${n}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({callbackUrl:t})}),t);window.location.href=r,r.includes("#")&&window.location.reload()}catch{window.location.reload()}}export{re as A,Dr as C,Vc as _,Z as a,Wc as b,Hc as c,jc as d,Gc as e,nt as g,$ as l,zc as s};